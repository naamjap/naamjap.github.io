(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{187:function(e,t,n){"use strict";n.d(t,"u",(function(){return w})),n.d(t,"v",(function(){return _})),n.d(t,"o",(function(){return E})),n.d(t,"p",(function(){return S})),n.d(t,"n",(function(){return O})),n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"m",(function(){return T})),n.d(t,"q",(function(){return I})),n.d(t,"r",(function(){return A})),n.d(t,"l",(function(){return N})),n.d(t,"h",(function(){return l})),n.d(t,"t",(function(){return C})),n.d(t,"s",(function(){return x})),n.d(t,"j",(function(){return f})),n.d(t,"k",(function(){return h})),n.d(t,"a",(function(){return d})),n.d(t,"g",(function(){return v})),n.d(t,"i",(function(){return y})),n.d(t,"b",(function(){return P})),n.d(t,"d",(function(){return k}));var r,o,c,l,f,h,d,v,y,m=n(484);function w(e){return e&&void 0!==e.pluralName}function _(e){return e&&e.targetName}function E(e){return"key"===e.type&&e.properties&&e.properties.fields&&e.properties.fields.length>0}function S(e){return E(e)&&void 0===e.properties.name}function O(e){return E(e)&&void 0!==e.properties.name&&e.properties.fields.length>2}function T(e){return e&&void 0!==c[e]}function I(e){return!(!e||!e.model)}function A(e){return!(!e||!e.nonModel)}function N(e){return!(!e||!e.enum)}function C(e){return e&&void 0!==e.field}function x(e){return e&&void 0!==e.type}!function(e){e.CUSTOM="custom",e.OWNER="owner",e.GROUPS="groups",e.PRIVATE="private",e.PUBLIC="public"}(r||(r={})),function(e){e.FUNCTION="function",e.USER_POOLS="userPools",e.OIDC="oidc",e.IAM="iam",e.API_KEY="apiKey"}(o||(o={})),function(e){e[e.ID=0]="ID",e[e.String=1]="String",e[e.Int=2]="Int",e[e.Float=3]="Float",e[e.Boolean=4]="Boolean",e[e.AWSDate=5]="AWSDate",e[e.AWSTime=6]="AWSTime",e[e.AWSDateTime=7]="AWSDateTime",e[e.AWSTimestamp=8]="AWSTimestamp",e[e.AWSEmail=9]="AWSEmail",e[e.AWSJSON=10]="AWSJSON",e[e.AWSURL=11]="AWSURL",e[e.AWSPhone=12]="AWSPhone",e[e.AWSIPAddress=13]="AWSIPAddress"}(c||(c={})),function(e){e.getJSType=function(e){switch(e){case"Boolean":return"boolean";case"ID":case"String":case"AWSDate":case"AWSTime":case"AWSDateTime":case"AWSEmail":case"AWSURL":case"AWSPhone":case"AWSIPAddress":return"string";case"Int":case"Float":case"AWSTimestamp":return"number";case"AWSJSON":return"object";default:Object(m.g)(e)}},e.getValidationFunction=function(e){switch(e){case"AWSDate":return m.k;case"AWSTime":return m.q;case"AWSDateTime":return m.l;case"AWSTimestamp":return m.r;case"AWSEmail":return m.m;case"AWSJSON":return m.o;case"AWSURL":return m.s;case"AWSPhone":return m.p;case"AWSIPAddress":return m.n;default:return}}}(c||(c={})),function(e){e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(l||(l={})),function(e){e[e.FIRST=0]="FIRST",e[e.LAST=1]="LAST"}(f||(f={})),function(e){e.ASCENDING="ASCENDING",e.DESCENDING="DESCENDING"}(h||(h={})),function(e){e.DEFAULT="DEFAULT",e.MULTI_AUTH="MULTI_AUTH"}(d||(d={})),function(e){e.CREATE="CREATE",e.READ="READ",e.UPDATE="UPDATE",e.DELETE="DELETE"}(v||(v={})),function(e){e.sync="sync",e.mutate="mutate",e.subscribe="subscribe"}(y||(y={}));var k,P=Symbol("DISCARD");!function(e){e.LIMIT="LIMIT",e.TIMER="TIMER"}(k||(k={}))},19:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(35),o=n(117),c=(n(409),n(415),{userAgent:o.a.userAgent});r.a},267:function(e,t,n){"use strict";var r=n(188);n(27);t.a=r.a},268:function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var r=n(188),o=n(114),c=n(644),l=n(59),f=n(415),h=n(35),d=function(){return d=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},d.apply(this,arguments)},v=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},y=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},m=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t},w=new l.a("RestAPI"),_=function(){function e(e){this._api=null,this.Credentials=f.a,this._options=e,w.debug("API Options",this._options)}return e.prototype.getModuleName=function(){return"RestAPI"},e.prototype.configure=function(e){var t=e||{},n=t.API,r=void 0===n?{}:n,o=m(t,["API"]),c=d(d({},o),r);if(w.debug("configure Rest API",{opt:c}),c.aws_project_region){if(c.aws_cloud_logic_custom){var l=c.aws_cloud_logic_custom;c.endpoints="string"==typeof l?JSON.parse(l):l}c=Object.assign({},c,{region:c.aws_project_region,header:{}})}return Array.isArray(c.endpoints)?c.endpoints.forEach((function(e){void 0!==e.custom_header&&"function"!=typeof e.custom_header&&(w.warn("Rest API "+e.name+", custom_header should be a function"),e.custom_header=void 0)})):this._options&&Array.isArray(this._options.endpoints)?c.endpoints=this._options.endpoints:c.endpoints=[],this._options=Object.assign({},this._options,c),this.createInstance(),this._options},e.prototype.createInstance=function(){return w.debug("create Rest API instance"),this._api=new c.a(this._options),this._api.Credentials=this.Credentials,!0},e.prototype.get=function(e,path,t){try{var n=this.getEndpointInfo(e,path),r=this._api.getCancellableToken(),o=Object.assign({},t);o.cancellableToken=r;var c=this._api.get(n,o);return this._api.updateRequestToBeCancellable(c,r),c}catch(e){return Promise.reject(e.message)}},e.prototype.post=function(e,path,t){try{var n=this.getEndpointInfo(e,path),r=this._api.getCancellableToken(),o=Object.assign({},t);o.cancellableToken=r;var c=this._api.post(n,o);return this._api.updateRequestToBeCancellable(c,r),c}catch(e){return Promise.reject(e.message)}},e.prototype.put=function(e,path,t){try{var n=this.getEndpointInfo(e,path),r=this._api.getCancellableToken(),o=Object.assign({},t);o.cancellableToken=r;var c=this._api.put(n,o);return this._api.updateRequestToBeCancellable(c,r),c}catch(e){return Promise.reject(e.message)}},e.prototype.patch=function(e,path,t){try{var n=this.getEndpointInfo(e,path),r=this._api.getCancellableToken(),o=Object.assign({},t);o.cancellableToken=r;var c=this._api.patch(n,o);return this._api.updateRequestToBeCancellable(c,r),c}catch(e){return Promise.reject(e.message)}},e.prototype.del=function(e,path,t){try{var n=this.getEndpointInfo(e,path),r=this._api.getCancellableToken(),o=Object.assign({},t);o.cancellableToken=r;var c=this._api.del(n,o);return this._api.updateRequestToBeCancellable(c,r),c}catch(e){return Promise.reject(e.message)}},e.prototype.head=function(e,path,t){try{var n=this.getEndpointInfo(e,path),r=this._api.getCancellableToken(),o=Object.assign({},t);o.cancellableToken=r;var c=this._api.head(n,o);return this._api.updateRequestToBeCancellable(c,r),c}catch(e){return Promise.reject(e.message)}},e.prototype.isCancel=function(e){return this._api.isCancel(e)},e.prototype.cancel=function(e,t){return this._api.cancel(e,t)},e.prototype.hasCancelToken=function(e){return this._api.hasCancelToken(e)},e.prototype.endpoint=function(e){return v(this,void 0,void 0,(function(){return y(this,(function(t){return[2,this._api.endpoint(e)]}))}))},e.prototype.getEndpointInfo=function(e,path){var t=this._options.endpoints;if(!Array.isArray(t))throw new Error("API category not configured");var n=t.find((function(t){return t.name===e}));if(!n)throw new Error("API "+e+" does not exist");var r={endpoint:n.endpoint+path};return"string"==typeof n.region?r.region=n.region:"string"==typeof this._options.region&&(r.region=this._options.region),"string"==typeof n.service?r.service=n.service||"execute-api":r.service="execute-api","function"==typeof n.custom_header?r.custom_header=n.custom_header:r.custom_header=void 0,r},e}(),E=new _(null);h.a.register(E);var S=n(420),O=function(){return O=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},O.apply(this,arguments)},T=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},I=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},A=new l.a("API"),N=new(function(){function e(e){this.Auth=r.a,this.Cache=o.a,this.Credentials=f.a,this._options=e,this._restApi=new _(e),this._graphqlApi=new S.a(e),A.debug("API Options",this._options)}return e.prototype.getModuleName=function(){return"API"},e.prototype.configure=function(e){this._options=Object.assign({},this._options,e),this._restApi.Credentials=this.Credentials,this._graphqlApi.Auth=this.Auth,this._graphqlApi.Cache=this.Cache,this._graphqlApi.Credentials=this.Credentials;var t=this._restApi.configure(this._options),n=this._graphqlApi.configure(this._options);return O(O({},t),n)},e.prototype.get=function(e,path,t){return this._restApi.get(e,path,t)},e.prototype.post=function(e,path,t){return this._restApi.post(e,path,t)},e.prototype.put=function(e,path,t){return this._restApi.put(e,path,t)},e.prototype.patch=function(e,path,t){return this._restApi.patch(e,path,t)},e.prototype.del=function(e,path,t){return this._restApi.del(e,path,t)},e.prototype.head=function(e,path,t){return this._restApi.head(e,path,t)},e.prototype.isCancel=function(e){return this._restApi.isCancel(e)},e.prototype.cancel=function(e,t){return this._restApi.hasCancelToken(e)?this._restApi.cancel(e,t):!!this._graphqlApi.hasCancelToken(e)&&this._graphqlApi.cancel(e,t)},e.prototype.endpoint=function(e){return T(this,void 0,void 0,(function(){return I(this,(function(t){return[2,this._restApi.endpoint(e)]}))}))},e.prototype.getGraphqlOperationType=function(e){return this._graphqlApi.getGraphqlOperationType(e)},e.prototype.graphql=function(e,t){return this._graphqlApi.graphql(e,t)},e}())(null);h.a.register(N)},409:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(59),o=new r.a("I18n"),c=function(){function e(e){this._options=null,this._lang=null,this._dict={},this._options=Object.assign({},e),this._lang=this._options.language,!this._lang&&"undefined"!=typeof window&&window&&window.navigator&&(this._lang=window.navigator.language),o.debug(this._lang)}return e.prototype.setLanguage=function(e){this._lang=e},e.prototype.get=function(e,t){if(void 0===t&&(t=void 0),!this._lang)return void 0!==t?t:e;var n=this._lang,r=this.getByLanguage(e,n);return r||(n.indexOf("-")>0&&(r=this.getByLanguage(e,n.split("-")[0])),r||(void 0!==t?t:e))},e.prototype.getByLanguage=function(e,t,n){if(void 0===n&&(n=null),!t)return n;var r=this._dict[t];return r?r[e]:n},e.prototype.putVocabulariesForLanguage=function(e,t){var n=this._dict[e];n||(n=this._dict[e]={}),Object.assign(n,t)},e.prototype.putVocabularies=function(e){var t=this;Object.keys(e).map((function(n){t.putVocabulariesForLanguage(n,e[n])}))},e}(),l=n(35),f=new r.a("I18n"),h=null,d=null,v=function(){function e(){}return e.configure=function(t){return f.debug("configure I18n"),t?(h=Object.assign({},h,t.I18n||t),e.createInstance(),h):h},e.getModuleName=function(){return"I18n"},e.createInstance=function(){f.debug("create I18n instance"),d||(d=new c(h))},e.setLanguage=function(t){return e.checkConfig(),d.setLanguage(t)},e.get=function(t,n){return e.checkConfig()?d.get(t,n):void 0===n?t:n},e.putVocabulariesForLanguage=function(t,n){return e.checkConfig(),d.putVocabulariesForLanguage(t,n)},e.putVocabularies=function(t){return e.checkConfig(),d.putVocabularies(t)},e.checkConfig=function(){return d||(d=new c(h)),!0},e}();l.a.register(v)},410:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l}));var r=n(484),o=new WeakSet;function c(e){return o.has(e)}Symbol("A predicate that matches all records"),function(){function e(){}Object.defineProperty(e,"ALL",{get:function(){var e=function(e){return e};return o.add(e),e},enumerable:!0,configurable:!0})}();var l=function(){function e(){}return e.createPredicateBuilder=function(t){var n,o=t.name,c=new Set(Object.keys(t.fields)),l=new Proxy({},n={get:function(t,l,f){var h=l;switch(h){case"and":case"or":case"not":return function(t){var r={type:h,predicates:[]},o=new Proxy({},n);return e.predicateGroupsMap.set(o,r),t(o),e.predicateGroupsMap.get(f).predicates.push(r),f};default:Object(r.g)(h,!1)}var d=l;if(!c.has(d))throw new Error("Invalid field for model. field: "+d+", model: "+o);return function(t,n){return e.predicateGroupsMap.get(f).predicates.push({field:d,operator:t,operand:n}),f}}});return e.predicateGroupsMap.set(l,{type:"and",predicates:[]}),l},e.isValidPredicate=function(t){return e.predicateGroupsMap.has(t)},e.getPredicates=function(t,n){if(void 0===n&&(n=!0),n&&!e.isValidPredicate(t))throw new Error("The predicate is not valid");return e.predicateGroupsMap.get(t)},e.createFromExisting=function(t,n){if(n&&t)return n(e.createPredicateBuilder(t))},e.createForId=function(t,n){return e.createPredicateBuilder(t).id("eq",n)},e.predicateGroupsMap=new WeakMap,e}()},411:function(e,t,n){"use strict";var r=n(268);t.a=r.a},412:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r,o=n(416);!function(e){e.CONNECTION_CLOSED="Connection closed",e.CONNECTION_FAILED="Connection failed",e.REALTIME_SUBSCRIPTION_INIT_ERROR="AppSync Realtime subscription init error",e.SUBSCRIPTION_ACK="Subscription ack",e.TIMEOUT_DISCONNECT="Timeout disconnect"}(r||(r={})),t.b=o.a},414:function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var r=n(59),o=n(645),c=n(13),l=n(44),f=n(687),h=function(){return h=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},h.apply(this,arguments)},d=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t},v=new r.a("Signer"),y="AWS4-HMAC-SHA256",m=function(e,t){var n=new o.Sha256(e);return n.update(t),n.digestSync()},w=function(e){var t=e||"",n=new o.Sha256;return n.update(t),Object(c.b)(n.digestSync())},_=function(e){return Object.keys(e).map((function(e){return e.toLowerCase()})).sort().join(";")},E=function(e){var t,n,r=Object(l.parse)(e.url);return[e.method||"/",encodeURIComponent(r.pathname).replace(/%2F/gi,"/"),(n=r.query,n&&0!==n.length?n.split("&").map((function(e){var t=e.split("=");if(1===t.length)return e;var n=t[1].replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}));return t[0]+"="+n})).sort((function(a,b){var e=a.split("=")[0],t=b.split("=")[0];return e===t?a<b?-1:1:e<t?-1:1})).join("&"):""),(t=e.headers,t&&0!==Object.keys(t).length?Object.keys(t).map((function(e){return{key:e.toLowerCase(),value:t[e]?t[e].trim().replace(/\s+/g," "):""}})).sort((function(a,b){return a.key<b.key?-1:1})).map((function(e){return e.key+":"+e.value})).join("\n")+"\n":""),_(e.headers),w(e.data)].join("\n")},S=function(e){var t=(Object(l.parse)(e.url).host.match(/([^\.]+)\.(?:([^\.]*)\.)?amazonaws\.com$/)||[]).slice(1,3);return"es"===t[1]&&(t=t.reverse()),{service:e.service||t[0],region:e.region||t[1]}},O=function(e,t,n){return[e,t,n,"aws4_request"].join("/")},T=function(e,t,n,r){return[e,n,r,w(t)].join("\n")},I=function(e,t,n){v.debug(n);var r=m("AWS4"+e,t),o=m(r,n.region),c=m(o,n.service);return m(c,"aws4_request")},A=function(e,t){return Object(c.b)(m(e,t))},N=function(){function e(){}return e.sign=function(e,t,n){void 0===n&&(n=null),e.headers=e.headers||{};var r=f.a.getDateWithClockOffset().toISOString().replace(/[:\-]|\.\d{3}/g,""),o=r.substr(0,8),c=Object(l.parse)(e.url);e.headers.host=c.host,e.headers["x-amz-date"]=r,t.session_token&&(e.headers["X-Amz-Security-Token"]=t.session_token);var h=E(e);v.debug(h);var d=n||S(e),m=O(o,d.region,d.service),w=T(y,h,r,m),N=I(t.secret_key,o,d),C=A(N,w),x=function(e,t,n,r,o){return[e+" Credential="+t+"/"+n,"SignedHeaders="+r,"Signature="+o].join(", ")}(y,t.access_key,m,_(e.headers),C);return e.headers.Authorization=x,e},e.signUrl=function(e,t,n,r){var o="object"==typeof e?e.url:e,c="object"==typeof e?e.method:"GET",body="object"==typeof e?e.body:void 0,v=f.a.getDateWithClockOffset().toISOString().replace(/[:\-]|\.\d{3}/g,""),m=v.substr(0,8),w=Object(l.parse)(o,!0,!0),_=(w.search,d(w,["search"])),N={host:_.host},C=n||S({url:Object(l.format)(_)}),x=C.region,k=C.service,P=O(m,x,k),M=t.session_token&&"iotdevicegateway"!==k,D=h(h(h({"X-Amz-Algorithm":y,"X-Amz-Credential":[t.access_key,P].join("/"),"X-Amz-Date":v.substr(0,16)},M?{"X-Amz-Security-Token":""+t.session_token}:{}),r?{"X-Amz-Expires":""+r}:{}),{"X-Amz-SignedHeaders":Object.keys(N).join(",")}),R=E({method:c,url:Object(l.format)(h(h({},_),{query:h(h({},_.query),D)})),headers:N,data:body}),j=T(y,R,v,P),L=I(t.secret_key,m,{region:x,service:k}),F=A(L,j),U=h({"X-Amz-Signature":F},t.session_token&&{"X-Amz-Security-Token":t.session_token});return Object(l.format)({protocol:_.protocol,slashes:!0,hostname:_.hostname,port:_.port,pathname:_.pathname,query:h(h(h({},_.query),D),U)})},e}()},416:function(e,t,n){"use strict";n.d(t,"a",(function(){return ye}));var r,o=n(488),c=n(34),l=n(59),f=n(544),h=n(35),d=n(650),v=n(196),y=function(){return y=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},y.apply(this,arguments)},m=new l.a("AbstractPubSubProvider"),w=function(){function e(e){void 0===e&&(e={}),this._config=e}return e.prototype.configure=function(e){return void 0===e&&(e={}),this._config=y(y({},e),this._config),m.debug("configure "+this.getProviderName(),this._config),this.options},e.prototype.getCategory=function(){return"PubSub"},Object.defineProperty(e.prototype,"options",{get:function(){return y({},this._config)},enumerable:!0,configurable:!0}),e}(),_=(r=function(e,b){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},r(e,b)},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)}),E=function(){return E=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},E.apply(this,arguments)},S=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},O=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},T=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t},I=new l.a("MqttOverWSProvider");var A,N,C,x=function(){function e(){this.promises=new Map}return e.prototype.get=function(e,t){return S(this,void 0,void 0,(function(){var n,r;return O(this,(function(o){return(n=this.promises.get(e))?[2,n]:t?(r=t(e),this.promises.set(e,r),[2,r]):[2,void 0]}))}))},Object.defineProperty(e.prototype,"allClients",{get:function(){return Array.from(this.promises.keys())},enumerable:!0,configurable:!0}),e.prototype.remove=function(e){this.promises.delete(e)},e}(),k="undefined"!=typeof Symbol?Symbol("topic"):"@@topic",P=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,E(E({},t),{clientId:t.clientId||Object(v.v4)()}))||this;return n._clientsQueue=new x,n._topicObservers=new Map,n._clientIdObservers=new Map,n}return _(t,e),Object.defineProperty(t.prototype,"clientId",{get:function(){return this.options.clientId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endpoint",{get:function(){return this.options.aws_pubsub_endpoint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clientsQueue",{get:function(){return this._clientsQueue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSSLEnabled",{get:function(){return!this.options.aws_appsync_dangerously_connect_to_http_endpoint_for_testing},enumerable:!0,configurable:!0}),t.prototype.getTopicForValue=function(e){return"object"==typeof e&&e[k]},t.prototype.getProviderName=function(){return"MqttOverWSProvider"},t.prototype.onDisconnect=function(e){var t=this,n=e.clientId,r=e.errorCode,o=T(e,["clientId","errorCode"]);if(0!==r){I.warn(n,JSON.stringify(E({errorCode:r},o),null,2));var c=[];if(!n)return;var l=this._clientIdObservers.get(n);if(!l)return;l.forEach((function(e){e.error("Disconnected, error code: "+r),t._topicObservers.forEach((function(t,n){t.delete(e),0===t.size&&c.push(n)}))})),this._clientIdObservers.delete(n),c.forEach((function(e){t._topicObservers.delete(e)}))}},t.prototype.newClient=function(e){var t=e.url,n=e.clientId;return S(this,void 0,void 0,(function(){var e,r=this;return O(this,(function(o){switch(o.label){case 0:return I.debug("Creating new MQTT client",n),(e=new d.Client(t,n)).onMessageArrived=function(e){var t=e.destinationName,n=e.payloadString;r._onMessage(t,n)},e.onConnectionLost=function(e){var t=e.errorCode,o=T(e,["errorCode"]);r.onDisconnect(E({clientId:n,errorCode:t},o))},[4,new Promise((function(t,n){e.connect({useSSL:r.isSSLEnabled,mqttVersion:3,onSuccess:function(){return t(e)},onFailure:n})}))];case 1:return o.sent(),[2,e]}}))}))},t.prototype.connect=function(e,t){return void 0===t&&(t={}),S(this,void 0,void 0,(function(){var n=this;return O(this,(function(r){switch(r.label){case 0:return[4,this.clientsQueue.get(e,(function(e){return n.newClient(E(E({},t),{clientId:e}))}))];case 1:return[2,r.sent()]}}))}))},t.prototype.disconnect=function(e){return S(this,void 0,void 0,(function(){var t;return O(this,(function(n){switch(n.label){case 0:return[4,this.clientsQueue.get(e)];case 1:return(t=n.sent())&&t.isConnected()&&t.disconnect(),this.clientsQueue.remove(e),[2]}}))}))},t.prototype.publish=function(e,t){return S(this,void 0,void 0,(function(){var n,r,o,c;return O(this,(function(l){switch(l.label){case 0:return n=[].concat(e),r=JSON.stringify(t),[4,this.endpoint];case 1:return o=l.sent(),[4,this.connect(this.clientId,{url:o})];case 2:return c=l.sent(),I.debug("Publishing to topic(s)",n.join(","),r),n.forEach((function(e){return c.send(e,r)})),[2]}}))}))},t.prototype._onMessage=function(e,t){try{var n=[];this._topicObservers.forEach((function(t,r){(function(filter,e){for(var t=filter.split("/"),n=t.length,r=e.split("/"),i=0;i<n;++i){var o=t[i],c=r[i];if("#"===o)return r.length>=n;if("+"!==o&&o!==c)return!1}return n===r.length})(r,e)&&n.push(t)}));var r=JSON.parse(t);"object"==typeof r&&(r[k]=e),n.forEach((function(e){e.forEach((function(e){return e.next(r)}))}))}catch(e){I.warn("Error handling message",e,t)}},t.prototype.subscribe=function(e,t){var n=this;void 0===t&&(t={});var r=[].concat(e);return I.debug("Subscribing to topic(s)",r.join(",")),new o.a((function(e){var o;r.forEach((function(t){var r=n._topicObservers.get(t);r||(r=new Set,n._topicObservers.set(t,r)),r.add(e)}));var c=t.clientId,l=void 0===c?n.clientId:c,f=n._clientIdObservers.get(l);return f||(f=new Set),f.add(e),n._clientIdObservers.set(l,f),S(n,void 0,void 0,(function(){var n,c,f,h;return O(this,(function(d){switch(d.label){case 0:return void 0!==(n=t.url)?[3,2]:[4,this.endpoint];case 1:return f=d.sent(),[3,3];case 2:f=n,d.label=3;case 3:c=f,d.label=4;case 4:return d.trys.push([4,6,,7]),[4,this.connect(l,{url:c})];case 5:return o=d.sent(),r.forEach((function(e){o.subscribe(e)})),[3,7];case 6:return h=d.sent(),e.error(h),[3,7];case 7:return[2]}}))})),function(){var t,c;return I.debug("Unsubscribing from topic(s)",r.join(",")),o&&(null===(t=n._clientIdObservers.get(l))||void 0===t||t.delete(e),0===(null===(c=n._clientIdObservers.get(l))||void 0===c?void 0:c.size)&&(n.disconnect(l),n._clientIdObservers.delete(l)),r.forEach((function(t){var r=n._topicObservers.get(t)||new Set;r.delete(e),0===r.size&&(n._topicObservers.delete(t),o.isConnected()&&o.unsubscribe(t))}))),null}}))},t}(w),M=function(){var e=function(t,b){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},e(t,b)};return function(t,b){function n(){this.constructor=t}e(t,b),t.prototype=null===b?Object.create(b):(n.prototype=b.prototype,new n)}}(),D=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},R=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},j=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t},L=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},F=function(){for(var e=[],i=0;i<arguments.length;i++)e=e.concat(L(arguments[i]));return e},U=new l.a("AWSAppSyncProvider"),B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._topicClient=new Map,t._topicAlias=new Map,t}return M(t,e),Object.defineProperty(t.prototype,"endpoint",{get:function(){throw new Error("Not supported")},enumerable:!0,configurable:!0}),t.prototype.getProviderName=function(){return"AWSAppSyncProvider"},t.prototype.publish=function(e,t,n){return D(this,void 0,void 0,(function(){return R(this,(function(e){throw new Error("Operation not supported")}))}))},t.prototype._cleanUp=function(e){var t=this;Array.from(this._topicClient.entries()).filter((function(t){return L(t,2)[1].clientId===e})).map((function(e){return L(e,1)[0]})).forEach((function(e){return t._cleanUpForTopic(e)}))},t.prototype._cleanUpForTopic=function(e){this._topicClient.delete(e),this._topicAlias.delete(e)},t.prototype.onDisconnect=function(e){var t=this,n=e.clientId,r=e.errorCode,o=j(e,["clientId","errorCode"]);if(0!==r){var c=Array.from(this._topicClient.entries()).filter((function(e){return L(e,2)[1].clientId===n})).map((function(e){return L(e,1)[0]}));c.forEach((function(e){t._topicObservers.has(e)&&(t._topicObservers.get(e).forEach((function(e){e.closed||e.error(o)})),t._topicObservers.delete(e))})),this._cleanUp(n)}},t.prototype.disconnect=function(t){return D(this,void 0,void 0,(function(){return R(this,(function(n){switch(n.label){case 0:return[4,this.clientsQueue.get(t,(function(){return null}))];case 1:return n.sent(),[4,e.prototype.disconnect.call(this,t)];case 2:return n.sent(),this._cleanUp(t),[2]}}))}))},t.prototype.subscribe=function(e,t){var n=this;void 0===t&&(t={});var r=new o.a((function(r){var o=[].concat(e);return U.debug("Subscribing to topic(s)",o.join(",")),D(n,void 0,void 0,(function(){var e,n,c,l,map,f=this;return R(this,(function(h){switch(h.label){case 0:return o.forEach((function(e){f._topicObservers.has(e)||f._topicObservers.set(e,new Set),f._topicObservers.get(e).add(r)})),e=t.mqttConnections,n=void 0===e?[]:e,c=t.newSubscriptions,l=Object.entries(c).map((function(e){var t=L(e,2),n=t[0];return[t[1].topic,n]})),this._topicAlias=new Map(F(Array.from(this._topicAlias.entries()),l)),map=Object.entries(o.reduce((function(e,t){var r=n.find((function(e){return e.topics.indexOf(t)>-1}));if(r){var o=r.client,c=r.url;e[o]||(e[o]={url:c,topics:new Set}),e[o].topics.add(t)}return e}),{})),[4,Promise.all(map.map((function(e){var t=L(e,2),n=t[0],o=t[1],c=o.url,l=o.topics;return D(f,void 0,void 0,(function(){var e,t,o=this;return R(this,(function(f){switch(f.label){case 0:e=null,f.label=1;case 1:return f.trys.push([1,3,,4]),[4,this.connect(n,{clientId:n,url:c})];case 2:return e=f.sent(),[3,4];case 3:return t=f.sent(),r.error({message:"Failed to connect",error:t}),r.complete(),[2,void 0];case 4:return l.forEach((function(t){e.isConnected()&&(e.subscribe(t),o._topicClient.set(t,e))})),[2,e]}}))}))})))];case 1:return h.sent(),[2]}}))})),function(){U.debug("Unsubscribing from topic(s)",o.join(",")),o.forEach((function(e){var t=n._topicClient.get(e);t&&t.isConnected()&&(t.unsubscribe(e),n._topicClient.delete(e),Array.from(n._topicClient.values()).some((function(e){return e===t}))||n.disconnect(t.clientId)),n._topicObservers.delete(e)}))}}));return o.a.from(r).map((function(e){var t=n.getTopicForValue(e),r=n._topicAlias.get(t);return e.data=Object.entries(e.data).reduce((function(e,t){var n=L(t,2),o=n[0],c=n[1];return e[r||o]=c,e}),{}),e}))},t}(P),G=n(675),V=n(44),K=n(10),W=n(272),z=n(19),Y=n(469),H=n(415),J=n(414),Q=n(114),$=n(267),X=n(412),Z=[400,401,403];!function(e){e.GQL_CONNECTION_INIT="connection_init",e.GQL_CONNECTION_ERROR="connection_error",e.GQL_CONNECTION_ACK="connection_ack",e.GQL_START="start",e.GQL_START_ACK="start_ack",e.GQL_DATA="data",e.GQL_CONNECTION_KEEP_ALIVE="ka",e.GQL_STOP="stop",e.GQL_COMPLETE="complete",e.GQL_ERROR="error"}(A||(A={})),function(e){e[e.PENDING=0]="PENDING",e[e.CONNECTED=1]="CONNECTED",e[e.FAILED=2]="FAILED"}(N||(N={})),function(e){e[e.CLOSED=0]="CLOSED",e[e.READY=1]="READY",e[e.CONNECTING=2]="CONNECTING"}(C||(C={}));var ee="undefined"!=typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("amplify_default"):"@@amplify_default",te={accept:"application/json, text/javascript","content-encoding":"amz-1.0","content-type":"application/json; charset=UTF-8"},ne=15e3,re=3e5,ie=function(){var e=function(t,b){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},e(t,b)};return function(t,b){function n(){this.constructor=t}e(t,b),t.prototype=null===b?Object.create(b):(n.prototype=b.prototype,new n)}}(),oe=function(){return oe=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},oe.apply(this,arguments)},se=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},ae=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},ce=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},ue=new l.a("AWSAppSyncRealTimeProvider"),le=/^https:\/\/\w{26}\.appsync\-api\.\w{2}(?:(?:\-\w{2,})+)\-\d\.amazonaws.com\/graphql$/i,fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.socketStatus=C.CLOSED,t.keepAliveTimeout=re,t.subscriptionObserverMap=new Map,t.promiseArray=[],t}return ie(t,e),t.prototype.getNewWebSocket=function(e,t){return new WebSocket(e,t)},t.prototype.getProviderName=function(){return"AWSAppSyncRealTimeProvider"},t.prototype.newClient=function(){throw new Error("Not used here")},t.prototype.publish=function(e,t,n){return se(this,void 0,void 0,(function(){return ae(this,(function(e){throw new Error("Operation not supported")}))}))},t.prototype.isCustomDomain=function(e){return null===e.match(le)},t.prototype.subscribe=function(e,t){var n=this,r=null==t?void 0:t.appSyncGraphqlEndpoint;return new o.a((function(e){if(t&&r){var o=Object(v.v4)();return n._startSubscriptionWithAWSAppSyncRealTime({options:t,observer:e,subscriptionId:o}).catch((function(t){e.error({errors:[oe({},new G.a(X.a.REALTIME_SUBSCRIPTION_INIT_ERROR+": "+t))]}),e.complete()})),function(){return se(n,void 0,void 0,(function(){var e,t;return ae(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,this._waitForSubscriptionToBeConnected(o)];case 1:if(n.sent(),!(e=(this.subscriptionObserverMap.get(o)||{}).subscriptionState))return[2];if(e!==N.CONNECTED)throw new Error("Subscription never connected");return this._sendUnsubscriptionMessage(o),[3,4];case 2:return t=n.sent(),ue.debug("Error while unsubscribing "+t),[3,4];case 3:return this._removeSubscriptionObserver(o),[7];case 4:return[2]}}))}))}}e.error({errors:[oe({},new G.a("Subscribe only available for AWS AppSync endpoint"))]}),e.complete()}))},Object.defineProperty(t.prototype,"isSSLEnabled",{get:function(){return!this.options.aws_appsync_dangerously_connect_to_http_endpoint_for_testing},enumerable:!0,configurable:!0}),t.prototype._startSubscriptionWithAWSAppSyncRealTime=function(e){var t,n,r=e.options,o=e.observer,c=e.subscriptionId;return se(this,void 0,void 0,(function(){var e,l,h,d,v,y,m,w,_,E,S,data,O,T,I,C,x,k,P,M,D,R,j,L,F,U=this;return ae(this,(function(B){switch(B.label){case 0:return e=r.appSyncGraphqlEndpoint,l=r.authenticationType,h=r.query,d=r.variables,v=r.apiKey,y=r.region,m=r.graphql_headers,w=void 0===m?function(){return{}}:m,_=r.additionalHeaders,E=void 0===_?{}:_,S=N.PENDING,data={query:h,variables:d},this.subscriptionObserverMap.set(c,{observer:o,query:null!=h?h:"",variables:null!=d?d:{},subscriptionState:S,startAckTimeoutId:void 0}),O=JSON.stringify(data),I=[{}],[4,this._awsRealTimeHeaderBasedAuth({apiKey:v,appSyncGraphqlEndpoint:e,authenticationType:l,payload:O,canonicalUri:"",region:y,additionalHeaders:E})];case 1:return C=[oe.apply(void 0,I.concat([B.sent()]))],[4,w()];case 2:T=oe.apply(void 0,[oe.apply(void 0,[oe.apply(void 0,C.concat([B.sent()])),E]),(F={},F[f.c]=z.a.userAgent,F)]),x={id:c,payload:{data:O,extensions:{authorization:oe({},T)}},type:A.GQL_START},k=JSON.stringify(x),B.label=3;case 3:return B.trys.push([3,5,,6]),[4,this._initializeWebSocketConnection({apiKey:v,appSyncGraphqlEndpoint:e,authenticationType:l,region:y,additionalHeaders:E})];case 4:return B.sent(),[3,6];case 5:return P=B.sent(),ue.debug({err:P}),M=null!==(t=P.message)&&void 0!==t?t:"",o.error({errors:[oe({},new G.a(X.a.CONNECTION_FAILED+": "+M))]}),o.complete(),"function"==typeof(D=(this.subscriptionObserverMap.get(c)||{}).subscriptionFailedCallback)&&D(),[2];case 6:return R=null!==(n=this.subscriptionObserverMap.get(c))&&void 0!==n?n:{},j=R.subscriptionFailedCallback,L=R.subscriptionReadyCallback,this.subscriptionObserverMap.set(c,{observer:o,subscriptionState:S,query:null!=h?h:"",variables:null!=d?d:{},subscriptionReadyCallback:L,subscriptionFailedCallback:j,startAckTimeoutId:setTimeout((function(){U._timeoutStartSubscriptionAck.call(U,c)}),15e3)}),this.awsRealTimeSocket&&this.awsRealTimeSocket.send(k),[2]}}))}))},t.prototype._waitForSubscriptionToBeConnected=function(e){return se(this,void 0,void 0,(function(){var t,n=this;return ae(this,(function(r){return(t=this.subscriptionObserverMap.get(e))&&t.subscriptionState===N.PENDING?[2,new Promise((function(r,o){var c=t.observer,l=t.subscriptionState,f=t.variables,h=t.query;n.subscriptionObserverMap.set(e,{observer:c,subscriptionState:l,variables:f,query:h,subscriptionReadyCallback:r,subscriptionFailedCallback:o})}))]:[2]}))}))},t.prototype._sendUnsubscriptionMessage=function(e){try{if(this.awsRealTimeSocket&&this.awsRealTimeSocket.readyState===WebSocket.OPEN&&this.socketStatus===C.READY){var t={id:e,type:A.GQL_STOP},n=JSON.stringify(t);this.awsRealTimeSocket.send(n)}}catch(e){ue.debug({err:e})}},t.prototype._removeSubscriptionObserver=function(e){this.subscriptionObserverMap.delete(e),setTimeout(this._closeSocketIfRequired.bind(this),1e3)},t.prototype._closeSocketIfRequired=function(){if(!(this.subscriptionObserverMap.size>0))if(this.awsRealTimeSocket)if(this.awsRealTimeSocket.bufferedAmount>0)setTimeout(this._closeSocketIfRequired.bind(this),1e3);else{ue.debug("closing WebSocket..."),this.keepAliveTimeoutId&&clearTimeout(this.keepAliveTimeoutId);var e=this.awsRealTimeSocket;e.onclose=null,e.onerror=null,e.close(1e3),this.awsRealTimeSocket=void 0,this.socketStatus=C.CLOSED}else this.socketStatus=C.CLOSED},t.prototype._handleIncomingSubscriptionMessage=function(e){ue.debug("subscription message from AWS AppSync RealTime: "+e.data);var t=JSON.parse(e.data),n=t.id,r=void 0===n?"":n,o=t.payload,c=t.type,l=this.subscriptionObserverMap.get(r)||{},f=l.observer,h=void 0===f?null:f,d=l.query,v=void 0===d?"":d,y=l.variables,m=void 0===y?{}:y,w=l.startAckTimeoutId,_=l.subscriptionReadyCallback,E=l.subscriptionFailedCallback;if(ue.debug({id:r,observer:h,query:v,variables:m}),c===A.GQL_DATA&&o&&o.data)h?h.next(o):ue.debug("observer not found for id: "+r);else if(c!==A.GQL_START_ACK){if(c===A.GQL_CONNECTION_KEEP_ALIVE)return this.keepAliveTimeoutId&&clearTimeout(this.keepAliveTimeoutId),void(this.keepAliveTimeoutId=setTimeout(this._errorDisconnect.bind(this,X.a.TIMEOUT_DISCONNECT),this.keepAliveTimeout));if(c===A.GQL_ERROR){S=N.FAILED;h&&(this.subscriptionObserverMap.set(r,{observer:h,query:v,variables:m,startAckTimeoutId:w,subscriptionReadyCallback:_,subscriptionFailedCallback:E,subscriptionState:S}),h.error({errors:[oe({},new G.a(X.a.CONNECTION_FAILED+": "+JSON.stringify(o)))]}),w&&clearTimeout(w),h.complete(),"function"==typeof E&&E())}}else{ue.debug("subscription ready for "+JSON.stringify({query:v,variables:m})),"function"==typeof _&&_(),w&&clearTimeout(w),function(e,data,t){W.a.dispatch("api",{event:e,data:data,message:t},"PubSub",ee)}(X.a.SUBSCRIPTION_ACK,{query:v,variables:m},"Connection established for subscription");var S=N.CONNECTED;h&&this.subscriptionObserverMap.set(r,{observer:h,query:v,variables:m,startAckTimeoutId:void 0,subscriptionState:S,subscriptionReadyCallback:_,subscriptionFailedCallback:E})}},t.prototype._errorDisconnect=function(e){ue.debug("Disconnect error: "+e),this.subscriptionObserverMap.forEach((function(t){var n=t.observer;n&&!n.closed&&n.error({errors:[oe({},new G.a(e))]})})),this.subscriptionObserverMap.clear(),this.awsRealTimeSocket&&this.awsRealTimeSocket.close(),this.socketStatus=C.CLOSED},t.prototype._timeoutStartSubscriptionAck=function(e){var t=this.subscriptionObserverMap.get(e);if(t){var n=t.observer,r=t.query,o=t.variables;if(!n)return;this.subscriptionObserverMap.set(e,{observer:n,query:r,variables:o,subscriptionState:N.FAILED}),n&&!n.closed&&(n.error({errors:[oe({},new G.a("Subscription timeout "+JSON.stringify({query:r,variables:o})))]}),n.complete()),ue.debug("timeoutStartSubscription",JSON.stringify({query:r,variables:o}))}},t.prototype._initializeWebSocketConnection=function(e){var t=this,n=e.appSyncGraphqlEndpoint,r=e.authenticationType,o=e.apiKey,c=e.region,l=e.additionalHeaders;if(this.socketStatus!==C.READY)return new Promise((function(e,f){return se(t,void 0,void 0,(function(){var t,h,d,v,y,m,w,_,E,S;return ae(this,(function(O){switch(O.label){case 0:if(this.promiseArray.push({res:e,rej:f}),this.socketStatus!==C.CLOSED)return[3,5];O.label=1;case 1:return O.trys.push([1,4,,5]),this.socketStatus=C.CONNECTING,t="{}",v=(d=JSON).stringify,[4,this._awsRealTimeHeaderBasedAuth({authenticationType:r,payload:t,canonicalUri:"/connect",apiKey:o,appSyncGraphqlEndpoint:n,region:c,additionalHeaders:l})];case 2:return h=v.apply(d,[O.sent()]),y=K.Buffer.from(h).toString("base64"),m=K.Buffer.from(t).toString("base64"),w=null!=n?n:"",w=this.isCustomDomain(w)?w.concat("/realtime"):w.replace("appsync-api","appsync-realtime-api").replace("gogi-beta","grt-beta"),_=this.isSSLEnabled?"wss://":"ws://",w=w.replace("https://",_).replace("http://",_),E=w+"?header="+y+"&payload="+m,[4,this._initializeRetryableHandshake(E)];case 3:return O.sent(),this.promiseArray.forEach((function(e){var t=e.res;ue.debug("Notifying connection successful"),t()})),this.socketStatus=C.READY,this.promiseArray=[],[3,5];case 4:return S=O.sent(),this.promiseArray.forEach((function(e){return(0,e.rej)(S)})),this.promiseArray=[],this.awsRealTimeSocket&&this.awsRealTimeSocket.readyState===WebSocket.OPEN&&this.awsRealTimeSocket.close(3001),this.awsRealTimeSocket=void 0,this.socketStatus=C.CLOSED,[3,5];case 5:return[2]}}))}))}))},t.prototype._initializeRetryableHandshake=function(e){return se(this,void 0,void 0,(function(){return ae(this,(function(t){switch(t.label){case 0:return ue.debug("Initializaling retryable Handshake"),[4,Object(Y.c)(this._initializeHandshake.bind(this),[e],5e3)];case 1:return t.sent(),[2]}}))}))},t.prototype._initializeHandshake=function(e){return se(this,void 0,void 0,(function(){var t,n,r,o,c=this;return ae(this,(function(l){switch(l.label){case 0:ue.debug("Initializing handshake "+e),l.label=1;case 1:return l.trys.push([1,4,,5]),[4,new Promise((function(t,n){var r=c.getNewWebSocket(e,"graphql-ws");r.onerror=function(){ue.debug("WebSocket connection error")},r.onclose=function(){n(new Error("Connection handshake error"))},r.onopen=function(){return c.awsRealTimeSocket=r,t()}}))];case 2:return l.sent(),[4,new Promise((function(e,t){if(c.awsRealTimeSocket){var n=!1;c.awsRealTimeSocket.onerror=function(e){ue.debug("WebSocket error "+JSON.stringify(e))},c.awsRealTimeSocket.onclose=function(e){ue.debug("WebSocket closed "+e.reason),t(new Error(JSON.stringify(e)))},c.awsRealTimeSocket.onmessage=function(r){ue.debug("subscription message from AWS AppSyncRealTime: "+r.data+" ");var data=JSON.parse(r.data),o=data.type,l=data.payload,f=(void 0===l?{}:l).connectionTimeoutMs,h=void 0===f?re:f;if(o===A.GQL_CONNECTION_ACK)return n=!0,c.awsRealTimeSocket&&(c.keepAliveTimeout=h,c.awsRealTimeSocket.onmessage=c._handleIncomingSubscriptionMessage.bind(c),c.awsRealTimeSocket.onerror=function(e){ue.debug(e),c._errorDisconnect(X.a.CONNECTION_CLOSED)},c.awsRealTimeSocket.onclose=function(e){ue.debug("WebSocket closed "+e.reason),c._errorDisconnect(X.a.CONNECTION_CLOSED)}),void e("Cool, connected to AWS AppSyncRealTime");if(o===A.GQL_CONNECTION_ERROR){var d=data.payload,v=(void 0===d?{}:d).errors,y=ce(void 0===v?[]:v,1)[0],m=void 0===y?{}:y,w=m.errorType,_=void 0===w?"":w,E=m.errorCode;t({errorType:_,errorCode:void 0===E?0:E})}};var r={type:A.GQL_CONNECTION_INIT};c.awsRealTimeSocket.send(JSON.stringify(r)),setTimeout(function(e){e||t(new Error("Connection timeout: ack from AWSRealTime was not received on 15000 ms"))}.bind(c,n),ne)}}))];case 3:return l.sent(),[3,5];case 4:throw t=l.sent(),r=(n=t).errorType,o=n.errorCode,Z.includes(o)?new Y.a(r):r?new Error(r):t;case 5:return[2]}}))}))},t.prototype._awsRealTimeHeaderBasedAuth=function(e){var t=e.authenticationType,n=e.payload,r=e.canonicalUri,o=e.appSyncGraphqlEndpoint,c=e.apiKey,l=e.region,f=e.additionalHeaders;return se(this,void 0,void 0,(function(){var e,h,d;return ae(this,(function(v){switch(v.label){case 0:return e={API_KEY:this._awsRealTimeApiKeyHeader.bind(this),AWS_IAM:this._awsRealTimeIAMHeader.bind(this),OPENID_CONNECT:this._awsRealTimeOPENIDHeader.bind(this),AMAZON_COGNITO_USER_POOLS:this._awsRealTimeCUPHeader.bind(this),AWS_LAMBDA:this._customAuthHeader},t&&e[t]?[3,1]:(ue.debug("Authentication type "+t+" not supported"),[2,""]);case 1:return h=e[t],d=V.parse(null!=o?o:"").host,ue.debug("Authenticating with "+t),[4,h({payload:n,canonicalUri:r,appSyncGraphqlEndpoint:o,apiKey:c,region:l,host:d,additionalHeaders:f})];case 2:return[2,v.sent()]}}))}))},t.prototype._awsRealTimeCUPHeader=function(e){var t=e.host;return se(this,void 0,void 0,(function(){return ae(this,(function(e){switch(e.label){case 0:return[4,$.a.currentSession()];case 1:return[2,{Authorization:e.sent().getAccessToken().getJwtToken(),host:t}]}}))}))},t.prototype._awsRealTimeOPENIDHeader=function(e){var t=e.host;return se(this,void 0,void 0,(function(){var e,n,r;return ae(this,(function(o){switch(o.label){case 0:return[4,Q.a.getItem("federatedInfo")];case 1:return(n=o.sent())?(e=n.token,[3,4]):[3,2];case 2:return[4,$.a.currentAuthenticatedUser()];case 3:(r=o.sent())&&(e=r.token),o.label=4;case 4:if(!e)throw new Error("No federated jwt");return[2,{Authorization:e,host:t}]}}))}))},t.prototype._awsRealTimeApiKeyHeader=function(e){var t=e.apiKey,n=e.host;return se(this,void 0,void 0,(function(){var dt,e;return ae(this,(function(r){return dt=new Date,e=dt.toISOString().replace(/[:\-]|\.\d{3}/g,""),[2,{host:n,"x-amz-date":e,"x-api-key":t}]}))}))},t.prototype._awsRealTimeIAMHeader=function(e){var t=e.payload,n=e.canonicalUri,r=e.appSyncGraphqlEndpoint,o=e.region;return se(this,void 0,void 0,(function(){var e,c,l;return ae(this,(function(f){switch(f.label){case 0:return e={region:o,service:"appsync"},[4,this._ensureCredentials()];case 1:if(!f.sent())throw new Error("No credentials");return[4,H.a.get().then((function(e){var t=e;return{secret_key:t.secretAccessKey,access_key:t.accessKeyId,session_token:t.sessionToken}}))];case 2:return c=f.sent(),l={url:""+r+n,data:t,method:"POST",headers:oe({},te)},[2,J.a.sign(l,c,e).headers]}}))}))},t.prototype._customAuthHeader=function(e){var t=e.host,n=e.additionalHeaders;if(!n||!n.Authorization)throw new Error("No auth token specified");return{Authorization:n.Authorization,host:t}},t.prototype._ensureCredentials=function(){return H.a.get().then((function(e){if(!e)return!1;var t=H.a.shear(e);return ue.debug("set credentials for AWSAppSyncRealTimeProvider",t),!0})).catch((function(e){return ue.warn("ensure credentials error",e),!1}))},t}(w),he=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},de=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},pe=Object(c.b)().isNode,ve=new l.a("PubSub"),ye=new(function(){function e(e){this._options=null!=e?e:{},ve.debug("PubSub Options",this._options),this._pluggables=[],this.subscribe=this.subscribe.bind(this)}return Object.defineProperty(e.prototype,"awsAppSyncProvider",{get:function(){return this._awsAppSyncProvider||(this._awsAppSyncProvider=new B(this._options)),this._awsAppSyncProvider},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"awsAppSyncRealTimeProvider",{get:function(){return this._awsAppSyncRealTimeProvider||(this._awsAppSyncRealTimeProvider=new fe(this._options)),this._awsAppSyncRealTimeProvider},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"PubSub"},e.prototype.configure=function(e){var t=this,n=e?e.PubSub||e:{};return ve.debug("configure PubSub",{opt:n}),this._options=Object.assign({},this._options,n),this._pluggables.map((function(e){return e.configure(t._options)})),this._options},e.prototype.addPluggable=function(e){return he(this,void 0,void 0,(function(){return de(this,(function(t){return e&&"PubSub"===e.getCategory()?(this._pluggables.push(e),[2,e.configure(this._options)]):[2]}))}))},e.prototype.removePluggable=function(e){this._pluggables=this._pluggables.filter((function(t){return t.getProviderName()!==e}))},e.prototype.getProviderByName=function(e){return e===f.a?this.awsAppSyncProvider:e===f.b?this.awsAppSyncRealTimeProvider:this._pluggables.find((function(t){return t.getProviderName()===e}))},e.prototype.getProviders=function(e){void 0===e&&(e={});var t=e.provider;if(!t)return this._pluggables;var n=this.getProviderByName(t);if(!n)throw new Error("Could not find provider named "+t);return[n]},e.prototype.publish=function(e,t,n){return he(this,void 0,void 0,(function(){return de(this,(function(r){return[2,Promise.all(this.getProviders(n).map((function(r){return r.publish(e,t,n)})))]}))}))},e.prototype.subscribe=function(e,t){if(pe&&this._options&&this._options.ssr)throw new Error("Subscriptions are not supported for Server-Side Rendering (SSR)");ve.debug("subscribe options",t);var n=this.getProviders(t);return new o.a((function(r){var o=n.map((function(n){return{provider:n,observable:n.subscribe(e,t)}})).map((function(e){var t=e.provider;return e.observable.subscribe({start:console.error,next:function(e){return r.next({provider:t,value:e})},error:function(e){return r.error({provider:t,error:e})}})}));return function(){return o.forEach((function(e){return e.unsubscribe()}))}}))},e}());h.a.register(ye)},420:function(e,t,n){"use strict";n.d(t,"a",(function(){return we}));var r=n(675);function o(source,e,t){return new r.a("Syntax Error: ".concat(t),void 0,source,[e])}var c=Object.freeze({NAME:"Name",DOCUMENT:"Document",OPERATION_DEFINITION:"OperationDefinition",VARIABLE_DEFINITION:"VariableDefinition",SELECTION_SET:"SelectionSet",FIELD:"Field",ARGUMENT:"Argument",FRAGMENT_SPREAD:"FragmentSpread",INLINE_FRAGMENT:"InlineFragment",FRAGMENT_DEFINITION:"FragmentDefinition",VARIABLE:"Variable",INT:"IntValue",FLOAT:"FloatValue",STRING:"StringValue",BOOLEAN:"BooleanValue",NULL:"NullValue",ENUM:"EnumValue",LIST:"ListValue",OBJECT:"ObjectValue",OBJECT_FIELD:"ObjectField",DIRECTIVE:"Directive",NAMED_TYPE:"NamedType",LIST_TYPE:"ListType",NON_NULL_TYPE:"NonNullType",SCHEMA_DEFINITION:"SchemaDefinition",OPERATION_TYPE_DEFINITION:"OperationTypeDefinition",SCALAR_TYPE_DEFINITION:"ScalarTypeDefinition",OBJECT_TYPE_DEFINITION:"ObjectTypeDefinition",FIELD_DEFINITION:"FieldDefinition",INPUT_VALUE_DEFINITION:"InputValueDefinition",INTERFACE_TYPE_DEFINITION:"InterfaceTypeDefinition",UNION_TYPE_DEFINITION:"UnionTypeDefinition",ENUM_TYPE_DEFINITION:"EnumTypeDefinition",ENUM_VALUE_DEFINITION:"EnumValueDefinition",INPUT_OBJECT_TYPE_DEFINITION:"InputObjectTypeDefinition",DIRECTIVE_DEFINITION:"DirectiveDefinition",SCHEMA_EXTENSION:"SchemaExtension",SCALAR_TYPE_EXTENSION:"ScalarTypeExtension",OBJECT_TYPE_EXTENSION:"ObjectTypeExtension",INTERFACE_TYPE_EXTENSION:"InterfaceTypeExtension",UNION_TYPE_EXTENSION:"UnionTypeExtension",ENUM_TYPE_EXTENSION:"EnumTypeExtension",INPUT_OBJECT_TYPE_EXTENSION:"InputObjectTypeExtension"});var l="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):void 0;function f(e){var t=e.prototype.toJSON;"function"==typeof t||function(e,t){if(!Boolean(e))throw new Error(null!=t?t:"Unexpected invariant triggered.")}(0),e.prototype.inspect=t,l&&(e.prototype[l]=t)}var h=function(){function e(e,t,source){this.start=e.start,this.end=t.end,this.startToken=e,this.endToken=t,this.source=source}return e.prototype.toJSON=function(){return{start:this.start,end:this.end}},e}();f(h);var d=function(){function e(e,t,n,line,r,o,c){this.kind=e,this.start=t,this.end=n,this.line=line,this.column=r,this.value=c,this.prev=o,this.next=null}return e.prototype.toJSON=function(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}},e}();function v(e){return null!=e&&"string"==typeof e.kind}f(d);var y=Object.freeze({SOF:"<SOF>",EOF:"<EOF>",BANG:"!",DOLLAR:"$",AMP:"&",PAREN_L:"(",PAREN_R:")",SPREAD:"...",COLON:":",EQUALS:"=",AT:"@",BRACKET_L:"[",BRACKET_R:"]",BRACE_L:"{",PIPE:"|",BRACE_R:"}",NAME:"Name",INT:"Int",FLOAT:"Float",STRING:"String",BLOCK_STRING:"BlockString",COMMENT:"Comment"}),m=n(611);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function _(e){return E(e,[])}function E(e,t){switch(w(e)){case"string":return JSON.stringify(e);case"function":return e.name?"[function ".concat(e.name,"]"):"[function]";case"object":return null===e?"null":function(e,t){if(-1!==t.indexOf(e))return"[Circular]";var n=[].concat(t,[e]),r=function(object){var e=object[String(l)];if("function"==typeof e)return e;if("function"==typeof object.inspect)return object.inspect}(e);if(void 0!==r){var o=r.call(e);if(o!==e)return"string"==typeof o?o:E(o,n)}else if(Array.isArray(e))return function(e,t){if(0===e.length)return"[]";if(t.length>2)return"[Array]";for(var n=Math.min(10,e.length),r=e.length-n,o=[],i=0;i<n;++i)o.push(E(e[i],t));1===r?o.push("... 1 more item"):r>1&&o.push("... ".concat(r," more items"));return"["+o.join(", ")+"]"}(e,n);return function(object,e){var t=Object.keys(object);if(0===t.length)return"{}";if(e.length>2)return"["+function(object){var e=Object.prototype.toString.call(object).replace(/^\[object /,"").replace(/]$/,"");if("Object"===e&&"function"==typeof object.constructor){var t=object.constructor.name;if("string"==typeof t&&""!==t)return t}return e}(object)+"]";var n=t.map((function(t){return t+": "+E(object[t],e)}));return"{ "+n.join(", ")+" }"}(e,n)}(e,t);default:return String(e)}}function S(e,t){if(!Boolean(e))throw new Error(t)}var O=function(e,t){return e instanceof t};function T(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var I=function(){function e(body){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GraphQL request",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{line:1,column:1};"string"==typeof body||S(0,"Body must be a string. Received: ".concat(_(body),".")),this.body=body,this.name=e,this.locationOffset=t,this.locationOffset.line>0||S(0,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||S(0,"column in locationOffset is 1-indexed and must be positive.")}var t,n,r;return t=e,(n=[{key:m.a,get:function(){return"Source"}}])&&T(t.prototype,n),r&&T(t,r),e}();var A=Object.freeze({QUERY:"QUERY",MUTATION:"MUTATION",SUBSCRIPTION:"SUBSCRIPTION",FIELD:"FIELD",FRAGMENT_DEFINITION:"FRAGMENT_DEFINITION",FRAGMENT_SPREAD:"FRAGMENT_SPREAD",INLINE_FRAGMENT:"INLINE_FRAGMENT",VARIABLE_DEFINITION:"VARIABLE_DEFINITION",SCHEMA:"SCHEMA",SCALAR:"SCALAR",OBJECT:"OBJECT",FIELD_DEFINITION:"FIELD_DEFINITION",ARGUMENT_DEFINITION:"ARGUMENT_DEFINITION",INTERFACE:"INTERFACE",UNION:"UNION",ENUM:"ENUM",ENUM_VALUE:"ENUM_VALUE",INPUT_OBJECT:"INPUT_OBJECT",INPUT_FIELD_DEFINITION:"INPUT_FIELD_DEFINITION"});function N(e){var t=e.split(/\r\n|[\n\r]/g),n=function(e){for(var t,n=!0,r=!0,o=0,c=null,i=0;i<e.length;++i)switch(e.charCodeAt(i)){case 13:10===e.charCodeAt(i+1)&&++i;case 10:n=!1,r=!0,o=0;break;case 9:case 32:++o;break;default:r&&!n&&(null===c||o<c)&&(c=o),r=!1}return null!==(t=c)&&void 0!==t?t:0}(e);if(0!==n)for(var i=1;i<t.length;i++)t[i]=t[i].slice(n);for(var r=0;r<t.length&&C(t[r]);)++r;for(var o=t.length;o>r&&C(t[o-1]);)--o;return t.slice(r,o).join("\n")}function C(e){for(var i=0;i<e.length;++i)if(" "!==e[i]&&"\t"!==e[i])return!1;return!0}var x=function(){function e(source){var e=new d(y.SOF,0,0,0,0,null);this.source=source,this.lastToken=e,this.token=e,this.line=1,this.lineStart=0}var t=e.prototype;return t.advance=function(){return this.lastToken=this.token,this.token=this.lookahead()},t.lookahead=function(){var e=this.token;if(e.kind!==y.EOF)do{var t;e=null!==(t=e.next)&&void 0!==t?t:e.next=P(this,e)}while(e.kind===y.COMMENT);return e},e}();function k(code){return isNaN(code)?y.EOF:code<127?JSON.stringify(String.fromCharCode(code)):'"\\u'.concat(("00"+code.toString(16).toUpperCase()).slice(-4),'"')}function P(e,t){for(var source=e.source,body=source.body,n=body.length,r=t.end;r<n;){var code=body.charCodeAt(r),c=e.line,l=1+r-e.lineStart;switch(code){case 65279:case 9:case 32:case 44:++r;continue;case 10:++r,++e.line,e.lineStart=r;continue;case 13:10===body.charCodeAt(r+1)?r+=2:++r,++e.line,e.lineStart=r;continue;case 33:return new d(y.BANG,r,r+1,c,l,t);case 35:return D(source,r,c,l,t);case 36:return new d(y.DOLLAR,r,r+1,c,l,t);case 38:return new d(y.AMP,r,r+1,c,l,t);case 40:return new d(y.PAREN_L,r,r+1,c,l,t);case 41:return new d(y.PAREN_R,r,r+1,c,l,t);case 46:if(46===body.charCodeAt(r+1)&&46===body.charCodeAt(r+2))return new d(y.SPREAD,r,r+3,c,l,t);break;case 58:return new d(y.COLON,r,r+1,c,l,t);case 61:return new d(y.EQUALS,r,r+1,c,l,t);case 64:return new d(y.AT,r,r+1,c,l,t);case 91:return new d(y.BRACKET_L,r,r+1,c,l,t);case 93:return new d(y.BRACKET_R,r,r+1,c,l,t);case 123:return new d(y.BRACE_L,r,r+1,c,l,t);case 124:return new d(y.PIPE,r,r+1,c,l,t);case 125:return new d(y.BRACE_R,r,r+1,c,l,t);case 34:return 34===body.charCodeAt(r+1)&&34===body.charCodeAt(r+2)?F(source,r,c,l,t,e):L(source,r,c,l,t);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return R(source,r,code,c,l,t);case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 95:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:return B(source,r,c,l,t)}throw o(source,r,M(code))}var line=e.line,col=1+r-e.lineStart;return new d(y.EOF,n,n,line,col,t)}function M(code){return code<32&&9!==code&&10!==code&&13!==code?"Cannot contain the invalid character ".concat(k(code),"."):39===code?"Unexpected single quote character ('), did you mean to use a double quote (\")?":"Cannot parse the unexpected character ".concat(k(code),".")}function D(source,e,line,col,t){var code,body=source.body,n=e;do{code=body.charCodeAt(++n)}while(!isNaN(code)&&(code>31||9===code));return new d(y.COMMENT,e,n,line,col,t,body.slice(e+1,n))}function R(source,e,t,line,col,n){var body=source.body,code=t,r=e,c=!1;if(45===code&&(code=body.charCodeAt(++r)),48===code){if((code=body.charCodeAt(++r))>=48&&code<=57)throw o(source,r,"Invalid number, unexpected digit after 0: ".concat(k(code),"."))}else r=j(source,r,code),code=body.charCodeAt(r);if(46===code&&(c=!0,code=body.charCodeAt(++r),r=j(source,r,code),code=body.charCodeAt(r)),69!==code&&101!==code||(c=!0,43!==(code=body.charCodeAt(++r))&&45!==code||(code=body.charCodeAt(++r)),r=j(source,r,code),code=body.charCodeAt(r)),46===code||function(code){return 95===code||code>=65&&code<=90||code>=97&&code<=122}(code))throw o(source,r,"Invalid number, expected digit but got: ".concat(k(code),"."));return new d(c?y.FLOAT:y.INT,e,r,line,col,n,body.slice(e,r))}function j(source,e,t){var body=source.body,n=e,code=t;if(code>=48&&code<=57){do{code=body.charCodeAt(++n)}while(code>=48&&code<=57);return n}throw o(source,n,"Invalid number, expected digit but got: ".concat(k(code),"."))}function L(source,e,line,col,t){for(var a,b,n,r,body=source.body,c=e+1,l=c,code=0,f="";c<body.length&&!isNaN(code=body.charCodeAt(c))&&10!==code&&13!==code;){if(34===code)return f+=body.slice(l,c),new d(y.STRING,e,c+1,line,col,t,f);if(code<32&&9!==code)throw o(source,c,"Invalid character within String: ".concat(k(code),"."));if(++c,92===code){switch(f+=body.slice(l,c-1),code=body.charCodeAt(c)){case 34:f+='"';break;case 47:f+="/";break;case 92:f+="\\";break;case 98:f+="\b";break;case 102:f+="\f";break;case 110:f+="\n";break;case 114:f+="\r";break;case 116:f+="\t";break;case 117:var h=(a=body.charCodeAt(c+1),b=body.charCodeAt(c+2),n=body.charCodeAt(c+3),r=body.charCodeAt(c+4),U(a)<<12|U(b)<<8|U(n)<<4|U(r));if(h<0){var v=body.slice(c+1,c+5);throw o(source,c,"Invalid character escape sequence: \\u".concat(v,"."))}f+=String.fromCharCode(h),c+=4;break;default:throw o(source,c,"Invalid character escape sequence: \\".concat(String.fromCharCode(code),"."))}l=++c}}throw o(source,c,"Unterminated string.")}function F(source,e,line,col,t,n){for(var body=source.body,r=e+3,c=r,code=0,l="";r<body.length&&!isNaN(code=body.charCodeAt(r));){if(34===code&&34===body.charCodeAt(r+1)&&34===body.charCodeAt(r+2))return l+=body.slice(c,r),new d(y.BLOCK_STRING,e,r+3,line,col,t,N(l));if(code<32&&9!==code&&10!==code&&13!==code)throw o(source,r,"Invalid character within String: ".concat(k(code),"."));10===code?(++r,++n.line,n.lineStart=r):13===code?(10===body.charCodeAt(r+1)?r+=2:++r,++n.line,n.lineStart=r):92===code&&34===body.charCodeAt(r+1)&&34===body.charCodeAt(r+2)&&34===body.charCodeAt(r+3)?(l+=body.slice(c,r)+'"""',c=r+=4):++r}throw o(source,r,"Unterminated string.")}function U(a){return a>=48&&a<=57?a-48:a>=65&&a<=70?a-55:a>=97&&a<=102?a-87:-1}function B(source,e,line,col,t){for(var body=source.body,n=body.length,r=e+1,code=0;r!==n&&!isNaN(code=body.charCodeAt(r))&&(95===code||code>=48&&code<=57||code>=65&&code<=90||code>=97&&code<=122);)++r;return new d(y.NAME,e,r,line,col,t,body.slice(e,r))}function G(source,e){return new V(source,e).parseDocument()}var V=function(){function e(source,e){var t=function(source){return O(source,I)}(source)?source:new I(source);this._lexer=new x(t),this._options=e}var t=e.prototype;return t.parseName=function(){var e=this.expectToken(y.NAME);return{kind:c.NAME,value:e.value,loc:this.loc(e)}},t.parseDocument=function(){var e=this._lexer.token;return{kind:c.DOCUMENT,definitions:this.many(y.SOF,this.parseDefinition,y.EOF),loc:this.loc(e)}},t.parseDefinition=function(){if(this.peek(y.NAME))switch(this._lexer.token.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"schema":case"scalar":case"type":case"interface":case"union":case"enum":case"input":case"directive":return this.parseTypeSystemDefinition();case"extend":return this.parseTypeSystemExtension()}else{if(this.peek(y.BRACE_L))return this.parseOperationDefinition();if(this.peekDescription())return this.parseTypeSystemDefinition()}throw this.unexpected()},t.parseOperationDefinition=function(){var e=this._lexer.token;if(this.peek(y.BRACE_L))return{kind:c.OPERATION_DEFINITION,operation:"query",name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet(),loc:this.loc(e)};var t,n=this.parseOperationType();return this.peek(y.NAME)&&(t=this.parseName()),{kind:c.OPERATION_DEFINITION,operation:n,name:t,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(e)}},t.parseOperationType=function(){var e=this.expectToken(y.NAME);switch(e.value){case"query":return"query";case"mutation":return"mutation";case"subscription":return"subscription"}throw this.unexpected(e)},t.parseVariableDefinitions=function(){return this.optionalMany(y.PAREN_L,this.parseVariableDefinition,y.PAREN_R)},t.parseVariableDefinition=function(){var e=this._lexer.token;return{kind:c.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(y.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(y.EQUALS)?this.parseValueLiteral(!0):void 0,directives:this.parseDirectives(!0),loc:this.loc(e)}},t.parseVariable=function(){var e=this._lexer.token;return this.expectToken(y.DOLLAR),{kind:c.VARIABLE,name:this.parseName(),loc:this.loc(e)}},t.parseSelectionSet=function(){var e=this._lexer.token;return{kind:c.SELECTION_SET,selections:this.many(y.BRACE_L,this.parseSelection,y.BRACE_R),loc:this.loc(e)}},t.parseSelection=function(){return this.peek(y.SPREAD)?this.parseFragment():this.parseField()},t.parseField=function(){var e,t,n=this._lexer.token,r=this.parseName();return this.expectOptionalToken(y.COLON)?(e=r,t=this.parseName()):t=r,{kind:c.FIELD,alias:e,name:t,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(y.BRACE_L)?this.parseSelectionSet():void 0,loc:this.loc(n)}},t.parseArguments=function(e){var t=e?this.parseConstArgument:this.parseArgument;return this.optionalMany(y.PAREN_L,t,y.PAREN_R)},t.parseArgument=function(){var e=this._lexer.token,t=this.parseName();return this.expectToken(y.COLON),{kind:c.ARGUMENT,name:t,value:this.parseValueLiteral(!1),loc:this.loc(e)}},t.parseConstArgument=function(){var e=this._lexer.token;return{kind:c.ARGUMENT,name:this.parseName(),value:(this.expectToken(y.COLON),this.parseValueLiteral(!0)),loc:this.loc(e)}},t.parseFragment=function(){var e=this._lexer.token;this.expectToken(y.SPREAD);var t=this.expectOptionalKeyword("on");return!t&&this.peek(y.NAME)?{kind:c.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1),loc:this.loc(e)}:{kind:c.INLINE_FRAGMENT,typeCondition:t?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(e)}},t.parseFragmentDefinition=function(){var e,t=this._lexer.token;return this.expectKeyword("fragment"),!0===(null===(e=this._options)||void 0===e?void 0:e.experimentalFragmentVariables)?{kind:c.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(t)}:{kind:c.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(t)}},t.parseFragmentName=function(){if("on"===this._lexer.token.value)throw this.unexpected();return this.parseName()},t.parseValueLiteral=function(e){var t=this._lexer.token;switch(t.kind){case y.BRACKET_L:return this.parseList(e);case y.BRACE_L:return this.parseObject(e);case y.INT:return this._lexer.advance(),{kind:c.INT,value:t.value,loc:this.loc(t)};case y.FLOAT:return this._lexer.advance(),{kind:c.FLOAT,value:t.value,loc:this.loc(t)};case y.STRING:case y.BLOCK_STRING:return this.parseStringLiteral();case y.NAME:switch(this._lexer.advance(),t.value){case"true":return{kind:c.BOOLEAN,value:!0,loc:this.loc(t)};case"false":return{kind:c.BOOLEAN,value:!1,loc:this.loc(t)};case"null":return{kind:c.NULL,loc:this.loc(t)};default:return{kind:c.ENUM,value:t.value,loc:this.loc(t)}}case y.DOLLAR:if(!e)return this.parseVariable()}throw this.unexpected()},t.parseStringLiteral=function(){var e=this._lexer.token;return this._lexer.advance(),{kind:c.STRING,value:e.value,block:e.kind===y.BLOCK_STRING,loc:this.loc(e)}},t.parseList=function(e){var t=this,n=this._lexer.token;return{kind:c.LIST,values:this.any(y.BRACKET_L,(function(){return t.parseValueLiteral(e)}),y.BRACKET_R),loc:this.loc(n)}},t.parseObject=function(e){var t=this,n=this._lexer.token;return{kind:c.OBJECT,fields:this.any(y.BRACE_L,(function(){return t.parseObjectField(e)}),y.BRACE_R),loc:this.loc(n)}},t.parseObjectField=function(e){var t=this._lexer.token,n=this.parseName();return this.expectToken(y.COLON),{kind:c.OBJECT_FIELD,name:n,value:this.parseValueLiteral(e),loc:this.loc(t)}},t.parseDirectives=function(e){for(var t=[];this.peek(y.AT);)t.push(this.parseDirective(e));return t},t.parseDirective=function(e){var t=this._lexer.token;return this.expectToken(y.AT),{kind:c.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(e),loc:this.loc(t)}},t.parseTypeReference=function(){var e,t=this._lexer.token;return this.expectOptionalToken(y.BRACKET_L)?(e=this.parseTypeReference(),this.expectToken(y.BRACKET_R),e={kind:c.LIST_TYPE,type:e,loc:this.loc(t)}):e=this.parseNamedType(),this.expectOptionalToken(y.BANG)?{kind:c.NON_NULL_TYPE,type:e,loc:this.loc(t)}:e},t.parseNamedType=function(){var e=this._lexer.token;return{kind:c.NAMED_TYPE,name:this.parseName(),loc:this.loc(e)}},t.parseTypeSystemDefinition=function(){var e=this.peekDescription()?this._lexer.lookahead():this._lexer.token;if(e.kind===y.NAME)switch(e.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}throw this.unexpected(e)},t.peekDescription=function(){return this.peek(y.STRING)||this.peek(y.BLOCK_STRING)},t.parseDescription=function(){if(this.peekDescription())return this.parseStringLiteral()},t.parseSchemaDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("schema");var n=this.parseDirectives(!0),r=this.many(y.BRACE_L,this.parseOperationTypeDefinition,y.BRACE_R);return{kind:c.SCHEMA_DEFINITION,description:t,directives:n,operationTypes:r,loc:this.loc(e)}},t.parseOperationTypeDefinition=function(){var e=this._lexer.token,t=this.parseOperationType();this.expectToken(y.COLON);var n=this.parseNamedType();return{kind:c.OPERATION_TYPE_DEFINITION,operation:t,type:n,loc:this.loc(e)}},t.parseScalarTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("scalar");var n=this.parseName(),r=this.parseDirectives(!0);return{kind:c.SCALAR_TYPE_DEFINITION,description:t,name:n,directives:r,loc:this.loc(e)}},t.parseObjectTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("type");var n=this.parseName(),r=this.parseImplementsInterfaces(),o=this.parseDirectives(!0),l=this.parseFieldsDefinition();return{kind:c.OBJECT_TYPE_DEFINITION,description:t,name:n,interfaces:r,directives:o,fields:l,loc:this.loc(e)}},t.parseImplementsInterfaces=function(){var e;if(!this.expectOptionalKeyword("implements"))return[];if(!0===(null===(e=this._options)||void 0===e?void 0:e.allowLegacySDLImplementsInterfaces)){var t=[];this.expectOptionalToken(y.AMP);do{t.push(this.parseNamedType())}while(this.expectOptionalToken(y.AMP)||this.peek(y.NAME));return t}return this.delimitedMany(y.AMP,this.parseNamedType)},t.parseFieldsDefinition=function(){var e;return!0===(null===(e=this._options)||void 0===e?void 0:e.allowLegacySDLEmptyFields)&&this.peek(y.BRACE_L)&&this._lexer.lookahead().kind===y.BRACE_R?(this._lexer.advance(),this._lexer.advance(),[]):this.optionalMany(y.BRACE_L,this.parseFieldDefinition,y.BRACE_R)},t.parseFieldDefinition=function(){var e=this._lexer.token,t=this.parseDescription(),n=this.parseName(),r=this.parseArgumentDefs();this.expectToken(y.COLON);var o=this.parseTypeReference(),l=this.parseDirectives(!0);return{kind:c.FIELD_DEFINITION,description:t,name:n,arguments:r,type:o,directives:l,loc:this.loc(e)}},t.parseArgumentDefs=function(){return this.optionalMany(y.PAREN_L,this.parseInputValueDef,y.PAREN_R)},t.parseInputValueDef=function(){var e=this._lexer.token,t=this.parseDescription(),n=this.parseName();this.expectToken(y.COLON);var r,o=this.parseTypeReference();this.expectOptionalToken(y.EQUALS)&&(r=this.parseValueLiteral(!0));var l=this.parseDirectives(!0);return{kind:c.INPUT_VALUE_DEFINITION,description:t,name:n,type:o,defaultValue:r,directives:l,loc:this.loc(e)}},t.parseInterfaceTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("interface");var n=this.parseName(),r=this.parseImplementsInterfaces(),o=this.parseDirectives(!0),l=this.parseFieldsDefinition();return{kind:c.INTERFACE_TYPE_DEFINITION,description:t,name:n,interfaces:r,directives:o,fields:l,loc:this.loc(e)}},t.parseUnionTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("union");var n=this.parseName(),r=this.parseDirectives(!0),o=this.parseUnionMemberTypes();return{kind:c.UNION_TYPE_DEFINITION,description:t,name:n,directives:r,types:o,loc:this.loc(e)}},t.parseUnionMemberTypes=function(){return this.expectOptionalToken(y.EQUALS)?this.delimitedMany(y.PIPE,this.parseNamedType):[]},t.parseEnumTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("enum");var n=this.parseName(),r=this.parseDirectives(!0),o=this.parseEnumValuesDefinition();return{kind:c.ENUM_TYPE_DEFINITION,description:t,name:n,directives:r,values:o,loc:this.loc(e)}},t.parseEnumValuesDefinition=function(){return this.optionalMany(y.BRACE_L,this.parseEnumValueDefinition,y.BRACE_R)},t.parseEnumValueDefinition=function(){var e=this._lexer.token,t=this.parseDescription(),n=this.parseName(),r=this.parseDirectives(!0);return{kind:c.ENUM_VALUE_DEFINITION,description:t,name:n,directives:r,loc:this.loc(e)}},t.parseInputObjectTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("input");var n=this.parseName(),r=this.parseDirectives(!0),o=this.parseInputFieldsDefinition();return{kind:c.INPUT_OBJECT_TYPE_DEFINITION,description:t,name:n,directives:r,fields:o,loc:this.loc(e)}},t.parseInputFieldsDefinition=function(){return this.optionalMany(y.BRACE_L,this.parseInputValueDef,y.BRACE_R)},t.parseTypeSystemExtension=function(){var e=this._lexer.lookahead();if(e.kind===y.NAME)switch(e.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(e)},t.parseSchemaExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");var t=this.parseDirectives(!0),n=this.optionalMany(y.BRACE_L,this.parseOperationTypeDefinition,y.BRACE_R);if(0===t.length&&0===n.length)throw this.unexpected();return{kind:c.SCHEMA_EXTENSION,directives:t,operationTypes:n,loc:this.loc(e)}},t.parseScalarTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");var t=this.parseName(),n=this.parseDirectives(!0);if(0===n.length)throw this.unexpected();return{kind:c.SCALAR_TYPE_EXTENSION,name:t,directives:n,loc:this.loc(e)}},t.parseObjectTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");var t=this.parseName(),n=this.parseImplementsInterfaces(),r=this.parseDirectives(!0),o=this.parseFieldsDefinition();if(0===n.length&&0===r.length&&0===o.length)throw this.unexpected();return{kind:c.OBJECT_TYPE_EXTENSION,name:t,interfaces:n,directives:r,fields:o,loc:this.loc(e)}},t.parseInterfaceTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");var t=this.parseName(),n=this.parseImplementsInterfaces(),r=this.parseDirectives(!0),o=this.parseFieldsDefinition();if(0===n.length&&0===r.length&&0===o.length)throw this.unexpected();return{kind:c.INTERFACE_TYPE_EXTENSION,name:t,interfaces:n,directives:r,fields:o,loc:this.loc(e)}},t.parseUnionTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");var t=this.parseName(),n=this.parseDirectives(!0),r=this.parseUnionMemberTypes();if(0===n.length&&0===r.length)throw this.unexpected();return{kind:c.UNION_TYPE_EXTENSION,name:t,directives:n,types:r,loc:this.loc(e)}},t.parseEnumTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");var t=this.parseName(),n=this.parseDirectives(!0),r=this.parseEnumValuesDefinition();if(0===n.length&&0===r.length)throw this.unexpected();return{kind:c.ENUM_TYPE_EXTENSION,name:t,directives:n,values:r,loc:this.loc(e)}},t.parseInputObjectTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");var t=this.parseName(),n=this.parseDirectives(!0),r=this.parseInputFieldsDefinition();if(0===n.length&&0===r.length)throw this.unexpected();return{kind:c.INPUT_OBJECT_TYPE_EXTENSION,name:t,directives:n,fields:r,loc:this.loc(e)}},t.parseDirectiveDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("directive"),this.expectToken(y.AT);var n=this.parseName(),r=this.parseArgumentDefs(),o=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");var l=this.parseDirectiveLocations();return{kind:c.DIRECTIVE_DEFINITION,description:t,name:n,arguments:r,repeatable:o,locations:l,loc:this.loc(e)}},t.parseDirectiveLocations=function(){return this.delimitedMany(y.PIPE,this.parseDirectiveLocation)},t.parseDirectiveLocation=function(){var e=this._lexer.token,t=this.parseName();if(void 0!==A[t.value])return t;throw this.unexpected(e)},t.loc=function(e){var t;if(!0!==(null===(t=this._options)||void 0===t?void 0:t.noLocation))return new h(e,this._lexer.lastToken,this._lexer.source)},t.peek=function(e){return this._lexer.token.kind===e},t.expectToken=function(e){var t=this._lexer.token;if(t.kind===e)return this._lexer.advance(),t;throw o(this._lexer.source,t.start,"Expected ".concat(W(e),", found ").concat(K(t),"."))},t.expectOptionalToken=function(e){var t=this._lexer.token;if(t.kind===e)return this._lexer.advance(),t},t.expectKeyword=function(e){var t=this._lexer.token;if(t.kind!==y.NAME||t.value!==e)throw o(this._lexer.source,t.start,'Expected "'.concat(e,'", found ').concat(K(t),"."));this._lexer.advance()},t.expectOptionalKeyword=function(e){var t=this._lexer.token;return t.kind===y.NAME&&t.value===e&&(this._lexer.advance(),!0)},t.unexpected=function(e){var t=null!=e?e:this._lexer.token;return o(this._lexer.source,t.start,"Unexpected ".concat(K(t),"."))},t.any=function(e,t,n){this.expectToken(e);for(var r=[];!this.expectOptionalToken(n);)r.push(t.call(this));return r},t.optionalMany=function(e,t,n){if(this.expectOptionalToken(e)){var r=[];do{r.push(t.call(this))}while(!this.expectOptionalToken(n));return r}return[]},t.many=function(e,t,n){this.expectToken(e);var r=[];do{r.push(t.call(this))}while(!this.expectOptionalToken(n));return r},t.delimitedMany=function(e,t){this.expectOptionalToken(e);var n=[];do{n.push(t.call(this))}while(this.expectOptionalToken(e));return n},e}();function K(e){var t=e.value;return W(e.kind)+(null!=t?' "'.concat(t,'"'):"")}function W(e){return function(e){return e===y.BANG||e===y.DOLLAR||e===y.AMP||e===y.PAREN_L||e===y.PAREN_R||e===y.SPREAD||e===y.COLON||e===y.EQUALS||e===y.AT||e===y.BRACKET_L||e===y.BRACKET_R||e===y.BRACE_L||e===y.PIPE||e===y.BRACE_R}(e)?'"'.concat(e,'"'):e}var z={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},Y=Object.freeze({});function H(e,t,n){var r=e[t];if(r){if(!n&&"function"==typeof r)return r;var o=n?r.leave:r.enter;if("function"==typeof o)return o}else{var c=n?e.leave:e.enter;if(c){if("function"==typeof c)return c;var l=c[t];if("function"==typeof l)return l}}}function J(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:z,r=void 0,o=Array.isArray(e),c=[e],l=-1,f=[],h=void 0,d=void 0,y=void 0,path=[],m=[],w=e;do{var E=++l===c.length,S=E&&0!==f.length;if(E){if(d=0===m.length?void 0:path[path.length-1],h=y,y=m.pop(),S){if(o)h=h.slice();else{for(var O={},T=0,I=Object.keys(h);T<I.length;T++){var A=I[T];O[A]=h[A]}h=O}for(var N=0,C=0;C<f.length;C++){var x=f[C][0],k=f[C][1];o&&(x-=N),o&&null===k?(h.splice(x,1),N++):h[x]=k}}l=r.index,c=r.keys,f=r.edits,o=r.inArray,r=r.prev}else{if(d=y?o?l:c[l]:void 0,null==(h=y?y[d]:w))continue;y&&path.push(d)}var P,M=void 0;if(!Array.isArray(h)){if(!v(h))throw new Error("Invalid AST Node: ".concat(_(h),"."));var D=H(t,h.kind,E);if(D){if((M=D.call(t,h,d,y,path,m))===Y)break;if(!1===M){if(!E){path.pop();continue}}else if(void 0!==M&&(f.push([d,M]),!E)){if(!v(M)){path.pop();continue}h=M}}}void 0===M&&S&&f.push([d,h]),E?path.pop():(r={inArray:o,index:l,keys:c,edits:f,prev:r},c=(o=Array.isArray(h))?h:null!==(P=n[h.kind])&&void 0!==P?P:[],l=-1,f=[],y&&m.push(y),y=h)}while(void 0!==r);return 0!==f.length&&(w=f[f.length-1][1]),w}(e,{leave:Q})}var Q={Name:function(e){return e.value},Variable:function(e){return"$"+e.name},Document:function(e){return X(e.definitions,"\n\n")+"\n"},OperationDefinition:function(e){var t=e.operation,n=e.name,r=ee("(",X(e.variableDefinitions,", "),")"),o=X(e.directives," "),c=e.selectionSet;return n||o||r||"query"!==t?X([t,X([n,r]),o,c]," "):c},VariableDefinition:function(e){var t=e.variable,n=e.type,r=e.defaultValue,o=e.directives;return t+": "+n+ee(" = ",r)+ee(" ",X(o," "))},SelectionSet:function(e){return Z(e.selections)},Field:function(e){var t=e.alias,n=e.name,r=e.arguments,o=e.directives,c=e.selectionSet,l=ee("",t,": ")+n,f=l+ee("(",X(r,", "),")");return f.length>80&&(f=l+ee("(\n",te(X(r,"\n")),"\n)")),X([f,X(o," "),c]," ")},Argument:function(e){return e.name+": "+e.value},FragmentSpread:function(e){return"..."+e.name+ee(" ",X(e.directives," "))},InlineFragment:function(e){var t=e.typeCondition,n=e.directives,r=e.selectionSet;return X(["...",ee("on ",t),X(n," "),r]," ")},FragmentDefinition:function(e){var t=e.name,n=e.typeCondition,r=e.variableDefinitions,o=e.directives,c=e.selectionSet;return"fragment ".concat(t).concat(ee("(",X(r,", "),")")," ")+"on ".concat(n," ").concat(ee("",X(o," ")," "))+c},IntValue:function(e){return e.value},FloatValue:function(e){return e.value},StringValue:function(e,t){var n=e.value;return e.block?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=-1===e.indexOf("\n"),o=" "===e[0]||"\t"===e[0],c='"'===e[e.length-1],l="\\"===e[e.length-1],f=!r||c||l||n,h="";return!f||r&&o||(h+="\n"+t),h+=t?e.replace(/\n/g,"\n"+t):e,f&&(h+="\n"),'"""'+h.replace(/"""/g,'\\"""')+'"""'}(n,"description"===t?"":"  "):JSON.stringify(n)},BooleanValue:function(e){return e.value?"true":"false"},NullValue:function(){return"null"},EnumValue:function(e){return e.value},ListValue:function(e){return"["+X(e.values,", ")+"]"},ObjectValue:function(e){return"{"+X(e.fields,", ")+"}"},ObjectField:function(e){return e.name+": "+e.value},Directive:function(e){return"@"+e.name+ee("(",X(e.arguments,", "),")")},NamedType:function(e){return e.name},ListType:function(e){return"["+e.type+"]"},NonNullType:function(e){return e.type+"!"},SchemaDefinition:$((function(e){var t=e.directives,n=e.operationTypes;return X(["schema",X(t," "),Z(n)]," ")})),OperationTypeDefinition:function(e){return e.operation+": "+e.type},ScalarTypeDefinition:$((function(e){return X(["scalar",e.name,X(e.directives," ")]," ")})),ObjectTypeDefinition:$((function(e){var t=e.name,n=e.interfaces,r=e.directives,o=e.fields;return X(["type",t,ee("implements ",X(n," & ")),X(r," "),Z(o)]," ")})),FieldDefinition:$((function(e){var t=e.name,n=e.arguments,r=e.type,o=e.directives;return t+(re(n)?ee("(\n",te(X(n,"\n")),"\n)"):ee("(",X(n,", "),")"))+": "+r+ee(" ",X(o," "))})),InputValueDefinition:$((function(e){var t=e.name,n=e.type,r=e.defaultValue,o=e.directives;return X([t+": "+n,ee("= ",r),X(o," ")]," ")})),InterfaceTypeDefinition:$((function(e){var t=e.name,n=e.interfaces,r=e.directives,o=e.fields;return X(["interface",t,ee("implements ",X(n," & ")),X(r," "),Z(o)]," ")})),UnionTypeDefinition:$((function(e){var t=e.name,n=e.directives,r=e.types;return X(["union",t,X(n," "),r&&0!==r.length?"= "+X(r," | "):""]," ")})),EnumTypeDefinition:$((function(e){var t=e.name,n=e.directives,r=e.values;return X(["enum",t,X(n," "),Z(r)]," ")})),EnumValueDefinition:$((function(e){return X([e.name,X(e.directives," ")]," ")})),InputObjectTypeDefinition:$((function(e){var t=e.name,n=e.directives,r=e.fields;return X(["input",t,X(n," "),Z(r)]," ")})),DirectiveDefinition:$((function(e){var t=e.name,n=e.arguments,r=e.repeatable,o=e.locations;return"directive @"+t+(re(n)?ee("(\n",te(X(n,"\n")),"\n)"):ee("(",X(n,", "),")"))+(r?" repeatable":"")+" on "+X(o," | ")})),SchemaExtension:function(e){var t=e.directives,n=e.operationTypes;return X(["extend schema",X(t," "),Z(n)]," ")},ScalarTypeExtension:function(e){return X(["extend scalar",e.name,X(e.directives," ")]," ")},ObjectTypeExtension:function(e){var t=e.name,n=e.interfaces,r=e.directives,o=e.fields;return X(["extend type",t,ee("implements ",X(n," & ")),X(r," "),Z(o)]," ")},InterfaceTypeExtension:function(e){var t=e.name,n=e.interfaces,r=e.directives,o=e.fields;return X(["extend interface",t,ee("implements ",X(n," & ")),X(r," "),Z(o)]," ")},UnionTypeExtension:function(e){var t=e.name,n=e.directives,r=e.types;return X(["extend union",t,X(n," "),r&&0!==r.length?"= "+X(r," | "):""]," ")},EnumTypeExtension:function(e){var t=e.name,n=e.directives,r=e.values;return X(["extend enum",t,X(n," "),Z(r)]," ")},InputObjectTypeExtension:function(e){var t=e.name,n=e.directives,r=e.fields;return X(["extend input",t,X(n," "),Z(r)]," ")}};function $(e){return function(t){return X([t.description,e(t)],"\n")}}function X(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return null!==(t=null==e?void 0:e.filter((function(e){return e})).join(n))&&void 0!==t?t:""}function Z(e){return ee("{\n",te(X(e,"\n")),"\n}")}function ee(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return null!=t&&""!==t?e+t+n:""}function te(e){return ee("  ",e.replace(/\n/g,"\n  "))}function ne(e){return-1!==e.indexOf("\n")}function re(e){return null!=e&&e.some(ne)}var ie=n(59),oe=n(415),se=n(19),ae=n(544),ce=n(35),ue=n(412),le=n(267),fe=n(114),he=n(609),de=n(644),pe=function(){return pe=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},pe.apply(this,arguments)},ve=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},ye=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},be=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t},me=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},ge=new ie.a("GraphQLAPI"),we=function(){function e(e){this._api=null,this.Auth=le.a,this.Cache=fe.a,this.Credentials=oe.a,this._options=e,ge.debug("API Options",this._options)}return e.prototype.getModuleName=function(){return"GraphQLAPI"},e.prototype.configure=function(e){var t=e||{},n=t.API,r=void 0===n?{}:n,o=be(t,["API"]),c=pe(pe({},o),r);return ge.debug("configure GraphQL API",{opt:c}),c.aws_project_region&&(c=Object.assign({},c,{region:c.aws_project_region,header:{}})),void 0!==c.graphql_headers&&"function"!=typeof c.graphql_headers&&(ge.warn("graphql_headers should be a function"),c.graphql_headers=void 0),this._options=Object.assign({},this._options,c),this.createInstance(),this._options},e.prototype.createInstance=function(){return ge.debug("create Rest instance"),this._options?(this._api=new de.a(this._options),this._api.Credentials=this.Credentials,!0):Promise.reject("API not configured")},e.prototype._headerBasedAuth=function(e,t){return void 0===t&&(t={}),ve(this,void 0,void 0,(function(){var n,r,o,c,l,f,h,d;return ye(this,(function(v){switch(v.label){case 0:switch(n=this._options,r=n.aws_appsync_authenticationType,o=n.aws_appsync_apiKey,c={},e||r||"AWS_IAM"){case"API_KEY":return[3,1];case"AWS_IAM":return[3,2];case"OPENID_CONNECT":return[3,4];case"AMAZON_COGNITO_USER_POOLS":return[3,11];case"AWS_LAMBDA":return[3,15]}return[3,16];case 1:if(!o)throw new Error(he.a.NO_API_KEY);return c={Authorization:null,"X-Api-Key":o},[3,17];case 2:return[4,this._ensureCredentials()];case 3:if(!v.sent())throw new Error(he.a.NO_CREDENTIALS);return[3,17];case 4:return v.trys.push([4,9,,10]),l=void 0,[4,fe.a.getItem("federatedInfo")];case 5:return(f=v.sent())?(l=f.token,[3,8]):[3,6];case 6:return[4,le.a.currentAuthenticatedUser()];case 7:(h=v.sent())&&(l=h.token),v.label=8;case 8:if(!l)throw new Error(he.a.NO_FEDERATED_JWT);return c={Authorization:l},[3,10];case 9:throw v.sent(),new Error(he.a.NO_CURRENT_USER);case 10:return[3,17];case 11:return v.trys.push([11,13,,14]),[4,this.Auth.currentSession()];case 12:return d=v.sent(),c={Authorization:d.getAccessToken().getJwtToken()},[3,14];case 13:throw v.sent(),new Error(he.a.NO_CURRENT_USER);case 14:return[3,17];case 15:if(!t.Authorization)throw new Error(he.a.NO_AUTH_TOKEN);return c={Authorization:t.Authorization},[3,17];case 16:return c={Authorization:null},[3,17];case 17:return[2,c]}}))}))},e.prototype.getGraphqlOperationType=function(e){var t=G(e).definitions;return me(t,1)[0].operation},e.prototype.graphql=function(e,t){var n=e.query,r=e.variables,o=void 0===r?{}:r,c=e.authMode,l=e.authToken,f=G("string"==typeof n?n:J(n)),h=me(f.definitions.filter((function(e){return"OperationDefinition"===e.kind})),1)[0],d=(void 0===h?{}:h).operation,v=t||{};switch(l&&(v.Authorization=l),d){case"query":case"mutation":var y=this._api.getCancellableToken(),m={cancellableToken:y},w=this._graphql({query:f,variables:o,authMode:c},v,m);return this._api.updateRequestToBeCancellable(w,y),w;case"subscription":return this._graphqlSubscribe({query:f,variables:o,authMode:c},v);default:throw new Error("invalid operation type: "+d)}},e.prototype._graphql=function(e,t,n){var o=e.query,c=e.variables,l=e.authMode;return void 0===t&&(t={}),void 0===n&&(n={}),ve(this,void 0,void 0,(function(){var e,f,h,d,v,y,m,w,_,E,S,O,T,I,body,A,N,C,x,k,P;return ye(this,(function(M){switch(M.label){case 0:return this._api?[3,2]:[4,this.createInstance()];case 1:M.sent(),M.label=2;case 2:return e=this._options,f=e.aws_appsync_region,h=e.aws_appsync_graphqlEndpoint,d=e.graphql_headers,v=void 0===d?function(){return{}}:d,y=e.graphql_endpoint,m=e.graphql_endpoint_iam_region,_=[{}],(E=!y)?[4,this._headerBasedAuth(l,t)]:[3,4];case 3:E=M.sent(),M.label=4;case 4:return S=[pe.apply(void 0,_.concat([E]))],(O=y)?m?[4,this._headerBasedAuth(l,t)]:[3,6]:[3,8];case 5:return T=M.sent(),[3,7];case 6:T={Authorization:null},M.label=7;case 7:O=T,M.label=8;case 8:return I=[pe.apply(void 0,S.concat([O]))],[4,v({query:o,variables:c})];case 9:if(w=pe.apply(void 0,[pe.apply(void 0,[pe.apply(void 0,I.concat([M.sent()])),t]),!y&&(P={},P["x-amz-user-agent"]=se.a.userAgent,P)]),body={query:J(o),variables:c},A=Object.assign({headers:w,body:body,signerServiceInfo:{service:y?"execute-api":"appsync",region:y?m:f}},n),!(N=y||h))throw{data:{},errors:[new r.a("No graphql endpoint provided.")]};M.label=10;case 10:return M.trys.push([10,12,,13]),[4,this._api.post(N,A)];case 11:return C=M.sent(),[3,13];case 12:if(x=M.sent(),this._api.isCancel(x))throw x;return C={data:{},errors:[new r.a(x.message,null,null,null,null,x)]},[3,13];case 13:if((k=C.errors)&&k.length)throw C;return[2,C]}}))}))},e.prototype.isCancel=function(e){return this._api.isCancel(e)},e.prototype.cancel=function(e,t){return this._api.cancel(e,t)},e.prototype.hasCancelToken=function(e){return this._api.hasCancelToken(e)},e.prototype._graphqlSubscribe=function(e,t){var n=e.query,r=e.variables,o=e.authMode,c=e.authToken;void 0===t&&(t={});var l=this._options,f=l.aws_appsync_region,h=l.aws_appsync_graphqlEndpoint,d=l.aws_appsync_authenticationType,v=l.aws_appsync_apiKey,y=l.graphql_headers,m=void 0===y?function(){return{}}:y,w=o||d||"AWS_IAM";if(ue.b&&"function"==typeof ue.b.subscribe)return ue.b.subscribe("",{provider:ae.b,appSyncGraphqlEndpoint:h,authenticationType:w,apiKey:v,query:J(n),region:f,variables:r,graphql_headers:m,additionalHeaders:t,authToken:c});throw ge.debug("No pubsub module applied for subscription"),new Error("No pubsub module applied for subscription")},e.prototype._ensureCredentials=function(){var e=this;return this.Credentials.get().then((function(t){if(!t)return!1;var n=e.Credentials.shear(t);return ge.debug("set credentials for api",n),!0})).catch((function(e){return ge.warn("ensure credentials error",e),!1}))},e}(),_e=new we(null);ce.a.register(_e)},452:function(e,t,n){"use strict";n.d(t,"b",(function(){return Xn})),n.d(t,"a",(function(){return gr}));var r=n(59),o=n(34),c=n(272),l=n(35);function f(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function h(e){return!!e&&!!e[Z]}function d(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===ee}(e)||Array.isArray(e)||!!e[X]||!!e.constructor[X]||w(e)||_(e))}function i(e,t,n){void 0===n&&(n=!1),0===v(e)?(n?Object.keys:te)(e).forEach((function(r){n&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function v(e){var t=e[Z];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:w(e)?2:_(e)?3:0}function u(e,t){return 2===v(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function a(e,t){return 2===v(e)?e.get(t):e[t]}function y(e,t,n){var r=v(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function m(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function w(e){return J&&e instanceof Map}function _(e){return q&&e instanceof Set}function E(e){return e.o||e.t}function S(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=ne(e);delete t[Z];for(var n=te(t),r=0;r<n.length;r++){var i=n[r],o=t[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function O(e,t){return void 0===t&&(t=!1),I(e)||h(e)||!d(e)||(v(e)>1&&(e.set=e.add=e.clear=e.delete=T),Object.freeze(e),t&&i(e,(function(e,t){return O(t,!0)}),!0)),e}function T(){f(2)}function I(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function b(e){var t=re[e];return t||f(18,e),t}function A(e,t){re[e]||(re[e]=t)}function N(){return Y}function C(e,t){t&&(b("Patches"),e.u=[],e.s=[],e.v=t)}function x(e){g(e),e.p.forEach(P),e.p=null}function g(e){e===Y&&(Y=e.l)}function k(e){return Y={p:[],l:Y,h:e,m:!0,_:0}}function P(e){var t=e[Z];0===t.i||1===t.i?t.j():t.O=!0}function M(e,t){t._=t.p.length;var i=t.p[0],n=void 0!==e&&e!==i;return t.h.g||b("ES5").S(t,e,n),n?(i[Z].P&&(x(t),f(4)),d(e)&&(e=D(t,e),t.l||j(t,e)),t.u&&b("Patches").M(i[Z],e,t.u,t.s)):e=D(t,i,[]),x(t),t.u&&t.v(t.u,t.s),e!==$?e:void 0}function D(e,t,n){if(I(t))return t;var r=t[Z];if(!r)return i(t,(function(i,o){return R(e,r,t,i,o,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return j(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var o=4===r.i||5===r.i?r.o=S(r.k):r.o;i(3===r.i?new Set(o):o,(function(t,i){return R(e,r,o,t,i,n)})),j(e,o,!1),n&&e.u&&b("Patches").R(r,n,e.u,e.s)}return r.o}function R(e,i,t,a,n,s){if(h(n)){var r=D(e,n,s&&i&&3!==i.i&&!u(i.D,a)?s.concat(a):void 0);if(y(t,a,r),!h(r))return;e.m=!1}if(d(n)&&!I(n)){if(!e.h.F&&e._<1)return;D(e,n),i&&i.A.l||j(e,n)}}function j(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&O(t,n)}function L(e,t){var n=e[Z];return(n?E(n):e)[t]}function F(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function U(e){e.P||(e.P=!0,e.l&&U(e.l))}function B(e){e.o||(e.o=S(e.t))}function G(e,t,n){var r=w(t)?b("MapSet").N(t,n):_(t)?b("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:N(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=r,o=ie;n&&(i=[r],o=oe);var u=Proxy.revocable(i,o),a=u.revoke,c=u.proxy;return r.k=c,r.j=a,c}(t,n):b("ES5").J(t,n);return(n?n.A:N()).p.push(r),r}function V(e){return h(e)||f(22,e),function e(t){if(!d(t))return t;var n,u=t[Z],r=v(t);if(u){if(!u.P&&(u.i<4||!b("ES5").K(u)))return u.t;u.I=!0,n=K(t,r),u.I=!1}else n=K(t,r);return i(n,(function(t,r){u&&a(u.t,t)===r||y(n,t,e(r))})),3===r?new Set(n):n}(e)}function K(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return S(e)}function W(){function e(t){if(!d(t))return t;if(Array.isArray(t))return t.map(e);if(w(t))return new Map(Array.from(t.entries()).map((function(t){return[t[0],e(t[1])]})));if(_(t))return new Set(Array.from(t).map(e));var n=Object.create(Object.getPrototypeOf(t));for(var i in t)n[i]=e(t[i]);return u(t,X)&&(n[X]=t[X]),n}function t(t){return h(t)?e(t):t}var n="add";A("Patches",{$:function(t,r){return r.forEach((function(r){for(var i=r.path,u=r.op,o=t,s=0;s<i.length-1;s++){var c=v(o),p=""+i[s];0!==c&&1!==c||"__proto__"!==p&&"constructor"!==p||f(24),"function"==typeof o&&"prototype"===p&&f(24),"object"!=typeof(o=a(o,p))&&f(15,i.join("/"))}var l=v(o),h=e(r.value),d=i[i.length-1];switch(u){case"replace":switch(l){case 2:return o.set(d,h);case 3:f(16);default:return o[d]=h}case n:switch(l){case 1:return o.splice(d,0,h);case 2:return o.set(d,h);case 3:return o.add(h);default:return o[d]=h}case"remove":switch(l){case 1:return o.splice(d,1);case 2:return o.delete(d);case 3:return o.delete(r.value);default:return delete o[d]}default:f(17,u)}})),t},R:function(e,r,o,c){switch(e.i){case 0:case 4:case 2:return function(e,r,o,c){var l=e.t,s=e.o;i(e.D,(function(e,i){var f=a(l,e),p=a(s,e),h=i?u(l,e)?"replace":n:"remove";if(f!==p||"replace"!==h){var d=r.concat(e);o.push("remove"===h?{op:h,path:d}:{op:h,path:d,value:p}),c.push(h===n?{op:"remove",path:d}:"remove"===h?{op:n,path:d,value:t(f)}:{op:"replace",path:d,value:t(f)})}}))}(e,r,o,c);case 5:case 1:return function(e,r,o,c){var i=e.t,l=e.D,u=e.o;if(u.length<i.length){var a=[u,i];i=a[0],u=a[1];var s=[c,o];o=s[0],c=s[1]}for(var f=0;f<i.length;f++)if(l[f]&&u[f]!==i[f]){var p=r.concat([f]);o.push({op:"replace",path:p,value:t(u[f])}),c.push({op:"replace",path:p,value:t(i[f])})}for(var h=i.length;h<u.length;h++){var d=r.concat([h]);o.push({op:n,path:d,value:t(u[h])})}i.length<u.length&&c.push({op:"replace",path:r.concat(["length"]),value:i.length})}(e,r,o,c);case 3:return function(e,t,r,o){var i=e.t,c=e.o,u=0;i.forEach((function(e){if(!c.has(e)){var i=t.concat([u]);r.push({op:"remove",path:i,value:e}),o.unshift({op:n,path:i,value:e})}u++})),u=0,c.forEach((function(e){if(!i.has(e)){var c=t.concat([u]);r.push({op:n,path:c,value:e}),o.unshift({op:"remove",path:c,value:e})}u++}))}(e,r,o,c)}},M:function(e,t,n,r){n.push({op:"replace",path:[],value:t===$?void 0:t}),r.push({op:"replace",path:[],value:e.t})}})}var z,Y,H="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),J="undefined"!=typeof Map,q="undefined"!=typeof Set,Q="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,$=H?Symbol.for("immer-nothing"):((z={})["immer-nothing"]=!0,z),X=H?Symbol.for("immer-draftable"):"__$immer_draftable",Z=H?Symbol.for("immer-state"):"__$immer_state",ee=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),te="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,ne=Object.getOwnPropertyDescriptors||function(e){var t={};return te(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},re={},ie={get:function(e,t){if(t===Z)return e;var n=E(e);if(!u(n,t))return function(e,t,n){var r,i=F(t,n);return i?"value"in i?i.value:null===(r=i.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var i=n[t];return e.I||!d(i)?i:i===L(e.t,t)?(B(e),e.o[t]=G(e.A.h,i,e)):i},has:function(e,t){return t in E(e)},ownKeys:function(e){return Reflect.ownKeys(E(e))},set:function(e,t,n){var r=F(E(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var i=L(E(e),t),o=null==i?void 0:i[Z];if(o&&o.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(m(n,i)&&(void 0!==n||u(e.t,t)))return!0;B(e),U(e)}return e.o[t]===n&&"number"!=typeof n&&(void 0!==n||t in e.o)||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==L(e.t,t)||t in e.t?(e.D[t]=!1,B(e),U(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=E(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){f(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){f(12)}},oe={};i(ie,(function(e,t){oe[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),oe.deleteProperty=function(e,t){return ie.deleteProperty.call(this,e[0],t)},oe.set=function(e,t,n){return ie.set.call(this,e[0],t,n,e[0])};var se=function(){function e(e){var t=this;this.g=Q,this.F=!0,this.produce=function(e,i,n){if("function"==typeof e&&"function"!=typeof i){var u=i;i=e;var a=t;return function(e){var t=this;void 0===e&&(e=u);for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return a.produce(e,(function(e){var n;return(n=i).call.apply(n,[t,e].concat(r))}))}}var r;if("function"!=typeof i&&f(6),void 0!==n&&"function"!=typeof n&&f(7),d(e)){var o=k(t),s=G(t,e,void 0),c=!0;try{r=i(s),c=!1}finally{c?x(o):g(o)}return"undefined"!=typeof Promise&&r instanceof Promise?r.then((function(e){return C(o,n),M(e,o)}),(function(e){throw x(o),e})):(C(o,n),M(r,o))}if(!e||"object"!=typeof e){if((r=i(e))===$)return;return void 0===r&&(r=e),t.F&&O(r,!0),r}f(21,e)},this.produceWithPatches=function(e,n){return"function"==typeof e?function(n){for(var r=arguments.length,i=Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(i))}))}:[t.produce(e,n,(function(e,t){r=e,i=t})),r,i];var r,i},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var i=e.prototype;return i.createDraft=function(e){d(e)||f(8),h(e)&&(e=V(e));var i=k(this),t=G(this,e,void 0);return t[Z].C=!0,g(i),t},i.finishDraft=function(e,t){var i=(e&&e[Z]).A;return C(i,t),M(void 0,i)},i.setAutoFreeze=function(e){this.F=e},i.setUseProxies=function(e){e&&!Q&&f(20),this.g=e},i.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var i=t[n];if(0===i.path.length&&"replace"===i.op){e=i.value;break}}var r=b("Patches").$;return h(e)?r(e,t):this.produce(e,(function(e){return r(e,t.slice(n+1))}))},e}(),ae=new se,ce=ae.produce,ue=(ae.produceWithPatches.bind(ae),ae.setAutoFreeze.bind(ae)),le=(ae.setUseProxies.bind(ae),ae.applyPatches.bind(ae),ae.createDraft.bind(ae),ae.finishDraft.bind(ae),n(605)),fe=n(488),he=n(267),de=n(6),pe=n(187),ve=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},ye=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},be=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},me=function(){for(var e=[],i=0;i<arguments.length;i++)e=e.concat(be(arguments[i]));return e};function ge(e){return"private"!==e.allow||e.provider?"public"!==e.allow||e.provider?e.provider:pe.f.API_KEY:pe.f.USER_POOLS}function we(e){var t=e.rules,n=e.currentUser,r=new Set;return t.forEach((function(e){switch(e.allow){case pe.e.CUSTOM:e.provider&&e.provider!==pe.f.FUNCTION||r.add(de.c.AWS_LAMBDA);break;case pe.e.GROUPS:case pe.e.OWNER:n&&(e.provider===pe.f.USER_POOLS?r.add(de.c.AMAZON_COGNITO_USER_POOLS):e.provider===pe.f.OIDC&&r.add(de.c.OPENID_CONNECT));break;case pe.e.PRIVATE:n&&(e.provider&&e.provider!==pe.f.USER_POOLS?e.provider===pe.f.IAM&&r.add(de.c.AWS_IAM):r.add(de.c.AMAZON_COGNITO_USER_POOLS));break;case pe.e.PUBLIC:e.provider===pe.f.IAM?r.add(de.c.AWS_IAM):e.provider&&e.provider!==pe.f.API_KEY||r.add(de.c.API_KEY)}})),Array.from(r)}var _e=function(e){var t=e.schema,n=e.modelName;return ve(void 0,void 0,void 0,(function(){var e,r,o,c;return ye(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,he.a.currentAuthenticatedUser()];case 1:return e=l.sent(),[3,3];case 2:return l.sent(),[3,3];case 3:return(r=t.namespaces.user.models[n].attributes)&&(o=r.find((function(e){return"auth"===e.type}))).properties&&o.properties.rules?(f=o.properties.rules,h=[pe.e.CUSTOM,pe.e.OWNER,pe.e.GROUPS,pe.e.PRIVATE,pe.e.PUBLIC],d=[pe.f.FUNCTION,pe.f.USER_POOLS,pe.f.OIDC,pe.f.IAM,pe.f.API_KEY],c=me(f).sort((function(a,b){return a.allow===b.allow?d.indexOf(ge(a))-d.indexOf(ge(b)):h.indexOf(a.allow)-h.indexOf(b.allow)})),[2,we({currentUser:e,rules:c})]):[2,[]]}var f,h,d}))}))},Ee=function(){return[]},Se=n(410),Oe=n(608),Te=function(){function e(){this._queue=[],this._pending=!1}return e.prototype.isLocked=function(){return this._pending},e.prototype.acquire=function(){var e=this,t=new Promise((function(t){return e._queue.push(t)}));return this._pending||this._dispatchNext(),t},e.prototype.runExclusive=function(e){return this.acquire().then((function(t){var n;try{n=e()}catch(e){throw t(),e}return Promise.resolve(n).then((function(e){return t(),e}),(function(e){throw t(),e}))}))},e.prototype._dispatchNext=function(){this._queue.length>0?(this._pending=!0,this._queue.shift()(this._dispatchNext.bind(this))):this._pending=!1},e}(),Ie=Te,Ae=n(641),Ne=n.n(Ae),Ce=n(484);let xe,ke;const Pe=new WeakMap,Me=new WeakMap,De=new WeakMap,Re=new WeakMap,je=new WeakMap;let Le={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Me.get(e);if("objectStoreNames"===t)return e.objectStoreNames||De.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return qe(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Fe(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(ke||(ke=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(Be(this),t),qe(Pe.get(this))}:function(...t){return qe(e.apply(Be(this),t))}:function(t,...n){const r=e.call(Be(this),t,...n);return De.set(r,t.sort?t.sort():[t]),qe(r)}}function Ue(e){return"function"==typeof e?Fe(e):(e instanceof IDBTransaction&&function(e){if(Me.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",c),e.removeEventListener("abort",c)},o=()=>{t(),r()},c=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",o),e.addEventListener("error",c),e.addEventListener("abort",c)}));Me.set(e,t)}(e),object=e,(xe||(xe=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>object instanceof e))?new Proxy(e,Le):e);var object}function qe(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",o),e.removeEventListener("error",c)},o=()=>{t(qe(e.result)),r()},c=()=>{n(e.error),r()};e.addEventListener("success",o),e.addEventListener("error",c)}));return t.then((t=>{t instanceof IDBCursor&&Pe.set(t,e)})).catch((()=>{})),je.set(t,e),t}(e);if(Re.has(e))return Re.get(e);const t=Ue(e);return t!==e&&(Re.set(e,t),je.set(t,e)),t}const Be=e=>je.get(e);function Ge(e,t,{blocked:n,upgrade:r,blocking:o,terminated:c}={}){const l=indexedDB.open(e,t),f=qe(l);return r&&l.addEventListener("upgradeneeded",(e=>{r(qe(l.result),e.oldVersion,e.newVersion,qe(l.transaction))})),n&&l.addEventListener("blocked",(()=>n())),f.then((e=>{c&&e.addEventListener("close",(()=>c())),o&&e.addEventListener("versionchange",(()=>o()))})).catch((()=>{})),f}function Ve(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(()=>t())),qe(n).then((()=>{}))}const Ke=["get","getKey","getAll","getAllKeys","count"],We=["put","add","delete","clear"],ze=new Map;function Ye(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(ze.get(t))return ze.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,o=We.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!o&&!Ke.includes(n))return;const c=async function(e,...t){const c=this.transaction(e,o?"readwrite":"readonly");let l=c.store;r&&(l=l.index(t.shift()));const f=await l[n](...t);return o&&await c.done,f};return ze.set(t,c),c}Le=(e=>({...e,get:(t,n,r)=>Ye(t,n)||e.get(t,n,r),has:(t,n)=>!!Ye(t,n)||e.has(t,n)}))(Le);var He=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},Je=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},Qe=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,t=e[Symbol.asyncIterator];return t?t.call(e):(e="function"==typeof $e?$e(e):e[Symbol.iterator](),i={},n("next"),n("throw"),n("return"),i[Symbol.asyncIterator]=function(){return this},i);function n(t){i[t]=e[t]&&function(n){return new Promise((function(r,o){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,o,(n=e[t](n)).done,n.value)}))}}},$e=function(e){var s="function"==typeof Symbol&&Symbol.iterator,t=s&&e[s],i=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},Xe=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},Ze=function(){for(var e=[],i=0;i<arguments.length;i++)e=e.concat(Xe(arguments[i]));return e},et=new r.a("DataStore"),tt="amplify-datastore",nt=new(function(){function e(){this.dbName=tt}return e.prototype.checkPrivate=function(){return He(this,void 0,void 0,(function(){return Je(this,(function(e){switch(e.label){case 0:return[4,Object(Ce.v)().then((function(e){return e}))];case 1:return e.sent()?(et.error("IndexedDB not supported in this browser's private mode"),[2,Promise.reject("IndexedDB not supported in this browser's private mode")]):[2,Promise.resolve()]}}))}))},e.prototype.getStorenameForModel=function(e){var t=this.namespaceResolver(e),n=e.name;return this.getStorename(t,n)},e.prototype.getStorename=function(e,t){return e+"_"+t},e.prototype.setUp=function(e,t,n,r,o){return He(this,void 0,void 0,(function(){var c,l,f=this;return Je(this,(function(h){switch(h.label){case 0:return[4,this.checkPrivate()];case 1:return h.sent(),this.initPromise?[3,2]:(this.initPromise=new Promise((function(e,t){f.resolve=e,f.reject=t})),[3,4]);case 2:return[4,this.initPromise];case 3:h.sent(),h.label=4;case 4:o&&(this.dbName=tt+"-"+o),this.schema=e,this.namespaceResolver=t,this.modelInstanceCreator=n,this.getModelConstructorByModelName=r,h.label=5;case 5:return h.trys.push([5,8,,9]),this.db?[3,7]:(2,c=this,[4,Ge(this.dbName,2,{upgrade:function(t,n,r,o){return He(f,void 0,void 0,(function(){var c,l,f,h,d,v,cursor,y,m,w,_,E,S=this;return Je(this,(function(O){switch(O.label){case 0:if(0===n)return Object.keys(e.namespaces).forEach((function(n){var r=e.namespaces[n];Object.keys(r.models).forEach((function(e){var r=S.getStorename(n,e);S.createObjectStoreForModel(t,n,r,e)}))})),[2];if(1!==n||2!==r)return[3,16];O.label=1;case 1:O.trys.push([1,14,,15]),O.label=2;case 2:O.trys.push([2,11,12,13]),c=$e(o.objectStoreNames),l=c.next(),O.label=3;case 3:return l.done?[3,10]:(f=l.value,h=o.objectStore(f),d="tmp_"+f,h.name=d,(v=t.createObjectStore(f,{keyPath:void 0,autoIncrement:!0})).createIndex("byId","id",{unique:!0}),[4,h.openCursor()]);case 4:cursor=O.sent(),y=0,O.label=5;case 5:return cursor&&cursor.value?[4,v.put(cursor.value)]:[3,8];case 6:return O.sent(),[4,cursor.continue()];case 7:return cursor=O.sent(),y++,[3,5];case 8:t.deleteObjectStore(d),et.debug(y+" "+f+" records migrated"),O.label=9;case 9:return l=c.next(),[3,3];case 10:return[3,13];case 11:return m=O.sent(),_={error:m},[3,13];case 12:try{l&&!l.done&&(E=c.return)&&E.call(c)}finally{if(_)throw _.error}return[7];case 13:return Object.keys(e.namespaces).forEach((function(n){var r=e.namespaces[n],c=new Set(o.objectStoreNames);Object.keys(r.models).map((function(e){return[e,S.getStorename(n,e)]})).filter((function(e){var t=Xe(e,2)[1];return!c.has(t)})).forEach((function(e){var r=Xe(e,2),o=r[0],c=r[1];S.createObjectStoreForModel(t,n,c,o)}))})),[3,15];case 14:throw w=O.sent(),et.error("Error migrating IndexedDB data",w),o.abort(),w;case 15:case 16:return[2]}}))}))}})]);case 6:c.db=h.sent(),this.resolve(),h.label=7;case 7:return[3,9];case 8:return l=h.sent(),this.reject(l),[3,9];case 9:return[2]}}))}))},e.prototype._get=function(e,t){return He(this,void 0,void 0,(function(){var n,r;return Je(this,(function(o){switch(o.label){case 0:return"string"==typeof e?(r=e,n=this.db.transaction(r,"readonly").store.index("byId")):n=e.index("byId"),[4,n.get(t)];case 1:return[2,o.sent()]}}))}))},e.prototype.save=function(e,t){var n,r;return He(this,void 0,void 0,(function(){var o,c,l,f,h,d,v,y,m,w,_,E,S,O,T,I,A,N,C,x,k,P,M,D,R,j,L=this;return Je(this,(function(F){switch(F.label){case 0:return[4,this.checkPrivate()];case 1:return F.sent(),o=Object.getPrototypeOf(e).constructor,c=this.getStorenameForModel(o),l=Object(Ce.z)(o.name,e,this.schema.namespaces[this.namespaceResolver(o)],this.modelInstanceCreator,this.getModelConstructorByModelName),f=this.namespaceResolver(o),h=new Set,d=Object.values(l).map((function(e){var t=e.modelName,n=e.item,r=e.instance,o=L.getStorename(f,t);return h.add(o),{storeName:o,item:n,instance:r}})),v=this.db.transaction(Ze([c],Array.from(h.values())),"readwrite"),y=v.objectStore(c),[4,this._get(y,e.id)];case 2:if(m=F.sent(),t&&m&&(w=Se.a.getPredicates(t),_=w.predicates,E=w.type,!Object(Ce.A)(m,E,_)))throw S="Conditional update failed",et.error(S,{model:m,condition:_}),new Error(S);O=[],F.label=3;case 3:F.trys.push([3,11,12,17]),T=Qe(d),F.label=4;case 4:return[4,T.next()];case 5:return(I=F.sent()).done?[3,10]:(A=I.value,N=A.storeName,C=A.item,x=A.instance,k=v.objectStore(N),P=C.id,[4,this._get(k,P)]);case 6:return M=F.sent(),D=void 0===M?pe.h.INSERT:pe.h.UPDATE,P!==e.id&&D!==pe.h.INSERT?[3,9]:[4,k.index("byId").getKey(C.id)];case 7:return R=F.sent(),[4,k.put(C,R)];case 8:F.sent(),O.push([x,D]),F.label=9;case 9:return[3,4];case 10:return[3,17];case 11:return j=F.sent(),n={error:j},[3,17];case 12:return F.trys.push([12,,15,16]),I&&!I.done&&(r=T.return)?[4,r.call(T)]:[3,14];case 13:F.sent(),F.label=14;case 14:return[3,16];case 15:if(n)throw n.error;return[7];case 16:return[7];case 17:return[4,v.done];case 18:return F.sent(),[2,O]}}))}))},e.prototype.load=function(e,t,n){var r,o,c,l,f,h,d,v,y,m;return He(this,void 0,void 0,(function(){var w,_,E,S,O,T,I,A,N,C,x,k,P,M,D,R,j,L,F,U,B=this;return Je(this,(function(G){switch(G.label){case 0:if(w=this.schema.namespaces[e],_=w.relationships[t].relationTypes,E=_.map((function(t){var n=t.modelName;return B.getStorename(e,n)})),S=this.getModelConstructorByModelName(e,t),0===E.length)return[2,n.map((function(e){return B.modelInstanceCreator(S,e)}))];O=this.db.transaction(Ze(E),"readonly"),G.label=1;case 1:G.trys.push([1,34,35,40]),T=Qe(_),G.label=2;case 2:return[4,T.next()];case 3:if((I=G.sent()).done)return[3,33];switch(A=I.value,N=A.fieldName,C=A.modelName,x=A.targetName,k=this.getStorename(e,C),P=O.objectStore(k),M=this.getModelConstructorByModelName(e,C),A.relationType){case"HAS_ONE":return[3,4];case"BELONGS_TO":return[3,17];case"HAS_MANY":return[3,30]}return[3,31];case 4:G.trys.push([4,10,11,16]),r=Qe(n),G.label=5;case 5:return[4,r.next()];case 6:return(o=G.sent()).done?[3,9]:(j=o.value,D=j[x]?x:N,j[D]?[4,this._get(P,j[D])]:[3,9]);case 7:L=G.sent(),j[N]=L&&this.modelInstanceCreator(M,L),G.label=8;case 8:return[3,5];case 9:return[3,16];case 10:return R=G.sent(),d={error:R},[3,16];case 11:return G.trys.push([11,,14,15]),o&&!o.done&&(v=r.return)?[4,v.call(r)]:[3,13];case 12:G.sent(),G.label=13;case 13:return[3,15];case 14:if(d)throw d.error;return[7];case 15:return[7];case 16:return[3,32];case 17:G.trys.push([17,23,24,29]),c=Qe(n),G.label=18;case 18:return[4,c.next()];case 19:return(l=G.sent()).done?[3,22]:(j=l.value)[x]?[4,this._get(P,j[x])]:[3,21];case 20:L=G.sent(),j[N]=L&&this.modelInstanceCreator(M,L),delete j[x],G.label=21;case 21:return[3,18];case 22:return[3,29];case 23:return F=G.sent(),y={error:F},[3,29];case 24:return G.trys.push([24,,27,28]),l&&!l.done&&(m=c.return)?[4,m.call(c)]:[3,26];case 25:G.sent(),G.label=26;case 26:return[3,28];case 27:if(y)throw y.error;return[7];case 28:return[7];case 29:case 30:return[3,32];case 31:return Object(Ce.g)(A.relationType),[3,32];case 32:return[3,2];case 33:return[3,40];case 34:return U=G.sent(),f={error:U},[3,40];case 35:return G.trys.push([35,,38,39]),I&&!I.done&&(h=T.return)?[4,h.call(T)]:[3,37];case 36:G.sent(),G.label=37;case 37:return[3,39];case 38:if(f)throw f.error;return[7];case 39:return[7];case 40:return[2,n.map((function(e){return B.modelInstanceCreator(S,e)}))]}}))}))},e.prototype.query=function(e,t,n){return He(this,void 0,void 0,(function(){var r,o,c,l,f,h,d,v=this;return Je(this,(function(y){switch(y.label){case 0:return[4,this.checkPrivate()];case 1:return y.sent(),r=this.getStorenameForModel(e),o=this.namespaceResolver(e),c=t&&Se.a.getPredicates(t),l=c&&this.idFromPredicate(c),f=n&&n.sort,h=n&&n.limit,[4,He(v,void 0,void 0,(function(){var e,t,o;return Je(this,(function(d){switch(d.label){case 0:return l?[4,this.getById(r,l)]:[3,2];case 1:return[2,(e=d.sent())?[e]:[]];case 2:return c?[4,this.filterOnPredicate(r,c)]:[3,4];case 3:return t=d.sent(),[2,this.inMemoryPagination(t,n)];case 4:return f?[4,this.getAll(r)]:[3,6];case 5:return o=d.sent(),[2,this.inMemoryPagination(o,n)];case 6:return h?[2,this.enginePagination(r,n)]:[2,this.getAll(r)]}}))}))];case 2:return d=y.sent(),[4,this.load(o,e.name,d)];case 3:return[2,y.sent()]}}))}))},e.prototype.getById=function(e,t){return He(this,void 0,void 0,(function(){return Je(this,(function(n){switch(n.label){case 0:return[4,this._get(e,t)];case 1:return[2,n.sent()]}}))}))},e.prototype.getAll=function(e){return He(this,void 0,void 0,(function(){return Je(this,(function(t){switch(t.label){case 0:return[4,this.db.getAll(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.idFromPredicate=function(e){var t=e.predicates,n=1===t.length&&t.find((function(p){return Object(pe.t)(p)&&"id"===p.field&&"eq"===p.operator}));return n&&n.operand},e.prototype.filterOnPredicate=function(e,t){return He(this,void 0,void 0,(function(){var n,r,o;return Je(this,(function(c){switch(c.label){case 0:return n=t.predicates,r=t.type,[4,this.getAll(e)];case 1:return o=c.sent(),[2,n?o.filter((function(e){return Object(Ce.A)(e,r,n)})):o]}}))}))},e.prototype.inMemoryPagination=function(e,t){if(t&&e.length>1){if(t.sort){var n=Oe.a.getPredicates(t.sort);if(n.length){var r=Object(Ce.y)(n);e.sort(r)}}var o=t.page,c=void 0===o?0:o,l=t.limit,f=void 0===l?0:l,h=Math.max(0,c*f)||0,d=f>0?h+f:e.length;return e.slice(h,d)}return e},e.prototype.enginePagination=function(e,t){return He(this,void 0,void 0,(function(){var n,r,o,c,l,f,cursor,h,d;return Je(this,(function(v){switch(v.label){case 0:return t?(r=t.page,o=void 0===r?0:r,c=t.limit,l=void 0===c?0:c,f=Math.max(0,o*l)||0,[4,this.db.transaction(e).objectStore(e).openCursor()]):[3,7];case 1:return(cursor=v.sent())&&f>0?[4,cursor.advance(f)]:[3,3];case 2:v.sent(),v.label=3;case 3:h=[],d="number"==typeof l&&l>0,v.label=4;case 4:return cursor&&cursor.value?(h.push(cursor.value),d&&h.length===l?[3,6]:[4,cursor.continue()]):[3,6];case 5:return cursor=v.sent(),[3,4];case 6:return n=h,[3,9];case 7:return[4,this.db.getAll(e)];case 8:n=v.sent(),v.label=9;case 9:return[2,n]}}))}))},e.prototype.queryOne=function(e,t){return void 0===t&&(t=pe.j.FIRST),He(this,void 0,void 0,(function(){var n,cursor,r;return Je(this,(function(o){switch(o.label){case 0:return[4,this.checkPrivate()];case 1:return o.sent(),n=this.getStorenameForModel(e),[4,this.db.transaction([n],"readonly").objectStore(n).openCursor(void 0,t===pe.j.FIRST?"next":"prev")];case 2:return cursor=o.sent(),[2,(r=cursor?cursor.value:void 0)&&this.modelInstanceCreator(e,r)]}}))}))},e.prototype.delete=function(e,t){return He(this,void 0,void 0,(function(){var n,r,o,c,l,f,h,d,v,y,m,w,_,E,S;return Je(this,(function(O){switch(O.label){case 0:return[4,this.checkPrivate()];case 1:return O.sent(),n=[],Object(Ce.t)(e)?(c=e,l=this.namespaceResolver(c),f=this.getStorenameForModel(c),[4,this.query(c,t)]):[3,9];case 2:return r=O.sent(),E=this.schema.namespaces[l].relationships[c.name].relationTypes,void 0===t?[3,5]:[4,this.deleteTraverse(E,r,c.name,l,n)];case 3:return O.sent(),[4,this.deleteItem(n)];case 4:return O.sent(),S=n.reduce((function(e,t){var n=t.items;return e.concat(n)}),[]),[2,[r,S]];case 5:return[4,this.deleteTraverse(E,r,c.name,l,n)];case 6:return O.sent(),[4,this.db.transaction([f],"readwrite").objectStore(f).clear()];case 7:return O.sent(),S=n.reduce((function(e,t){var n=t.items;return e.concat(n)}),[]),[2,[r,S]];case 8:return[3,17];case 9:return o=e,c=Object.getPrototypeOf(o).constructor,l=this.namespaceResolver(c),f=this.getStorenameForModel(c),t?(h=this.db.transaction([f],"readwrite"),d=h.objectStore(f),[4,this._get(d,o.id)]):[3,13];case 10:if(void 0===(v=O.sent()))return _="Model instance not found in storage",et.warn(_,{model:o}),[2,[[o],[]]];if(y=Se.a.getPredicates(t),m=y.predicates,w=y.type,!Object(Ce.A)(v,w,m))throw _="Conditional update failed",et.error(_,{model:v,condition:m}),new Error(_);return[4,h.done];case 11:return O.sent(),E=this.schema.namespaces[l].relationships[c.name].relationTypes,[4,this.deleteTraverse(E,[o],c.name,l,n)];case 12:return O.sent(),[3,15];case 13:return E=this.schema.namespaces[l].relationships[c.name].relationTypes,[4,this.deleteTraverse(E,[o],c.name,l,n)];case 14:O.sent(),O.label=15;case 15:return[4,this.deleteItem(n)];case 16:return O.sent(),S=n.reduce((function(e,t){var n=t.items;return e.concat(n)}),[]),[2,[[o],S]];case 17:return[2]}}))}))},e.prototype.deleteItem=function(e){var t,n,r,o,c,l;return He(this,void 0,void 0,(function(){var f,h,d,v,y,m,w,_,E,S,O,T;return Je(this,(function(I){switch(I.label){case 0:f=e.map((function(e){return e.storeName})),h=this.db.transaction(Ze(f),"readwrite"),I.label=1;case 1:I.trys.push([1,22,23,28]),t=Qe(e),I.label=2;case 2:return[4,t.next()];case 3:if((n=I.sent()).done)return[3,21];d=n.value,v=d.storeName,y=d.items,m=h.objectStore(v),I.label=4;case 4:I.trys.push([4,14,15,20]),w=Qe(y),I.label=5;case 5:return[4,w.next()];case 6:return(_=I.sent()).done?[3,13]:(E=_.value)?(S=void 0,"object"!=typeof E?[3,8]:[4,m.index("byId").getKey(E.id)]):[3,12];case 7:return S=I.sent(),[3,10];case 8:return[4,m.index("byId").getKey(E.toString())];case 9:S=I.sent(),I.label=10;case 10:return void 0===S?[3,12]:[4,m.delete(S)];case 11:I.sent(),I.label=12;case 12:return[3,5];case 13:return[3,20];case 14:return O=I.sent(),c={error:O},[3,20];case 15:return I.trys.push([15,,18,19]),_&&!_.done&&(l=w.return)?[4,l.call(w)]:[3,17];case 16:I.sent(),I.label=17;case 17:return[3,19];case 18:if(c)throw c.error;return[7];case 19:return[7];case 20:return[3,2];case 21:return[3,28];case 22:return T=I.sent(),r={error:T},[3,28];case 23:return I.trys.push([23,,26,27]),n&&!n.done&&(o=t.return)?[4,o.call(t)]:[3,25];case 24:I.sent(),I.label=25;case 25:return[3,27];case 26:if(r)throw r.error;return[7];case 27:return[7];case 28:return[2]}}))}))},e.prototype.deleteTraverse=function(e,t,n,r,o){var c,l,f,h,d,v,y,m,w,_,E,S;return He(this,void 0,void 0,(function(){var O,T,I,A,N,C,x,k,P,M,D,R,j,L,F=this;return Je(this,(function(U){switch(U.label){case 0:U.trys.push([0,35,36,41]),c=Qe(e),U.label=1;case 1:return[4,c.next()];case 2:if((l=U.sent()).done)return[3,34];switch(O=l.value,T=O.relationType,O.fieldName,I=O.modelName,A=O.targetName,N=this.getStorename(r,I),C=Object(Ce.h)(this.schema.namespaces[r].relationships[I].relationTypes,n)||Object(Ce.i)(this.schema.namespaces[r].relationships[I].indexes,O.associatedWith),T){case"HAS_ONE":return[3,3];case"HAS_MANY":return[3,17];case"BELONGS_TO":return[3,31]}return[3,32];case 3:U.trys.push([3,10,11,16]),f=Qe(t),U.label=4;case 4:return[4,f.next()];case 5:return(h=U.sent()).done?[3,9]:(D=h.value,x=C||"byId",(k=A in D?D[A]:D.id)?[4,this.db.transaction(N,"readwrite").objectStore(N).index(x).get(k)]:[3,9]);case 6:return P=U.sent(),[4,this.deleteTraverse(this.schema.namespaces[r].relationships[I].relationTypes,P?[P]:[],I,r,o)];case 7:U.sent(),U.label=8;case 8:return[3,4];case 9:return[3,16];case 10:return M=U.sent(),w={error:M},[3,16];case 11:return U.trys.push([11,,14,15]),h&&!h.done&&(_=f.return)?[4,_.call(f)]:[3,13];case 12:U.sent(),U.label=13;case 13:return[3,15];case 14:if(w)throw w.error;return[7];case 15:return[7];case 16:return[3,33];case 17:U.trys.push([17,24,25,30]),d=Qe(t),U.label=18;case 18:return[4,d.next()];case 19:return(v=U.sent()).done?[3,23]:(D=v.value,[4,this.db.transaction(N,"readwrite").objectStore(N).index(C).getAll(D.id)]);case 20:return R=U.sent(),[4,this.deleteTraverse(this.schema.namespaces[r].relationships[I].relationTypes,R,I,r,o)];case 21:U.sent(),U.label=22;case 22:return[3,18];case 23:return[3,30];case 24:return j=U.sent(),E={error:j},[3,30];case 25:return U.trys.push([25,,28,29]),v&&!v.done&&(S=d.return)?[4,S.call(d)]:[3,27];case 26:U.sent(),U.label=27;case 27:return[3,29];case 28:if(E)throw E.error;return[7];case 29:return[7];case 30:case 31:return[3,33];case 32:return Object(Ce.g)(T),[3,33];case 33:return[3,1];case 34:return[3,41];case 35:return L=U.sent(),y={error:L},[3,41];case 36:return U.trys.push([36,,39,40]),l&&!l.done&&(m=c.return)?[4,m.call(c)]:[3,38];case 37:U.sent(),U.label=38;case 38:return[3,40];case 39:if(y)throw y.error;return[7];case 40:return[7];case 41:return o.push({storeName:this.getStorename(r,n),items:t.map((function(e){return F.modelInstanceCreator(F.getModelConstructorByModelName(r,n),e)}))}),[2]}}))}))},e.prototype.clear=function(){return He(this,void 0,void 0,(function(){return Je(this,(function(e){switch(e.label){case 0:return[4,this.checkPrivate()];case 1:return e.sent(),this.db.close(),[4,Ve(this.dbName)];case 2:return e.sent(),this.db=void 0,this.initPromise=void 0,[2]}}))}))},e.prototype.batchSave=function(e,t){return He(this,void 0,void 0,(function(){var n,r,o,c,l,f,h,d,v,y,m,w;return Je(this,(function(_){switch(_.label){case 0:return 0===t.length?[2,[]]:[4,this.checkPrivate()];case 1:_.sent(),n=[],r=this.getStorenameForModel(e),o=this.db.transaction(r,"readwrite"),c=o.store,l=function(t){var r,o,l,h,d;return Je(this,(function(v){switch(v.label){case 0:return r=Object(Ce.z)(e.name,f.modelInstanceCreator(e,t),f.schema.namespaces[f.namespaceResolver(e)],f.modelInstanceCreator,f.getModelConstructorByModelName),o=t.id,l=t._deleted,[4,c.index("byId").getKey(o)];case 1:return h=v.sent(),l?[3,3]:(d=r.find((function(e){return e.instance.id===o})).instance,n.push([d,h?pe.h.UPDATE:pe.h.INSERT]),[4,c.put(d,h)]);case 2:return v.sent(),[3,5];case 3:return n.push([t,pe.h.DELETE]),h?[4,c.delete(h)]:[3,5];case 4:v.sent(),v.label=5;case 5:return[2]}}))},f=this,_.label=2;case 2:_.trys.push([2,7,8,9]),h=$e(t),d=h.next(),_.label=3;case 3:return d.done?[3,6]:(v=d.value,[5,l(v)]);case 4:_.sent(),_.label=5;case 5:return d=h.next(),[3,3];case 6:return[3,9];case 7:return y=_.sent(),m={error:y},[3,9];case 8:try{d&&!d.done&&(w=h.return)&&w.call(h)}finally{if(m)throw m.error}return[7];case 9:return[4,o.done];case 10:return _.sent(),[2,n]}}))}))},e.prototype.createObjectStoreForModel=function(e,t,n,r){return He(this,void 0,void 0,(function(){var o;return Je(this,(function(c){return o=e.createObjectStore(n,{autoIncrement:!0}),this.schema.namespaces[t].relationships[r].indexes.forEach((function(e){return o.createIndex(e,e)})),o.createIndex("byId","id",{unique:!0}),[2]}))}))},e}()),it=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},ot=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},st=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},at=function(){var e=this;this.db=new Map,this.getAllKeys=function(){return it(e,void 0,void 0,(function(){return ot(this,(function(e){return[2,Array.from(this.db.keys())]}))}))},this.multiGet=function(t){return it(e,void 0,void 0,(function(){var e=this;return ot(this,(function(n){return[2,t.reduce((function(t,n){return t.push([n,e.db.get(n)]),t}),[])]}))}))},this.multiRemove=function(t,n){return it(e,void 0,void 0,(function(){var e=this;return ot(this,(function(r){return t.forEach((function(t){return e.db.delete(t)})),"function"==typeof n&&n(),[2]}))}))},this.multiSet=function(t,n){return it(e,void 0,void 0,(function(){var e=this;return ot(this,(function(r){return t.forEach((function(t){var n=st(t,2),r=n[0],o=n[1];e.setItem(r,o)})),"function"==typeof n&&n(),[2]}))}))},this.setItem=function(t,n){return it(e,void 0,void 0,(function(){return ot(this,(function(e){return[2,this.db.set(t,n)]}))}))},this.removeItem=function(t){return it(e,void 0,void 0,(function(){return ot(this,(function(e){return[2,this.db.delete(t)]}))}))},this.getItem=function(t){return it(e,void 0,void 0,(function(){return ot(this,(function(e){return[2,this.db.get(t)]}))}))}};var ct,ut=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},lt=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},ft=function(e){var s="function"==typeof Symbol&&Symbol.iterator,t=s&&e[s],i=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},ht=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},pt="@AmplifyDatastore",vt="Data",yt=new Map,bt=function(){function e(){this._collectionInMemoryIndex=new Map,this.storage=new at}return e.prototype.getCollectionIndex=function(e){return this._collectionInMemoryIndex.has(e)||this._collectionInMemoryIndex.set(e,new Map),this._collectionInMemoryIndex.get(e)},e.prototype.getMonotonicFactory=function(e){return yt.has(e)||yt.set(e,Object(Ce.w)()),yt.get(e)},e.prototype.init=function(){return ut(this,void 0,void 0,(function(){var e,t,n,r,o,c,l,f,h,d,v,y,m,w,_,E,S,O,T,I;return lt(this,(function(A){switch(A.label){case 0:return this._collectionInMemoryIndex.clear(),[4,this.storage.getAllKeys()];case 1:e=A.sent(),t=[],A.label=2;case 2:A.trys.push([2,12,13,14]),n=ft(e),r=n.next(),A.label=3;case 3:return r.done?[3,11]:(o=r.value,c=ht(o.split("::"),5),l=c[0],f=c[1],h=c[2],d=c[3],v=c[4],l!==pt?[3,10]:h!==vt?[3,9]:(y=void 0,void 0!==v?[3,7]:(m=d,w=this.getMonotonicFactory(f)(),_=this.getLegacyKeyForItem(f,m),E=this.getKeyForItem(f,m,w),[4,this.storage.getItem(_)])));case 4:return S=A.sent(),[4,this.storage.setItem(E,S)];case 5:return A.sent(),[4,this.storage.removeItem(_)];case 6:return A.sent(),y=w,[3,8];case 7:y=d,A.label=8;case 8:return this.getCollectionIndex(f).set(v,y),[3,10];case 9:"Collection"===h&&t.push(o),A.label=10;case 10:return r=n.next(),[3,3];case 11:return[3,14];case 12:return O=A.sent(),T={error:O},[3,14];case 13:try{r&&!r.done&&(I=n.return)&&I.call(n)}finally{if(T)throw T.error}return[7];case 14:return t.length>0?[4,this.storage.multiRemove(t)]:[3,16];case 15:A.sent(),A.label=16;case 16:return[2]}}))}))},e.prototype.save=function(e,t){return ut(this,void 0,void 0,(function(){var n,r;return lt(this,(function(o){switch(o.label){case 0:return n=this.getCollectionIndex(t).get(e.id)||this.getMonotonicFactory(t)(),r=this.getKeyForItem(t,e.id,n),this.getCollectionIndex(t).set(e.id,n),[4,this.storage.setItem(r,JSON.stringify(e))];case 1:return o.sent(),[2]}}))}))},e.prototype.batchSave=function(e,t){return ut(this,void 0,void 0,(function(){var n,r,o,c,l,f,h,d,v,y,m,w,_,E,S,O,T,I,A,N,C,x=this;return lt(this,(function(k){switch(k.label){case 0:if(0===t.length)return[2,[]];n=[],r=this.getCollectionIndex(e),o=new Set,c=new Set,l=[],f={};try{for(h=ft(t),d=h.next();!d.done;d=h.next())v=d.value,y=v.id,m=v._deleted,w=r.get(y)||this.getMonotonicFactory(e)(),T=this.getKeyForItem(e,y,w),l.push(T),f[T]={ulid:w,model:v},m?o.add(T):c.add(T)}catch(e){I={error:e}}finally{try{d&&!d.done&&(A=h.return)&&A.call(h)}finally{if(I)throw I.error}}return[4,this.storage.multiGet(l)];case 1:return _=k.sent(),E=_.filter((function(e){return!!ht(e,2)[1]})).reduce((function(e,t){var n=ht(t,1)[0];return e.add(n)}),new Set),[4,new Promise((function(e,t){if(0!==o.size){var n=Array.from(o);n.forEach((function(e){return r.delete(f[e].model.id)})),x.storage.multiRemove(n,(function(n){n&&n.length>0?t(n):e()}))}else e()}))];case 2:return k.sent(),[4,new Promise((function(e,t){if(0!==c.size){var n=Array.from(c).map((function(e){return[e,JSON.stringify(f[e].model)]}));c.forEach((function(e){var t=f[e],n=t.model.id,o=t.ulid;r.set(n,o)})),x.storage.multiSet(n,(function(n){n&&n.length>0?t(n):e()}))}else e()}))];case 3:k.sent();try{for(S=ft(l),O=S.next();!O.done;O=S.next())T=O.value,o.has(T)&&E.has(T)?n.push([f[T].model,pe.h.DELETE]):c.has(T)&&n.push([f[T].model,E.has(T)?pe.h.UPDATE:pe.h.INSERT])}catch(e){N={error:e}}finally{try{O&&!O.done&&(C=S.return)&&C.call(S)}finally{if(N)throw N.error}}return[2,n]}}))}))},e.prototype.get=function(e,t){return ut(this,void 0,void 0,(function(){var n,r,o;return lt(this,(function(c){switch(c.label){case 0:return n=this.getCollectionIndex(t).get(e),r=this.getKeyForItem(t,e,n),[4,this.storage.getItem(r)];case 1:return o=c.sent(),[2,o&&JSON.parse(o)]}}))}))},e.prototype.getOne=function(e,t){return ut(this,void 0,void 0,(function(){var n,r,o,c,l,f,h;return lt(this,(function(d){switch(d.label){case 0:return n=this.getCollectionIndex(t),r=ht(e===pe.j.FIRST?function(){var e,t,r,o,c;try{for(var l=ft(n),f=l.next();!f.done;f=l.next()){o=(r=ht(f.value,2))[0],c=r[1];break}}catch(t){e={error:t}}finally{try{f&&!f.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}return[o,c]}():function(){var e,t,r,o,c;try{for(var l=ft(n),f=l.next();!f.done;f=l.next())o=(r=ht(f.value,2))[0],c=r[1]}catch(t){e={error:t}}finally{try{f&&!f.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}return[o,c]}(),2),o=r[0],c=r[1],l=this.getKeyForItem(t,o,c),(h=l)?[4,this.storage.getItem(l)]:[3,2];case 1:h=d.sent(),d.label=2;case 2:return[2,(f=h)&&JSON.parse(f)||void 0]}}))}))},e.prototype.getAll=function(e,t){return ut(this,void 0,void 0,(function(){var n,r,o,c,l,f,h,d,v,y,m,w,_,E,S,O,T,I,A;return lt(this,(function(N){switch(N.label){case 0:n=this.getCollectionIndex(e),o=(r=t||{}).page,c=void 0===o?0:o,l=r.limit,f=void 0===l?0:l,h=Math.max(0,c*f)||0,d=f>0?h+f:void 0,v=[],y=0;try{for(m=ft(n),w=m.next();!w.done&&(_=ht(w.value,2),E=_[0],S=_[1],++y<=h||(v.push(this.getKeyForItem(e,E,S)),y!==d));w=m.next());}catch(e){I={error:e}}finally{try{w&&!w.done&&(A=m.return)&&A.call(m)}finally{if(I)throw I.error}}return[4,this.storage.multiGet(v)];case 1:return O=N.sent(),T=O.filter((function(e){return ht(e,2)[1]})).map((function(e){var t=ht(e,2)[1];return JSON.parse(t)})),[2,T]}}))}))},e.prototype.delete=function(e,t){return ut(this,void 0,void 0,(function(){var n,r;return lt(this,(function(o){switch(o.label){case 0:return n=this.getCollectionIndex(t).get(e),r=this.getKeyForItem(t,e,n),this.getCollectionIndex(t).delete(e),[4,this.storage.removeItem(r)];case 1:return o.sent(),[2]}}))}))},e.prototype.clear=function(){return ut(this,void 0,void 0,(function(){var e,t;return lt(this,(function(n){switch(n.label){case 0:return[4,this.storage.getAllKeys()];case 1:return e=n.sent(),t=e.filter((function(e){return e.startsWith(pt)})),[4,this.storage.multiRemove(t)];case 2:return n.sent(),this._collectionInMemoryIndex.clear(),[2]}}))}))},e.prototype.getKeyForItem=function(e,t,n){return this.getKeyPrefixForStoreItems(e)+"::"+n+"::"+t},e.prototype.getLegacyKeyForItem=function(e,t){return this.getKeyPrefixForStoreItems(e)+"::"+t},e.prototype.getKeyPrefixForStoreItems=function(e){return"@AmplifyDatastore::"+e+"::"+vt},e}(),mt=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},gt=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},wt=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,t=e[Symbol.asyncIterator];return t?t.call(e):(e="function"==typeof _t?_t(e):e[Symbol.iterator](),i={},n("next"),n("throw"),n("return"),i[Symbol.asyncIterator]=function(){return this},i);function n(t){i[t]=e[t]&&function(n){return new Promise((function(r,o){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,o,(n=e[t](n)).done,n.value)}))}}},_t=function(e){var s="function"==typeof Symbol&&Symbol.iterator,t=s&&e[s],i=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},Et=new r.a("DataStore"),St=new(function(){function e(){}return e.prototype.getStorenameForModel=function(e){var t=this.namespaceResolver(e),n=e.name;return this.getStorename(t,n)},e.prototype.getStorename=function(e,t){return e+"_"+t},e.prototype.setUp=function(e,t,n,r){return mt(this,void 0,void 0,(function(){var o,c=this;return gt(this,(function(l){switch(l.label){case 0:return this.initPromise?[3,1]:(this.initPromise=new Promise((function(e,t){c.resolve=e,c.reject=t})),[3,3]);case 1:return[4,this.initPromise];case 2:return l.sent(),[2];case 3:this.schema=e,this.namespaceResolver=t,this.modelInstanceCreator=n,this.getModelConstructorByModelName=r,l.label=4;case 4:return l.trys.push([4,7,,8]),this.db?[3,6]:(this.db=new bt,[4,this.db.init()]);case 5:l.sent(),this.resolve(),l.label=6;case 6:return[3,8];case 7:return o=l.sent(),this.reject(o),[3,8];case 8:return[2]}}))}))},e.prototype.save=function(e,t){var n,r;return mt(this,void 0,void 0,(function(){var o,c,l,f,h,d,v,y,m,w,_,E,S,O,T,I,A,N,C,x,k,P,M=this;return gt(this,(function(D){switch(D.label){case 0:return o=Object.getPrototypeOf(e).constructor,c=this.getStorenameForModel(o),l=Object(Ce.z)(o.name,e,this.schema.namespaces[this.namespaceResolver(o)],this.modelInstanceCreator,this.getModelConstructorByModelName),f=this.namespaceResolver(o),h=new Set,d=Object.values(l).map((function(e){var t=e.modelName,n=e.item,r=e.instance,o=M.getStorename(f,t);return h.add(o),{storeName:o,item:n,instance:r}})),[4,this.db.get(e.id,c)];case 1:if(v=D.sent(),t&&v&&(y=Se.a.getPredicates(t),m=y.predicates,w=y.type,!Object(Ce.A)(v,w,m)))throw _="Conditional update failed",Et.error(_,{model:v,condition:m}),new Error(_);E=[],D.label=2;case 2:D.trys.push([2,9,10,15]),S=wt(d),D.label=3;case 3:return[4,S.next()];case 4:return(O=D.sent()).done?[3,8]:(T=O.value,I=T.storeName,A=T.item,N=T.instance,C=A.id,[4,this.db.get(C,I)]);case 5:return x=D.sent(),k=x?pe.h.UPDATE:pe.h.INSERT,C!==e.id&&k!==pe.h.INSERT?[3,7]:[4,this.db.save(A,I)];case 6:D.sent(),E.push([N,k]),D.label=7;case 7:return[3,3];case 8:return[3,15];case 9:return P=D.sent(),n={error:P},[3,15];case 10:return D.trys.push([10,,13,14]),O&&!O.done&&(r=S.return)?[4,r.call(S)]:[3,12];case 11:D.sent(),D.label=12;case 12:return[3,14];case 13:if(n)throw n.error;return[7];case 14:return[7];case 15:return[2,E]}}))}))},e.prototype.load=function(e,t,n){var r,o,c,l,f,h,d,v,y,m;return mt(this,void 0,void 0,(function(){var w,_,E,S,O,T,I,A,N,C,x,k,P,M,D,R,j,L,F,U=this;return gt(this,(function(B){switch(B.label){case 0:if(w=this.schema.namespaces[e],_=w.relationships[t].relationTypes,E=_.map((function(t){var n=t.modelName;return U.getStorename(e,n)})),S=this.getModelConstructorByModelName(e,t),0===E.length)return[2,n.map((function(e){return U.modelInstanceCreator(S,e)}))];B.label=1;case 1:B.trys.push([1,34,35,40]),O=wt(_),B.label=2;case 2:return[4,O.next()];case 3:if((T=B.sent()).done)return[3,33];switch(I=T.value,A=I.fieldName,N=I.modelName,C=I.targetName,x=I.relationType,k=this.getStorename(e,N),P=this.getModelConstructorByModelName(e,N),x){case"HAS_ONE":return[3,4];case"BELONGS_TO":return[3,17];case"HAS_MANY":return[3,30]}return[3,31];case 4:B.trys.push([4,10,11,16]),r=wt(n),B.label=5;case 5:return[4,r.next()];case 6:return(o=B.sent()).done?[3,9]:(R=o.value,M=R[C]?C:A,R[M]?[4,this.db.get(R[M],k)]:[3,9]);case 7:j=B.sent(),R[A]=j&&this.modelInstanceCreator(P,j),B.label=8;case 8:return[3,5];case 9:return[3,16];case 10:return D=B.sent(),d={error:D},[3,16];case 11:return B.trys.push([11,,14,15]),o&&!o.done&&(v=r.return)?[4,v.call(r)]:[3,13];case 12:B.sent(),B.label=13;case 13:return[3,15];case 14:if(d)throw d.error;return[7];case 15:return[7];case 16:return[3,32];case 17:B.trys.push([17,23,24,29]),c=wt(n),B.label=18;case 18:return[4,c.next()];case 19:return(l=B.sent()).done?[3,22]:(R=l.value)[C]?[4,this.db.get(R[C],k)]:[3,21];case 20:j=B.sent(),R[A]=j&&this.modelInstanceCreator(P,j),delete R[C],B.label=21;case 21:return[3,18];case 22:return[3,29];case 23:return L=B.sent(),y={error:L},[3,29];case 24:return B.trys.push([24,,27,28]),l&&!l.done&&(m=c.return)?[4,m.call(c)]:[3,26];case 25:B.sent(),B.label=26;case 26:return[3,28];case 27:if(y)throw y.error;return[7];case 28:return[7];case 29:case 30:return[3,32];case 31:return Object(Ce.g)(x),[3,32];case 32:return[3,2];case 33:return[3,40];case 34:return F=B.sent(),f={error:F},[3,40];case 35:return B.trys.push([35,,38,39]),T&&!T.done&&(h=O.return)?[4,h.call(O)]:[3,37];case 36:B.sent(),B.label=37;case 37:return[3,39];case 38:if(f)throw f.error;return[7];case 39:return[7];case 40:return[2,n.map((function(e){return U.modelInstanceCreator(S,e)}))]}}))}))},e.prototype.query=function(e,t,n){return mt(this,void 0,void 0,(function(){var r,o,c,l,f,h,d,v=this;return gt(this,(function(y){switch(y.label){case 0:return r=this.getStorenameForModel(e),o=this.namespaceResolver(e),c=t&&Se.a.getPredicates(t),l=c&&this.idFromPredicate(c),f=n&&n.sort,h=n&&n.limit,[4,mt(v,void 0,void 0,(function(){var e,t,o;return gt(this,(function(d){switch(d.label){case 0:return l?[4,this.getById(r,l)]:[3,2];case 1:return[2,(e=d.sent())?[e]:[]];case 2:return c?[4,this.filterOnPredicate(r,c)]:[3,4];case 3:return t=d.sent(),[2,this.inMemoryPagination(t,n)];case 4:return f||h?[4,this.getAll(r)]:[3,6];case 5:return o=d.sent(),[2,this.inMemoryPagination(o,n)];case 6:return[2,this.getAll(r)]}}))}))];case 1:return d=y.sent(),[4,this.load(o,e.name,d)];case 2:return[2,y.sent()]}}))}))},e.prototype.getById=function(e,t){return mt(this,void 0,void 0,(function(){return gt(this,(function(n){switch(n.label){case 0:return[4,this.db.get(t,e)];case 1:return[2,n.sent()]}}))}))},e.prototype.getAll=function(e){return mt(this,void 0,void 0,(function(){return gt(this,(function(t){switch(t.label){case 0:return[4,this.db.getAll(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.idFromPredicate=function(e){var t=e.predicates,n=1===t.length&&t.find((function(p){return Object(pe.t)(p)&&"id"===p.field&&"eq"===p.operator}));return n&&n.operand},e.prototype.filterOnPredicate=function(e,t){return mt(this,void 0,void 0,(function(){var n,r,o;return gt(this,(function(c){switch(c.label){case 0:return n=t.predicates,r=t.type,[4,this.getAll(e)];case 1:return o=c.sent(),[2,n?o.filter((function(e){return Object(Ce.A)(e,r,n)})):o]}}))}))},e.prototype.inMemoryPagination=function(e,t){if(t&&e.length>1){if(t.sort){var n=Oe.a.getPredicates(t.sort);if(n.length){var r=Object(Ce.y)(n);e.sort(r)}}var o=t.page,c=void 0===o?0:o,l=t.limit,f=void 0===l?0:l,h=Math.max(0,c*f)||0,d=f>0?h+f:e.length;return e.slice(h,d)}return e},e.prototype.queryOne=function(e,t){return void 0===t&&(t=pe.j.FIRST),mt(this,void 0,void 0,(function(){var n,r;return gt(this,(function(o){switch(o.label){case 0:return n=this.getStorenameForModel(e),[4,this.db.getOne(t,n)];case 1:return[2,(r=o.sent())&&this.modelInstanceCreator(e,r)]}}))}))},e.prototype.delete=function(e,t){return mt(this,void 0,void 0,(function(){var n,r,o,c,l,f,h,d,v,y,m,w,_;return gt(this,(function(E){switch(E.label){case 0:return n=[],Object(Ce.t)(e)?(c=e,l=this.namespaceResolver(c),[4,this.query(c,t)]):[3,8];case 1:return r=E.sent(),w=this.schema.namespaces[l].relationships[c.name].relationTypes,void 0===t?[3,4]:[4,this.deleteTraverse(w,r,c.name,l,n)];case 2:return E.sent(),[4,this.deleteItem(n)];case 3:return E.sent(),_=n.reduce((function(e,t){var n=t.items;return e.concat(n)}),[]),[2,[r,_]];case 4:return[4,this.deleteTraverse(w,r,c.name,l,n)];case 5:return E.sent(),[4,this.deleteItem(n)];case 6:return E.sent(),_=n.reduce((function(e,t){var n=t.items;return e.concat(n)}),[]),[2,[r,_]];case 7:return[3,15];case 8:return o=e,c=Object.getPrototypeOf(o).constructor,l=this.namespaceResolver(c),f=this.getStorenameForModel(c),t?[4,this.db.get(o.id,f)]:[3,11];case 9:if(void 0===(h=E.sent()))return m="Model instance not found in storage",Et.warn(m,{model:o}),[2,[[o],[]]];if(d=Se.a.getPredicates(t),v=d.predicates,y=d.type,!Object(Ce.A)(h,y,v))throw m="Conditional update failed",Et.error(m,{model:h,condition:v}),new Error(m);return w=this.schema.namespaces[l].relationships[c.name].relationTypes,[4,this.deleteTraverse(w,[o],c.name,l,n)];case 10:return E.sent(),[3,13];case 11:return w=this.schema.namespaces[l].relationships[c.name].relationTypes,[4,this.deleteTraverse(w,[o],c.name,l,n)];case 12:E.sent(),E.label=13;case 13:return[4,this.deleteItem(n)];case 14:return E.sent(),_=n.reduce((function(e,t){var n=t.items;return e.concat(n)}),[]),[2,[[o],_]];case 15:return[2]}}))}))},e.prototype.deleteItem=function(e){var t,n,r,o,c,l;return mt(this,void 0,void 0,(function(){var f,h,d,v,y,m,w,_,E;return gt(this,(function(S){switch(S.label){case 0:S.trys.push([0,17,18,23]),t=wt(e),S.label=1;case 1:return[4,t.next()];case 2:if((n=S.sent()).done)return[3,16];f=n.value,h=f.storeName,d=f.items,S.label=3;case 3:S.trys.push([3,9,10,15]),v=wt(d),S.label=4;case 4:return[4,v.next()];case 5:return(y=S.sent()).done?[3,8]:(m=y.value)?"object"!=typeof m?[3,7]:(w=m.id,[4,this.db.delete(w,h)]):[3,7];case 6:S.sent(),S.label=7;case 7:return[3,4];case 8:return[3,15];case 9:return _=S.sent(),c={error:_},[3,15];case 10:return S.trys.push([10,,13,14]),y&&!y.done&&(l=v.return)?[4,l.call(v)]:[3,12];case 11:S.sent(),S.label=12;case 12:return[3,14];case 13:if(c)throw c.error;return[7];case 14:return[7];case 15:return[3,1];case 16:return[3,23];case 17:return E=S.sent(),r={error:E},[3,23];case 18:return S.trys.push([18,,21,22]),n&&!n.done&&(o=t.return)?[4,o.call(t)]:[3,20];case 19:S.sent(),S.label=20;case 20:return[3,22];case 21:if(r)throw r.error;return[7];case 22:return[7];case 23:return[2]}}))}))},e.prototype.deleteTraverse=function(e,t,n,r,o){var c,l,f,h,d,v,y,m,w,_,E,S;return mt(this,void 0,void 0,(function(){var O,T,I,A,N,C,x,k,P,M,D,R,j,L,F,U=this;return gt(this,(function(B){switch(B.label){case 0:B.trys.push([0,35,36,41]),c=wt(e),B.label=1;case 1:return[4,c.next()];case 2:if((l=B.sent()).done)return[3,34];switch(O=l.value,T=O.relationType,I=O.modelName,A=O.targetName,N=this.getStorename(r,I),C=Object(Ce.h)(this.schema.namespaces[r].relationships[I].relationTypes,n)||Object(Ce.i)(this.schema.namespaces[r].relationships[I].indexes,O.associatedWith),T){case"HAS_ONE":return[3,3];case"HAS_MANY":return[3,17];case"BELONGS_TO":return[3,31]}return[3,32];case 3:B.trys.push([3,10,11,16]),f=wt(t),B.label=4;case 4:return[4,f.next()];case 5:return(h=B.sent()).done?[3,9]:(D=h.value,x=C||"byId",(k=A in D?D[A]:D.id)?[4,this.db.getAll(N)]:[3,9]);case 6:return R=B.sent(),P=R.filter((function(e){return e[x]===k})),[4,this.deleteTraverse(this.schema.namespaces[r].relationships[I].relationTypes,P,I,r,o)];case 7:B.sent(),B.label=8;case 8:return[3,4];case 9:return[3,16];case 10:return M=B.sent(),w={error:M},[3,16];case 11:return B.trys.push([11,,14,15]),h&&!h.done&&(_=f.return)?[4,_.call(f)]:[3,13];case 12:B.sent(),B.label=13;case 13:return[3,15];case 14:if(w)throw w.error;return[7];case 15:return[7];case 16:return[3,33];case 17:B.trys.push([17,24,25,30]),d=wt(t),B.label=18;case 18:return[4,d.next()];case 19:return(v=B.sent()).done?[3,23]:(D=v.value,[4,this.db.getAll(N)]);case 20:return R=B.sent(),j=R.filter((function(e){return e[C]===D.id})),[4,this.deleteTraverse(this.schema.namespaces[r].relationships[I].relationTypes,j,I,r,o)];case 21:B.sent(),B.label=22;case 22:return[3,18];case 23:return[3,30];case 24:return L=B.sent(),E={error:L},[3,30];case 25:return B.trys.push([25,,28,29]),v&&!v.done&&(S=d.return)?[4,S.call(d)]:[3,27];case 26:B.sent(),B.label=27;case 27:return[3,29];case 28:if(E)throw E.error;return[7];case 29:return[7];case 30:case 31:return[3,33];case 32:return Object(Ce.g)(T),[3,33];case 33:return[3,1];case 34:return[3,41];case 35:return F=B.sent(),y={error:F},[3,41];case 36:return B.trys.push([36,,39,40]),l&&!l.done&&(m=c.return)?[4,m.call(c)]:[3,38];case 37:B.sent(),B.label=38;case 38:return[3,40];case 39:if(y)throw y.error;return[7];case 40:return[7];case 41:return o.push({storeName:this.getStorename(r,n),items:t.map((function(e){return U.modelInstanceCreator(U.getModelConstructorByModelName(r,n),e)}))}),[2]}}))}))},e.prototype.clear=function(){return mt(this,void 0,void 0,(function(){return gt(this,(function(e){switch(e.label){case 0:return[4,this.db.clear()];case 1:return e.sent(),this.db=void 0,this.initPromise=void 0,[2]}}))}))},e.prototype.batchSave=function(e,t){return mt(this,void 0,void 0,(function(){var n,r,o,c,l,f,h,d,v,y,m;return gt(this,(function(w){switch(w.label){case 0:n=e.name,r=this.namespaceResolver(e),o=this.getStorename(r,n),c=[],l=function(t){var n=t.id,r=Object(Ce.z)(e.name,f.modelInstanceCreator(e,t),f.schema.namespaces[f.namespaceResolver(e)],f.modelInstanceCreator,f.getModelConstructorByModelName).find((function(e){return e.instance.id===n})).instance;c.push(r)},f=this;try{for(h=_t(t),d=h.next();!d.done;d=h.next())v=d.value,l(v)}catch(e){y={error:e}}finally{try{d&&!d.done&&(m=h.return)&&m.call(h)}finally{if(y)throw y.error}}return[4,this.db.batchSave(o,c)];case 1:return[2,w.sent()]}}))}))},e}()),Ot=function(){return Object(o.b)().isBrowser&&window.indexedDB||Object(o.e)()&&self.indexedDB?nt:St},Tt=function(){return Tt=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},Tt.apply(this,arguments)},It=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},At=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},Nt=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t},Ct=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},xt=function(e){var s="function"==typeof Symbol&&Symbol.iterator,t=s&&e[s],i=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},kt=new r.a("DataStore"),Pt=function(){function e(e,t,n,r,o,c){this.schema=e,this.namespaceResolver=t,this.getModelConstructorByModelName=n,this.modelInstanceCreator=r,this.adapter=o,this.sessionId=c,this.adapter=this.adapter||Ot(),this.pushStream=new Ne.a}return e.getNamespace=function(){return{name:Ce.c,relationships:{},enums:{},models:{},nonModels:{}}},e.prototype.init=function(){return It(this,void 0,void 0,(function(){var e,t;return At(this,(function(n){switch(n.label){case 0:return void 0===this.initialized?[3,2]:[4,this.initialized];case 1:case 3:return n.sent(),[2];case 2:return kt.debug("Starting Storage"),this.initialized=new Promise((function(n,r){e=n,t=r})),this.adapter.setUp(this.schema,this.namespaceResolver,this.modelInstanceCreator,this.getModelConstructorByModelName,this.sessionId).then(e,t),[4,this.initialized]}}))}))},e.prototype.save=function(e,t,n,r){return It(this,void 0,void 0,(function(){var o,c=this;return At(this,(function(l){switch(l.label){case 0:return[4,this.init()];case 1:return l.sent(),[4,this.adapter.save(e,t)];case 2:return(o=l.sent()).forEach((function(l){var f,h=Ct(l,2),d=h[0],v=h[1],y=!!n;if(v===pe.h.UPDATE&&!y&&null===(f=c.getUpdateMutationInput(e,d,r)))return o;var element=f||d,m=Object.getPrototypeOf(d).constructor;c.pushStream.next({model:m,opType:v,element:element,mutator:n,condition:Se.a.getPredicates(t,!1),savedElement:d})})),[2,o]}}))}))},e.prototype.delete=function(e,t,n){return It(this,void 0,void 0,(function(){var r,o,c,l,f=this;return At(this,(function(h){switch(h.label){case 0:return[4,this.init()];case 1:return h.sent(),[4,this.adapter.delete(e,t)];case 2:return l=Ct.apply(void 0,[h.sent(),2]),o=l[0],r=l[1],c=new Set(o.map((function(e){return e.id}))),Object(Ce.t)(e)||Array.isArray(r)||(r=[r]),r.forEach((function(r){var o,l=Object.getPrototypeOf(r).constructor;Object(Ce.t)(e)||(o=c.has(r.id)?Se.a.getPredicates(t,!1):void 0),f.pushStream.next({model:l,opType:pe.h.DELETE,element:r,mutator:n,condition:o})})),[2,[o,r]]}}))}))},e.prototype.query=function(e,t,n){return It(this,void 0,void 0,(function(){return At(this,(function(r){switch(r.label){case 0:return[4,this.init()];case 1:return r.sent(),[4,this.adapter.query(e,t,n)];case 2:return[2,r.sent()]}}))}))},e.prototype.queryOne=function(e,t){return void 0===t&&(t=pe.j.FIRST),It(this,void 0,void 0,(function(){return At(this,(function(n){switch(n.label){case 0:return[4,this.init()];case 1:return n.sent(),[4,this.adapter.queryOne(e,t)];case 2:return[2,n.sent()]}}))}))},e.prototype.observe=function(e,t,n){var r=!e,o=Se.a.getPredicates(t,!1)||{},c=o.predicates,l=o.type,f=!!c,h=this.pushStream.observable.filter((function(e){var t=e.mutator;return!n||t!==n})).map((function(e){e.mutator;return Nt(e,["mutator"])}));return r||(h=h.filter((function(t){var n=t.model,element=t.element;return e===n&&(!f||Object(Ce.A)(element,l,c))}))),h},e.prototype.clear=function(e){return void 0===e&&(e=!0),It(this,void 0,void 0,(function(){return At(this,(function(t){switch(t.label){case 0:return this.initialized=void 0,[4,this.adapter.clear()];case 1:return t.sent(),e&&this.pushStream.complete(),[2]}}))}))},e.prototype.batchSave=function(e,t,n){return It(this,void 0,void 0,(function(){var r,o=this;return At(this,(function(c){switch(c.label){case 0:return[4,this.init()];case 1:return c.sent(),[4,this.adapter.batchSave(e,t)];case 2:return(r=c.sent()).forEach((function(t){var r=Ct(t,2),element=r[0],c=r[1];o.pushStream.next({model:e,opType:c,element:element,mutator:n,condition:void 0})})),[2,r]}}))}))},e.prototype.getUpdateMutationInput=function(e,t,n){var r,o;if(!(n&&n.length))return null;var c=Ct(n,2),l=c[0],source=c[1],f={},h=l.map((function(e){return e.path&&e.path[0]})),d=Object.getPrototypeOf(e).constructor,v=this.namespaceResolver(d),y=this.schema.namespaces[v].models[d.name].fields,m=this.schema.namespaces[v].keys[d.name],w=m.primaryKey,_=m.compositeKeys,E=void 0===_?[]:_;if(h.forEach((function(e){var n,r,o,c,l,h=Object(pe.v)(null===(l=y[e])||void 0===l?void 0:l.association)||e;if(!Object(Ce.B)(source[h],t[h])){f[h]=void 0===t[h]?null:t[h];try{for(var d=xt(E),v=d.next();!v.done;v=d.next()){var m=v.value;if(m.has(h))try{for(var w=(o=void 0,xt(m)),_=w.next();!_.done;_=w.next()){var S=_.value;f[S]=t[S]}}catch(e){o={error:e}}finally{try{_&&!_.done&&(c=w.return)&&c.call(w)}finally{if(o)throw o.error}}}}catch(e){n={error:e}}finally{try{v&&!v.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}}})),w&&w.length)try{for(var S=xt(w),O=S.next();!O.done;O=S.next()){var T=O.value;f[T]=t[T]}}catch(e){r={error:e}}finally{try{O&&!O.done&&(o=S.return)&&o.call(S)}finally{if(r)throw r.error}}if(0===Object.keys(f).length)return null;var I=t.id,A=t._version,N=t._lastChangedAt,C=t._deleted;return Tt(Tt({},f),{id:I,_version:A,_lastChangedAt:N,_deleted:C})},e}(),Mt=function(){function e(e,t,n,r,o,c){this.mutex=new Ie,this.storage=new Pt(e,t,n,r,o,c)}return e.prototype.runExclusive=function(e){return this.mutex.runExclusive(e.bind(this,this.storage))},e.prototype.save=function(e,t,n,r){return It(this,void 0,void 0,(function(){return At(this,(function(o){return[2,this.runExclusive((function(o){return o.save(e,t,n,r)}))]}))}))},e.prototype.delete=function(e,t,n){return It(this,void 0,void 0,(function(){return At(this,(function(r){return[2,this.runExclusive((function(r){if(Object(Ce.t)(e)){var o=e;return r.delete(o,t,n)}var c=e;return r.delete(c,t,n)}))]}))}))},e.prototype.query=function(e,t,n){return It(this,void 0,void 0,(function(){return At(this,(function(r){return[2,this.runExclusive((function(r){return r.query(e,t,n)}))]}))}))},e.prototype.queryOne=function(e,t){return void 0===t&&(t=pe.j.FIRST),It(this,void 0,void 0,(function(){return At(this,(function(n){return[2,this.runExclusive((function(n){return n.queryOne(e,t)}))]}))}))},e.getNamespace=function(){return Pt.getNamespace()},e.prototype.observe=function(e,t,n){return this.storage.observe(e,t,n)},e.prototype.clear=function(){return It(this,void 0,void 0,(function(){return At(this,(function(e){switch(e.label){case 0:return[4,this.storage.clear()];case 1:return e.sent(),[2]}}))}))},e.prototype.batchSave=function(e,t){return this.storage.batchSave(e,t)},e.prototype.init=function(){return It(this,void 0,void 0,(function(){return At(this,(function(e){return[2,this.storage.init()]}))}))},e}(),Dt=n(412),Rt=function(e){var s="function"==typeof Symbol&&Symbol.iterator,t=s&&e[s],i=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},jt=(new(function(){function e(){}return e.prototype.networkMonitor=function(t){if(Object(o.b)().isNode)return fe.a.from([{online:!0}]);var n=Object(o.e)()?self:window;return new fe.a((function(t){t.next({online:n.navigator.onLine});var r=function(){return t.next({online:!0})},o=function(){return t.next({online:!1})};return n.addEventListener("online",r),n.addEventListener("offline",o),e._observers.push(t),function(){n.removeEventListener("online",r),n.removeEventListener("offline",o),e._observers=e._observers.filter((function(e){return e!==t}))}}))},e._observerOverride=function(t){var n,r,o=function(n){if(n.closed)return e._observers=e._observers.filter((function(e){return e!==n})),"continue";n.next(t)};try{for(var c=Rt(e._observers),l=c.next();!l.done;l=c.next()){o(l.value)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}},e._observers=[],e}())).networkMonitor(),Lt=function(){return Lt=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},Lt.apply(this,arguments)},Ft=(new r.a("DataStore"),function(){function e(){this.connectionStatus={online:!1}}return e.prototype.status=function(){var e=this;if(this.observer)throw new Error("Subscriber already exists");return new fe.a((function(t){return e.observer=t,e.subscription=jt.subscribe((function(n){var r=n.online;e.connectionStatus.online=r;var o=Lt({},e.connectionStatus);t.next(o)})),function(){clearTimeout(e.timeout),e.unsubscribe()}}))},e.prototype.unsubscribe=function(){this.subscription&&(clearTimeout(this.timeout),this.subscription.unsubscribe())},e.prototype.socketDisconnected=function(){var e=this;this.observer&&"function"==typeof this.observer.next&&(this.observer.next({online:!1}),this.timeout=setTimeout((function(){var t=Lt({},e.connectionStatus);e.observer.next(t)}),5e3))},e}()),Ut=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},qt=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},Bt=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},Gt=function(e){var s="function"==typeof Symbol&&Symbol.iterator,t=s&&e[s],i=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},Vt=function(){for(var e=[],i=0;i<arguments.length;i++)e=e.concat(Bt(arguments[i]));return e},Kt=function(){function e(e,t){this.outbox=e,this.ownSymbol=t}return e.prototype.merge=function(e,t){return Ut(this,void 0,void 0,(function(){var n,r,o,c,l;return qt(this,(function(f){switch(f.label){case 0:return[4,this.outbox.getForModel(e,t)];case 1:return r=f.sent(),o=t._deleted,0!==r.length?[3,5]:o?(n=pe.h.DELETE,[4,e.delete(t,void 0,this.ownSymbol)]):[3,3];case 2:return f.sent(),[3,5];case 3:return[4,e.save(t,void 0,this.ownSymbol)];case 4:c=Bt.apply(void 0,[f.sent(),1]),l=Bt(c[0],2),n=l[1],f.label=5;case 5:return[2,n]}}))}))},e.prototype.mergePage=function(e,t,n){return Ut(this,void 0,void 0,(function(){var r,o,c,l,f,h,d;return qt(this,(function(v){switch(v.label){case 0:r=new Map;try{for(o=Gt(n),c=o.next();!c.done;c=o.next())l=c.value,r.set(l.id,l)}catch(e){h={error:e}}finally{try{c&&!c.done&&(d=o.return)&&d.call(o)}finally{if(h)throw h.error}}return f=Vt(r.values()),[4,e.batchSave(t,f,this.ownSymbol)];case 1:return[2,v.sent()]}}))}))},e}(),Wt=n(511),zt=function(){return zt=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},zt.apply(this,arguments)},Yt=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},Ht=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},Jt=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t},Qt=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},$t=function(){function e(e,t,n,r){this.schema=e,this.MutationEvent=t,this.modelInstanceCreator=n,this.ownSymbol=r}return e.prototype.enqueue=function(e,t){return Yt(this,void 0,void 0,(function(){var n=this;return Ht(this,(function(r){return e.runExclusive((function(s){return Yt(n,void 0,void 0,(function(){var e,n,r,o,c,l,f,h,d,v=this;return Ht(this,(function(y){switch(y.label){case 0:return e=this.schema.namespaces[Ce.d].models.MutationEvent,n=Se.a.createFromExisting(e,(function(e){return e.modelId("eq",t.modelId).id("ne",v.inProgressMutationEventId)})),[4,s.query(this.MutationEvent,n)];case 1:return r=Qt.apply(void 0,[y.sent(),1]),void 0!==(o=r[0])?[3,3]:[4,s.save(t,void 0,this.ownSymbol)];case 2:return y.sent(),[2];case 3:return c=t.operation,o.operation!==Wt.a.CREATE?[3,8]:c!==Wt.a.DELETE?[3,5]:[4,s.delete(this.MutationEvent,n)];case 4:return y.sent(),[3,7];case 5:return l=this.mergeUserFields(o,t),[4,s.save(this.MutationEvent.copyOf(o,(function(e){e.data=l.data})),void 0,this.ownSymbol)];case 6:y.sent(),y.label=7;case 7:return[3,12];case 8:return f=t.condition,h=JSON.parse(f),d=void 0,0!==Object.keys(h).length?[3,10]:(d=this.mergeUserFields(o,t),[4,s.delete(this.MutationEvent,n)]);case 9:y.sent(),y.label=10;case 10:return d=d||t,[4,s.save(d,void 0,this.ownSymbol)];case 11:y.sent(),y.label=12;case 12:return[2]}}))}))})),[2]}))}))},e.prototype.dequeue=function(e,t,n){return Yt(this,void 0,void 0,(function(){var head;return Ht(this,(function(r){switch(r.label){case 0:return[4,this.peek(e)];case 1:return head=r.sent(),t?[4,this.syncOutboxVersionsOnDequeue(e,t,head,n)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[4,e.delete(head)];case 4:return r.sent(),this.inProgressMutationEventId=void 0,[2,head]}}))}))},e.prototype.peek=function(e){return Yt(this,void 0,void 0,(function(){var head;return Ht(this,(function(t){switch(t.label){case 0:return[4,e.queryOne(this.MutationEvent,pe.j.FIRST)];case 1:return head=t.sent(),this.inProgressMutationEventId=head?head.id:void 0,[2,head]}}))}))},e.prototype.getForModel=function(e,t){return Yt(this,void 0,void 0,(function(){var n;return Ht(this,(function(r){switch(r.label){case 0:return n=this.schema.namespaces[Ce.d].models.MutationEvent,[4,e.query(this.MutationEvent,Se.a.createFromExisting(n,(function(e){return e.modelId("eq",t.id)})))];case 1:return[2,r.sent()]}}))}))},e.prototype.getModelIds=function(e){return Yt(this,void 0,void 0,(function(){var t,n;return Ht(this,(function(r){switch(r.label){case 0:return[4,e.query(this.MutationEvent)];case 1:return t=r.sent(),n=new Set,t.forEach((function(e){var t=e.modelId;return n.add(t)})),[2,n]}}))}))},e.prototype.syncOutboxVersionsOnDequeue=function(e,t,head,n){return Yt(this,void 0,void 0,(function(){var r,o,c,l,data,f,h,d,v,y,m,w=this;return Ht(this,(function(_){switch(_.label){case 0:return head.operation!==n?[2]:(r=t._version,o=t._lastChangedAt,t._deleted,c=Jt(t,["_version","_lastChangedAt","_deleted"]),l=this.removeTimestampFields(head.model,c),(data=JSON.parse(head.data))?(data._version,data._lastChangedAt,data._deleted,f=Jt(data,["_version","_lastChangedAt","_deleted"]),h=this.removeTimestampFields(head.model,f),Object(Ce.B)(l,h,!0)?(d=this.schema.namespaces[Ce.d].models.MutationEvent,v=Se.a.createFromExisting(d,(function(e){return e.modelId("eq",t.id).id("ne",w.inProgressMutationEventId)})),[4,e.query(this.MutationEvent,v)]):[2]):[2]);case 1:return(y=_.sent()).length?(m=y.map((function(e){var t=JSON.parse(e.data),n=zt(zt({},t),{_version:r,_lastChangedAt:o});return w.MutationEvent.copyOf(e,(function(e){e.data=JSON.stringify(n)}))})),[4,e.delete(this.MutationEvent,v)]):[2];case 2:return _.sent(),[4,Promise.all(m.map((function(t){return Yt(w,void 0,void 0,(function(){return Ht(this,(function(n){switch(n.label){case 0:return[4,e.save(t,void 0,this.ownSymbol)];case 1:return[2,n.sent()]}}))}))})))];case 3:return _.sent(),[2]}}))}))},e.prototype.mergeUserFields=function(e,t){var n=JSON.parse(e.data),r=n._version,o=n.id,c=n._lastChangedAt,l=n._deleted,f=Jt(n,["_version","id","_lastChangedAt","_deleted"]),h=JSON.parse(t.data),d=(h.id,h._version,h._lastChangedAt,h._deleted,Jt(h,["id","_version","_lastChangedAt","_deleted"])),data=JSON.stringify(zt(zt({id:o,_version:r,_lastChangedAt:c,_deleted:l},f),d));return this.modelInstanceCreator(this.MutationEvent,zt(zt({},t),{data:data}))},e.prototype.removeTimestampFields=function(e,t){var n,r,o="createdAt",c="updatedAt",l=o,f=c,h=null===(n=this.schema.namespaces[Ce.e].models[e].attributes)||void 0===n?void 0:n.find((function(e){return"model"===e.type})),d=null===(r=null==h?void 0:h.properties)||void 0===r?void 0:r.timestamps;return d&&(l=d.createdAt,f=d.updatedAt),delete t[l],delete t[f],t},e}(),Xt=n(411),Zt=n(469),en=n(546),tn=function(){return tn=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},tn.apply(this,arguments)},nn=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},rn=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},on=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t},sn=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},an=function(e){var s="function"==typeof Symbol&&Symbol.iterator,t=s&&e[s],i=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},cn=new r.a("DataStore"),un=function(){function e(e,t,n,r,o,c,l,f,h,d){void 0===l&&(l={}),this.schema=e,this.storage=t,this.userClasses=n,this.outbox=r,this.modelInstanceCreator=o,this.MutationEvent=c,this.amplifyConfig=l,this.authModeStrategy=f,this.errorHandler=h,this.conflictHandler=d,this.typeQuery=new WeakMap,this.processing=!1,this.generateQueries()}return e.prototype.generateQueries=function(){var e=this;Object.values(this.schema.namespaces).forEach((function(t){Object.values(t.models).filter((function(e){return e.syncable})).forEach((function(n){var r=sn(Object(Wt.b)(t,n,"CREATE"),1)[0],o=sn(Object(Wt.b)(t,n,"UPDATE"),1)[0],c=sn(Object(Wt.b)(t,n,"DELETE"),1)[0];e.typeQuery.set(n,[r,o,c])}))}))},e.prototype.isReady=function(){return void 0!==this.observer},e.prototype.start=function(){var e=this;return new fe.a((function(t){return e.observer=t,e.resume(),function(){e.pause()}}))},e.prototype.resume=function(){return nn(this,void 0,void 0,(function(){var head,e,t,n,r,o=this;return rn(this,(function(c){switch(c.label){case 0:if(this.processing||!this.isReady())return[2];this.processing=!0,e=Ce.e,t=function(){var t,r,data,c,l,f,h,d,v,y,m,w,_,E,S,O;return rn(this,(function(T){switch(T.label){case 0:t=head.model,r=head.operation,data=head.data,c=head.condition,l=n.userClasses[t],f=void 0,h=void 0,d=void 0,T.label=1;case 1:return T.trys.push([1,4,,5]),[4,Object(Wt.h)({authModeStrategy:n.authModeStrategy,defaultAuthMode:n.amplifyConfig.aws_appsync_authenticationType,modelName:t,schema:n.schema})];case 2:return v=T.sent(),y=v[r.toUpperCase()],m=0,w=function(){return nn(o,void 0,void 0,(function(){var n,o;return rn(this,(function(f){switch(f.label){case 0:return f.trys.push([0,2,,4]),cn.debug("Attempting mutation with authMode: "+y[m]),[4,this.jitteredRetry(e,t,r,data,c,l,this.MutationEvent,head,y[m])];case 1:return n=f.sent(),cn.debug("Mutation sent successfully with authMode: "+y[m]),[2,n];case 2:if(o=f.sent(),++m>=y.length)throw cn.debug("Mutation failed with authMode: "+y[m-1]),o;return cn.debug("Mutation failed with authMode: "+y[m-1]+". Retrying with authMode: "+y[m]),[4,w()];case 3:return[2,f.sent()];case 4:return[2]}}))}))},[4,w()];case 3:return O=sn.apply(void 0,[T.sent(),3]),f=O[0],h=O[1],d=O[2],[3,5];case 4:return"Offline"===(_=T.sent()).message||"RetryMutation"===_.message?[2,"continue"]:[3,5];case 5:return void 0!==f?[3,7]:(cn.debug("done retrying"),[4,n.storage.runExclusive((function(e){return nn(o,void 0,void 0,(function(){return rn(this,(function(t){switch(t.label){case 0:return[4,this.outbox.dequeue(e)];case 1:return t.sent(),[2]}}))}))}))]);case 6:return T.sent(),[2,"continue"];case 7:return E=f.data[h],S=!1,[4,n.storage.runExclusive((function(e){return nn(o,void 0,void 0,(function(){return rn(this,(function(t){switch(t.label){case 0:return[4,this.outbox.dequeue(e,E,r)];case 1:return t.sent(),[4,this.outbox.peek(e)];case 2:return S=void 0!==t.sent(),[2]}}))}))}))];case 8:return T.sent(),n.observer.next({operation:r,modelDefinition:d,model:E,hasMore:S}),[2]}}))},n=this,c.label=1;case 1:return(r=this.processing)?[4,this.outbox.peek(this.storage)]:[3,3];case 2:r=void 0!==(head=c.sent()),c.label=3;case 3:return r?[5,t()]:[3,5];case 4:return c.sent(),[3,1];case 5:return this.pause(),[2]}}))}))},e.prototype.jitteredRetry=function(e,t,n,data,r,o,c,l,f){return nn(this,void 0,void 0,(function(){var h=this;return rn(this,(function(d){switch(d.label){case 0:return[4,Object(Zt.d)((function(t,n,data,r,o,c,l){return nn(h,void 0,void 0,(function(){var h,d,v,y,m,w,_,E,S,O,T,I,A,N,C,code,x,k,P,M,D,R,j,L,F,U,B;return rn(this,(function(G){switch(G.label){case 0:return h=sn(this.createQueryVariables(e,t,n,data,r),5),d=h[0],v=h[1],y=h[2],m=h[3],w=h[4],[4,Object(Wt.i)(f,this.amplifyConfig)];case 1:_=G.sent(),E={query:d,variables:v,authMode:f,authToken:_},S=0,O=this.opTypeFromTransformerOperation(n),G.label=2;case 2:return G.trys.push([2,4,,20]),[4,Xt.a.graphql(E)];case 3:return[2,[G.sent(),m,w]];case 4:if(!((T=G.sent()).errors&&T.errors.length>0))return[3,18];if(I=sn(T.errors,1),A=I[0],N=A.originalError,C=(void 0===N?{}:N).code,code=void 0===C?null:C,"Unauthorized"===A.errorType)throw new Zt.a("Unauthorized");if("Network Error"===A.message||"ECONNABORTED"===code){if(!this.processing)throw new Zt.a("Offline");throw new Error("Network Error")}return"ConflictUnhandled"!==A.errorType?[3,13]:(S++,x=void 0,S>10?(x=pe.b,[3,8]):[3,5]);case 5:return G.trys.push([5,7,,8]),[4,this.conflictHandler({modelConstructor:o,localModel:this.modelInstanceCreator(o,v.input),remoteModel:this.modelInstanceCreator(o,A.data),operation:O,attempts:S})];case 6:return x=G.sent(),[3,8];case 7:return k=G.sent(),cn.warn("conflict trycatch",k),[3,20];case 8:return x!==pe.b?[3,11]:(P=sn(Object(Wt.b)(this.schema.namespaces[e],w,"GET"),1),M=sn(P[0],3),D=M[1],R=M[2],[4,Object(Wt.i)(f,this.amplifyConfig)]);case 9:return j=G.sent(),[4,Xt.a.graphql({query:R,variables:{id:v.input.id},authMode:f,authToken:j})];case 10:return[2,[G.sent(),D,w]];case 11:return L=this.schema.namespaces[e],F=Object(Wt.d)(L.relationships,w,O,o,x,y,c,this.modelInstanceCreator,l.id),[4,this.storage.save(F)];case 12:throw G.sent(),new Zt.a("RetryMutation");case 13:return G.trys.push([13,15,16,17]),[4,this.errorHandler({recoverySuggestion:"Ensure app code is up to date, auth directives exist and are correct on each model, and that server-side data has not been invalidated by a schema change. If the problem persists, search for or create an issue: https://github.com/aws-amplify/amplify-js/issues",localModel:v.input,message:A.message,operation:n,errorType:Object(en.a)(A),errorInfo:A.errorInfo,process:pe.i.mutate,cause:A,remoteModel:A.data?this.modelInstanceCreator(o,A.data):null})];case 14:return G.sent(),[3,17];case 15:return U=G.sent(),cn.warn("Mutation error handler failed with:",U),[3,17];case 16:return[2,A.data?[{data:(B={},B[m]=A.data,B)},m,w]:[]];case 17:return[3,19];case 18:throw new Zt.a(T);case 19:return[3,20];case 20:if(E)return[3,2];G.label=21;case 21:return[2]}}))}))}),[t,n,data,r,o,c,l],hn)];case 1:return[2,d.sent()]}}))}))},e.prototype.createQueryVariables=function(e,t,n,data,r){var o,c,l=this.schema.namespaces[e].models[t],f=this.schema.namespaces[e].keys[t].primaryKey,h=this.typeQuery.get(l),d=sn(h.find((function(e){return sn(e,1)[0]===n})),3),v=d[1],y=d[2],m=JSON.parse(data),w=m._version,_=on(m,["_version"]),E={};if(f&&f.length)try{for(var S=an(f),O=S.next();!O.done;O=S.next()){var T=O.value;E[T]=_[T]}}catch(e){o={error:e}}finally{try{O&&!O.done&&(c=S.return)&&c.call(S)}finally{if(o)throw o.error}}else E.id=_.id;var I=n===Wt.a.DELETE?E:Object.values(l.fields).filter((function(e){var t=e.name,r=e.type,o=e.association;return Object(pe.q)(r)?!(!Object(pe.v)(o)||"BELONGS_TO"!==o.connectionType):n!==Wt.a.UPDATE||_.hasOwnProperty(t)})).map((function(e){var t=e.name,n=e.type,r=e.association,o=t,c=_[t];return Object(pe.q)(n)&&Object(pe.v)(r)&&(o=r.targetName,c=_[o]),[o,c]})).reduce((function(e,t){var n=sn(t,2),r=n[0],o=n[1];return e[r]=o,e}),{}),input=tn(tn({},I),{_version:w}),A=JSON.parse(r);return[y,tn({input:input},n===Wt.a.CREATE?{}:{condition:Object.keys(A).length>0?A:null}),A,v,l]},e.prototype.opTypeFromTransformerOperation=function(e){switch(e){case Wt.a.CREATE:return pe.h.INSERT;case Wt.a.DELETE:return pe.h.DELETE;case Wt.a.UPDATE:return pe.h.UPDATE;case Wt.a.GET:break;default:Object(Ce.g)(e)}},e.prototype.pause=function(){this.processing=!1},e}(),ln=3e5,fn=Object(Zt.b)(ln),hn=function(e,t,n){var r=fn(e);return!1===r&&"Network Error"===(null==n?void 0:n.message)?ln:r},dn=n(651),pn=function(){return pn=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},pn.apply(this,arguments)},vn=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},yn=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},bn=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},mn=function(e){var s="function"==typeof Symbol&&Symbol.iterator,t=s&&e[s],i=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},gn={items:[],nextToken:null,startedAt:null},wn=new r.a("DataStore"),_n=function(){function e(e,t,n,r,o,c){void 0===n&&(n={}),this.schema=e,this.syncPredicates=t,this.amplifyConfig=n,this.authModeStrategy=r,this.errorHandler=o,this.modelInstanceCreator=c,this.typeQuery=new WeakMap,this.generateQueries()}return e.prototype.generateQueries=function(){var e=this;Object.values(this.schema.namespaces).forEach((function(t){Object.values(t.models).filter((function(e){return e.syncable})).forEach((function(n){var r=bn(Object(Wt.b)(t,n,"LIST"),1),o=bn(r[0]).slice(1);e.typeQuery.set(n,o)}))}))},e.prototype.graphqlFilterFromPredicate=function(e){if(!this.syncPredicates)return null;var t=Se.a.getPredicates(this.syncPredicates.get(e),!1);return t?Object(Wt.l)(t):null},e.prototype.retrievePage=function(e,t,n,r,filter){return void 0===r&&(r=null),vn(this,void 0,void 0,(function(){var o,c,l,f,h,d,v,y,data,m,w,_,E,S=this;return yn(this,(function(O){switch(O.label){case 0:return o=bn(this.typeQuery.get(e),2),c=o[0],l=o[1],f={limit:r,nextToken:n,lastSync:t,filter:filter},[4,Object(Wt.h)({authModeStrategy:this.authModeStrategy,defaultAuthMode:this.amplifyConfig.aws_appsync_authenticationType,modelName:e.name,schema:this.schema})];case 1:return h=O.sent(),d=h.READ,v=0,y=function(){return vn(S,void 0,void 0,(function(){var t,n,r,o;return yn(this,(function(h){switch(h.label){case 0:return h.trys.push([0,2,,4]),wn.debug("Attempting sync with authMode: "+d[v]),[4,this.jitteredRetry({query:l,variables:f,opName:c,modelDefinition:e,authMode:d[v]})];case 1:return t=h.sent(),wn.debug("Sync successful with authMode: "+d[v]),[2,t];case 2:if(n=h.sent(),++v>=d.length){if(r=d[v-1],wn.debug("Sync failed with authMode: "+r,n),Object(Wt.f)(n)||Object(Wt.g)(n))return wn.warn("User is unauthorized to query "+c+" with auth mode "+r+". No data could be returned."),[2,{data:(o={},o[c]=gn,o)}];throw n}return wn.debug("Sync failed with authMode: "+d[v-1]+". Retrying with authMode: "+d[v]),[4,y()];case 3:return[2,h.sent()];case 4:return[2]}}))}))},[4,y()];case 2:return data=O.sent().data,m=data[c],w=m.items,_=m.nextToken,E=m.startedAt,[2,{nextToken:_,startedAt:E,items:w}]}}))}))},e.prototype.partialDataFeatureFlagEnabled=function(){try{var e=sessionStorage.getItem("datastorePartialData");return Boolean(e)}catch(e){return!1}},e.prototype.jitteredRetry=function(e){var t=e.query,n=e.variables,r=e.opName,o=e.modelDefinition,l=e.authMode;return vn(this,void 0,void 0,(function(){var e=this;return yn(this,(function(f){switch(f.label){case 0:return[4,Object(Zt.c)((function(t,n){return vn(e,void 0,void 0,(function(){var e,f,h,d,v,y=this;return yn(this,(function(m){switch(m.label){case 0:return m.trys.push([0,3,,8]),[4,Object(Wt.i)(l,this.amplifyConfig)];case 1:return e=m.sent(),[4,Xt.a.graphql({query:t,variables:n,authMode:l,authToken:e})];case 2:return[2,m.sent()];case 3:if(f=m.sent(),h=Object(Wt.f)(f)||Object(Wt.g)(f))throw new Zt.a(h);return d=Boolean(f&&f.data&&f.data[r]&&f.data[r].items),this.partialDataFeatureFlagEnabled()?d?((v=f).data[r].items=v.data[r].items.filter((function(e){return null!==e})),f.errors?[4,Promise.all(f.errors.map((function(e){return vn(y,void 0,void 0,(function(){var t;return yn(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.errorHandler({recoverySuggestion:"Ensure app code is up to date, auth directives exist and are correct on each model, and that server-side data has not been invalidated by a schema change. If the problem persists, search for or create an issue: https://github.com/aws-amplify/amplify-js/issues",localModel:null,message:e.message,model:o.name,operation:r,errorType:Object(en.c)(e),process:pe.i.sync,remoteModel:null,cause:e})];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),wn.error("Sync error handler failed with:",t),[3,3];case 3:return[2]}}))}))})))]:[3,5]):[3,6]:[3,7];case 4:m.sent(),c.a.dispatch("datastore",{event:"syncQueriesPartialSyncError",data:{errors:f.errors,modelName:o.name}}),m.label=5;case 5:return[2,v];case 6:throw f;case 7:if(f&&f.errors&&f.errors.some((function(e){return"Unauthorized"===e.errorType})))return v=f,d?v.data[r].items=v.data[r].items.filter((function(e){return null!==e})):v.data[r]=pn(pn({},gn),v.data[r]),wn.warn("queryError","User is unauthorized to query "+r+", some items could not be returned."),[2,v];throw f;case 8:return[2]}}))}))}),[t,n])];case 1:return[2,f.sent()]}}))}))},e.prototype.start=function(e){var t=this,n=!0,r=this.amplifyConfig,o=r.maxRecordsToSync,c=r.syncPageSize,l=new Map,f=new fe.a((function(r){var f=Object.values(t.schema.namespaces).reduce((function(map,t){var n,r;try{for(var o=mn(Array.from(t.modelTopologicalOrdering.keys())),c=o.next();!c.done;c=o.next()){var l=c.value,f=e.get(t.models[l]);map.set(t.models[l],f)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return map}),new Map),h=Array.from(f.entries()).filter((function(e){return bn(e,1)[0].syncable})).map((function(e){var f=bn(e,2),h=f[0],d=bn(f[1],2),v=d[0],y=d[1];return vn(t,void 0,void 0,(function(){var e,t,f,d,m,filter,w,_,E,S=this;return yn(this,(function(O){switch(O.label){case 0:return e=!1,t=null,f=null,d=null,m=0,filter=this.graphqlFilterFromPredicate(h),w=this.schema.namespaces[v].modelTopologicalOrdering.get(h.name),_=w.map((function(e){return l.get(v+"_"+e)})),E=new Promise((function(l){return vn(S,void 0,void 0,(function(){var w,E;return yn(this,(function(S){switch(S.label){case 0:return[4,Promise.all(_)];case 1:S.sent(),S.label=2;case 2:return n?(w=Math.min(o-m,c),[4,this.retrievePage(h,y,t,w,filter)]):[2];case 3:E=S.sent(),d=E.items,t=E.nextToken,f=E.startedAt,m+=d.length,e=null===t||m>=o,r.next({namespace:v,modelDefinition:h,items:d,done:e,startedAt:f,isFullSync:!y}),S.label=4;case 4:if(!e)return[3,2];S.label=5;case 5:return l(),[2]}}))}))})),l.set(v+"_"+h.name,E),[4,E];case 1:return O.sent(),[2]}}))}))}));return Promise.all(h).then((function(){r.complete()})),function(){n=!1}}));return f},e}(),En=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},Sn=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},On=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},Tn=function(e){var s="function"==typeof Symbol&&Symbol.iterator,t=s&&e[s],i=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},In=function(){for(var e=[],i=0;i<arguments.length;i++)e=e.concat(On(arguments[i]));return e},An=Object(o.b)().isNode,Nn=new r.a("DataStore"),Cn=Symbol("sync");!function(e){e.SYNC_ENGINE_STORAGE_SUBSCRIBED="storageSubscribed",e.SYNC_ENGINE_SUBSCRIPTIONS_ESTABLISHED="subscriptionsEstablished",e.SYNC_ENGINE_SYNC_QUERIES_STARTED="syncQueriesStarted",e.SYNC_ENGINE_SYNC_QUERIES_READY="syncQueriesReady",e.SYNC_ENGINE_MODEL_SYNCED="modelSynced",e.SYNC_ENGINE_OUTBOX_MUTATION_ENQUEUED="outboxMutationEnqueued",e.SYNC_ENGINE_OUTBOX_MUTATION_PROCESSED="outboxMutationProcessed",e.SYNC_ENGINE_OUTBOX_STATUS="outboxStatus",e.SYNC_ENGINE_NETWORK_STATUS="networkStatus",e.SYNC_ENGINE_READY="ready"}(ct||(ct={}));var xn=function(){function e(e,t,n,r,o,c,l,f,h,d,v){void 0===d&&(d={}),this.schema=e,this.namespaceResolver=t,this.modelClasses=n,this.userModelClasses=r,this.storage=o,this.modelInstanceCreator=c,this.syncPredicates=h,this.amplifyConfig=d,this.authModeStrategy=v,this.online=!1,this.modelSyncedStatus=new WeakMap;var y=this.modelClasses.MutationEvent;this.outbox=new $t(this.schema,y,c,Cn),this.modelMerger=new Kt(this.outbox,Cn),this.syncQueriesProcessor=new _n(this.schema,this.syncPredicates,this.amplifyConfig,this.authModeStrategy,f),this.subscriptionsProcessor=new dn.b(this.schema,this.syncPredicates,this.amplifyConfig,this.authModeStrategy,f),this.mutationsProcessor=new un(this.schema,this.storage,this.userModelClasses,this.outbox,this.modelInstanceCreator,y,this.amplifyConfig,this.authModeStrategy,f,l),this.datastoreConnectivity=new Ft}return e.prototype.getModelSyncedStatus=function(e){return this.modelSyncedStatus.get(e)},e.prototype.start=function(e){var t=this;return new fe.a((function(n){Nn.log("starting sync engine...");var r=[];return En(t,void 0,void 0,(function(){var t,o,c,l=this;return Sn(this,(function(f){switch(f.label){case 0:return f.trys.push([0,2,,3]),[4,this.setupModels(e)];case 1:return f.sent(),[3,3];case 2:return t=f.sent(),n.error(t),[2];case 3:return o=new Promise((function(e){l.datastoreConnectivity.status().subscribe((function(t){var o=t.online;return En(l,void 0,void 0,(function(){var t,c,l,f,h,d=this;return Sn(this,(function(v){switch(v.label){case 0:return!o||this.online?[3,10]:(this.online=o,n.next({type:ct.SYNC_ENGINE_NETWORK_STATUS,data:{active:this.online}}),c=void 0,An?(Nn.warn("Realtime disabled when in a server-side environment"),[3,6]):[3,1]);case 1:h=On(this.subscriptionsProcessor.start(),2),t=h[0],c=h[1],v.label=2;case 2:return v.trys.push([2,4,,5]),[4,new Promise((function(e,n){var o=t.subscribe({next:function(t){t===dn.a.CONNECTED&&e()},error:function(e){n(e),d.disconnectionHandler()(e)}});r.push(o)}))];case 3:return v.sent(),[3,5];case 4:return l=v.sent(),n.error(l),[2];case 5:Nn.log("Realtime ready"),n.next({type:ct.SYNC_ENGINE_SUBSCRIPTIONS_ESTABLISHED}),v.label=6;case 6:return v.trys.push([6,8,,9]),[4,new Promise((function(e,t){var o=d.syncQueriesObservable().subscribe({next:function(t){t.type===ct.SYNC_ENGINE_SYNC_QUERIES_READY&&e(),n.next(t)},complete:function(){e()},error:function(e){t(e)}});o&&r.push(o)}))];case 7:return v.sent(),[3,9];case 8:return f=v.sent(),n.error(f),[2];case 9:return r.push(this.mutationsProcessor.start().subscribe((function(e){var t=e.modelDefinition,r=e.model,o=e.hasMore,c=d.userModelClasses[t.name],l=d.modelInstanceCreator(c,r);d.storage.runExclusive((function(e){return d.modelMerger.merge(e,l)})),n.next({type:ct.SYNC_ENGINE_OUTBOX_MUTATION_PROCESSED,data:{model:c,element:l}}),n.next({type:ct.SYNC_ENGINE_OUTBOX_STATUS,data:{isEmpty:!o}})}))),An||r.push(c.subscribe((function(e){var t=On(e,3),n=(t[0],t[1]),r=t[2],o=d.userModelClasses[n.name],c=d.modelInstanceCreator(o,r);d.storage.runExclusive((function(e){return d.modelMerger.merge(e,c)}))}))),[3,11];case 10:o||(this.online=o,n.next({type:ct.SYNC_ENGINE_NETWORK_STATUS,data:{active:this.online}}),r.forEach((function(sub){return sub.unsubscribe()})),r=[]),v.label=11;case 11:return e(),[2]}}))}))}))})),this.storage.observe(null,null,Cn).filter((function(e){var t=e.model;return!0===l.getModelDefinition(t).syncable})).subscribe({next:function(e){var t=e.opType,r=e.model,element=e.element,c=e.condition;return En(l,void 0,void 0,(function(){var e,l,f,h;return Sn(this,(function(d){switch(d.label){case 0:return e=this.schema.namespaces[this.namespaceResolver(r)],l=this.modelClasses.MutationEvent,f=Object(Wt.k)(c),h=Object(Wt.d)(e.relationships,this.getModelDefinition(r),t,r,element,f,l,this.modelInstanceCreator),[4,this.outbox.enqueue(this.storage,h)];case 1:return d.sent(),n.next({type:ct.SYNC_ENGINE_OUTBOX_MUTATION_ENQUEUED,data:{model:r,element:element}}),n.next({type:ct.SYNC_ENGINE_OUTBOX_STATUS,data:{isEmpty:!1}}),[4,o];case 2:return d.sent(),this.online&&this.mutationsProcessor.resume(),[2]}}))}))}}),n.next({type:ct.SYNC_ENGINE_STORAGE_SUBSCRIBED}),[4,this.outbox.peek(this.storage)];case 4:return c=void 0===f.sent(),n.next({type:ct.SYNC_ENGINE_OUTBOX_STATUS,data:{isEmpty:c}}),[4,o];case 5:return f.sent(),n.next({type:ct.SYNC_ENGINE_READY}),[2]}}))})),function(){r.forEach((function(sub){return sub.unsubscribe()}))}}))},e.prototype.getModelsMetadataWithNextFullSync=function(e){return En(this,void 0,void 0,(function(){var t,n=this;return Sn(this,(function(r){switch(r.label){case 0:return t=Map.bind,[4,this.getModelsMetadata()];case 1:return[2,new(t.apply(Map,[void 0,r.sent().map((function(t){var r=t.namespace,o=t.model,c=t.lastSync,l=t.lastFullSync,f=t.fullSyncInterval,h=(t.lastSyncPredicate,!l||l+f<e?0:c);return[n.schema.namespaces[r].models[o],[r,h]]}))]))]}}))}))},e.prototype.syncQueriesObservable=function(){var e=this;return this.online?new fe.a((function(t){var n,r;return En(e,void 0,void 0,(function(){var e,o,c=this;return Sn(this,(function(l){switch(l.label){case 0:e=function(){var e,l,f,h,d,v,y,m,w;return Sn(this,(function(_){switch(_.label){case 0:return e=new WeakMap,[4,o.getModelsMetadataWithNextFullSync(Date.now())];case 1:return l=_.sent(),f=new Set(l.keys()),[4,new Promise((function(r){n=c.syncQueriesProcessor.start(l).subscribe({next:function(o){var l=o.namespace,w=o.modelDefinition,_=o.items,E=o.done,S=o.startedAt,O=o.isFullSync;return En(c,void 0,void 0,(function(){var o,c,T,I,A,N,C=this;return Sn(this,(function(x){switch(x.label){case 0:return o=this.userModelClasses[w.name],e.has(o)||(e.set(o,{new:0,updated:0,deleted:0}),v=Object(Ce.j)(),m=void 0===m?S:Math.max(m,S)),[4,this.storage.runExclusive((function(t){return En(C,void 0,void 0,(function(){var n,r,c,l,f,h,d,v,y,m,w,E,S,O,T;return Sn(this,(function(I){switch(I.label){case 0:return[4,this.outbox.getModelIds(t)];case 1:n=I.sent(),r=[],c=_.filter((function(e){return!n.has(e.id)||(r.push(e),!1)})),l=[],I.label=2;case 2:I.trys.push([2,7,8,9]),f=Tn(r),h=f.next(),I.label=3;case 3:return h.done?[3,6]:(d=h.value,[4,this.modelMerger.merge(t,d)]);case 4:void 0!==(v=I.sent())&&l.push([d,v]),I.label=5;case 5:return h=f.next(),[3,3];case 6:return[3,9];case 7:return y=I.sent(),O={error:y},[3,9];case 8:try{h&&!h.done&&(T=f.return)&&T.call(f)}finally{if(O)throw O.error}return[7];case 9:return w=(m=l.push).apply,E=[l],[4,this.modelMerger.mergePage(t,o,c)];case 10:return w.apply(m,E.concat([In.apply(void 0,[I.sent()])])),S=e.get(o),l.forEach((function(e){var t=On(e,2)[1];switch(t){case pe.h.INSERT:S.new++;break;case pe.h.UPDATE:S.updated++;break;case pe.h.DELETE:S.deleted++;break;default:Object(Ce.g)(t)}})),[2]}}))}))}))];case 1:return x.sent(),E?(c=w.name,[4,this.getModelMetadata(l,c)]):[3,4];case 2:return T=x.sent(),I=T.lastFullSync,A=T.fullSyncInterval,d=A,h=void 0===h?I:Math.max(h,O?S:I),T=this.modelClasses.ModelMetadata.copyOf(T,(function(e){e.lastSync=S,e.lastFullSync=O?S:T.lastFullSync})),[4,this.storage.save(T,void 0,Cn)];case 3:x.sent(),N=e.get(o),this.modelSyncedStatus.set(o,!0),t.next({type:ct.SYNC_ENGINE_MODEL_SYNCED,data:{model:o,isFullSync:O,isDeltaSync:!O,counts:N}}),f.delete(w),0===f.size&&(y=Object(Ce.j)()-v,r(),t.next({type:ct.SYNC_ENGINE_SYNC_QUERIES_READY}),n.unsubscribe()),x.label=4;case 4:return[2]}}))}))},error:function(e){t.error(e)}}),t.next({type:ct.SYNC_ENGINE_SYNC_QUERIES_STARTED,data:{models:Array.from(f).map((function(e){return e.name}))}})}))];case 2:return _.sent(),w=h+d-(m+y),Nn.debug("Next fullSync in "+w/1e3+" seconds. ("+new Date(Date.now()+w)+")"),[4,new Promise((function(e){r=setTimeout(e,w)}))];case 3:return _.sent(),[2]}}))},o=this,l.label=1;case 1:return t.closed?[3,3]:[5,e()];case 2:return l.sent(),[3,1];case 3:return[2]}}))})),function(){n&&n.unsubscribe(),r&&clearTimeout(r)}})):fe.a.of()},e.prototype.disconnectionHandler=function(){var e=this;return function(t){Dt.a.CONNECTION_CLOSED!==t&&Dt.a.TIMEOUT_DISCONNECT!==t||e.datastoreConnectivity.socketDisconnected()}},e.prototype.unsubscribeConnectivity=function(){this.datastoreConnectivity.unsubscribe()},e.prototype.setupModels=function(e){return En(this,void 0,void 0,(function(){var t,n,r,o,c,l,f,h,d,v,y,m,w,_=this;return Sn(this,(function(E){switch(E.label){case 0:t=e.fullSyncInterval,n=this.modelClasses.ModelMetadata,r=[],Object.values(this.schema.namespaces).forEach((function(e){Object.values(e.models).filter((function(e){return e.syncable})).forEach((function(t){if(r.push([e.name,t]),e.name===Ce.e){var n=_.userModelClasses[t.name];_.modelSyncedStatus.set(n,!1)}}))})),c=r.map((function(e){var r=On(e,2),c=r[0],l=r[1];return En(_,void 0,void 0,(function(){var e,r,f,h,d,v,y,m,w;return Sn(this,(function(_){switch(_.label){case 0:return[4,this.getModelMetadata(c,l.name)];case 1:return e=_.sent(),r=Se.a.getPredicates(this.syncPredicates.get(l),!1),f=r?JSON.stringify(r):null,void 0!==e?[3,3]:[4,this.storage.save(this.modelInstanceCreator(n,{model:l.name,namespace:c,lastSync:null,fullSyncInterval:t,lastFullSync:null,lastSyncPredicate:f}),void 0,Cn)];case 2:return v=On.apply(void 0,[_.sent(),1]),y=On(v[0],1),o=y[0],[3,5];case 3:return h=e.lastSyncPredicate?e.lastSyncPredicate:null,d=h!==f,[4,this.storage.save(this.modelClasses.ModelMetadata.copyOf(e,(function(e){e.fullSyncInterval=t,d&&(e.lastSync=null,e.lastFullSync=null,e.lastSyncPredicate=f)})))];case 4:m=On.apply(void 0,[_.sent(),1]),w=On(m[0],1),o=w[0],_.label=5;case 5:return[2,o]}}))}))})),l={},E.label=1;case 1:return E.trys.push([1,6,7,8]),[4,Promise.all(c)];case 2:f=Tn.apply(void 0,[E.sent()]),h=f.next(),E.label=3;case 3:if(h.done)return[3,5];d=h.value,v=d.model,l[v]=d,E.label=4;case 4:return h=f.next(),[3,3];case 5:return[3,8];case 6:return y=E.sent(),m={error:y},[3,8];case 7:try{h&&!h.done&&(w=f.return)&&w.call(f)}finally{if(m)throw m.error}return[7];case 8:return[2,l]}}))}))},e.prototype.getModelsMetadata=function(){return En(this,void 0,void 0,(function(){var e;return Sn(this,(function(t){switch(t.label){case 0:return e=this.modelClasses.ModelMetadata,[4,this.storage.query(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.getModelMetadata=function(e,t){return En(this,void 0,void 0,(function(){var n,r,o;return Sn(this,(function(c){switch(c.label){case 0:return n=this.modelClasses.ModelMetadata,r=Se.a.createFromExisting(this.schema.namespaces[Ce.d].models[n.name],(function(n){return n.namespace("eq",e).model("eq",t)})),[4,this.storage.query(n,r,{page:0,limit:1})];case 1:return o=On.apply(void 0,[c.sent(),1]),[2,o[0]]}}))}))},e.prototype.getModelDefinition=function(e){var t=this.namespaceResolver(e);return this.schema.namespaces[t].models[e.name]},e.getNamespace=function(){return{name:Ce.d,relationships:{},enums:{OperationType:{name:"OperationType",values:["CREATE","UPDATE","DELETE"]}},nonModels:{},models:{MutationEvent:{name:"MutationEvent",pluralName:"MutationEvents",syncable:!1,fields:{id:{name:"id",type:"ID",isRequired:!0,isArray:!1},model:{name:"model",type:"String",isRequired:!0,isArray:!1},data:{name:"data",type:"String",isRequired:!0,isArray:!1},modelId:{name:"modelId",type:"String",isRequired:!0,isArray:!1},operation:{name:"operation",type:{enum:"Operationtype"},isArray:!1,isRequired:!0},condition:{name:"condition",type:"String",isArray:!1,isRequired:!0}}},ModelMetadata:{name:"ModelMetadata",pluralName:"ModelsMetadata",syncable:!1,fields:{id:{name:"id",type:"ID",isRequired:!0,isArray:!1},namespace:{name:"namespace",type:"String",isRequired:!0,isArray:!1},model:{name:"model",type:"String",isRequired:!0,isArray:!1},lastSync:{name:"lastSync",type:"Int",isRequired:!1,isArray:!1},lastFullSync:{name:"lastFullSync",type:"Int",isRequired:!1,isArray:!1},fullSyncInterval:{name:"fullSyncInterval",type:"Int",isRequired:!0,isArray:!1},lastSyncPredicate:{name:"lastSyncPredicate",type:"String",isRequired:!1,isArray:!1}}}}}},e}(),kn=function(){return kn=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},kn.apply(this,arguments)},Pn=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},Mn=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},Dn=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t},Rn=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},jn=function(e){var s="function"==typeof Symbol&&Symbol.iterator,t=s&&e[s],i=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},Ln=function(){for(var e=[],i=0;i<arguments.length;i++)e=e.concat(Rn(arguments[i]));return e};ue(!0),W();var Fn,Un,qn,Bn,Gn,Vn=new r.a("DataStore"),Kn=Object(Ce.w)(Date.now()),Wn=o.a.browserOrNode().isNode,zn="schemaVersion",Yn=new WeakMap,Hn=new WeakMap,Jn=function(e){var t=Yn.get(e);return Fn.namespaces[t].models[e.name]},Qn=function(e){return Object(Ce.t)(e)&&Yn.has(e)},$n=function(e){return Yn.get(e)},Xn=function(e){var t;if(void 0!==Fn)return console.warn("The schema has already been initialized"),qn;Vn.log("validating schema",{schema:e});var n=kn({name:Ce.e},e);Vn.log("DataStore","Init models"),qn=er(n),Vn.log("DataStore","Models initialized");var r={name:Ce.a,relationships:{},enums:{},nonModels:{},models:{Setting:{name:"Setting",pluralName:"Settings",syncable:!1,fields:{id:{name:"id",type:"ID",isRequired:!0,isArray:!1},key:{name:"key",type:"String",isRequired:!0,isArray:!1},value:{name:"value",type:"String",isRequired:!0,isArray:!1}}}}},o=Mt.getNamespace(),c=xn.getNamespace();return Bn=er(r),Gn=er(o),Un=er(c),Fn={namespaces:(t={},t[r.name]=r,t[n.name]=n,t[o.name]=o,t[c.name]=c,t),version:e.version},Object.keys(Fn.namespaces).forEach((function(e){var t,n,r=Rn(Object(Ce.f)(Fn.namespaces[e]),2),o=r[0],c=r[1];Fn.namespaces[e].relationships=o,Fn.namespaces[e].keys=c;var l=new Map;Object.values(Fn.namespaces[e].models).forEach((function(e){var t=[];Object.values(e.fields).filter((function(t){return t.association&&"BELONGS_TO"===t.association.connectionType&&t.type.model!==e.name})).forEach((function(e){return t.push(e.type.model)})),l.set(e.name,t)}));for(var f=new Map,h=1e3;h>0&&0!==l.size;){if(0===--h)throw new Error("Models are not topologically sortable. Please verify your schema.");try{for(var d=(t=void 0,jn(Array.from(l.keys()))),v=d.next();!v.done;v=d.next()){var y=v.value,m=l.get(y);m.every((function(e){return f.has(e)}))&&f.set(y,m)}}catch(e){t={error:e}}finally{try{v&&!v.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}Array.from(f.keys()).forEach((function(e){return l.delete(e)}))}Fn.namespaces[e].modelTopologicalOrdering=f})),qn},Zn=function(){if(void 0===Fn){var e="Schema is not initialized. DataStore will not function as expected. This could happen if you have multiple versions of DataStore installed. Please see https://docs.amplify.aws/lib/troubleshooting/upgrading/q/platform/js/#check-for-duplicate-versions";throw Vn.error(e),new Error(e)}},er=function(e){var t={};return Object.entries(e.models).forEach((function(n){var r=Rn(n,2),o=r[0],c=r[1],l=cr(c);t[o]=l,Yn.set(l,e.name)})),Object.entries(e.nonModels||{}).forEach((function(e){var n=Rn(e,2),r=n[0],o=n[1],c=fr(o);t[r]=c})),t},nr=new WeakSet;function rr(e,t){return nr.add(t),new e(t)}var ir,or=function(e){return function(t,n){var r=e.fields[t];if(void 0!==r){var o=r.type,c=r.isRequired,l=r.isArrayNullable,f=r.name,h=r.isArray;if((!h&&c||h&&!l)&&null==n)throw new Error("Field "+f+" is required");if(Object(pe.m)(o)){var d=pe.c.getJSType(o),v=pe.c.getValidationFunction(o);if("AWSJSON"===o){if(typeof n===d)return;if("string"==typeof n)try{return void JSON.parse(n)}catch(e){throw new Error("Field "+f+" is an invalid JSON object. "+n)}}if(h){var y=d;if(c||(y=d+" | null | undefined"),!Array.isArray(n)&&!l)throw new Error("Field "+f+" should be of type ["+y+"], "+typeof n+" received. "+n);if(!Object(Ce.u)(n)&&n.some((function(e){return Object(Ce.u)(e)?c:typeof e!==d}))){var m=n.map((function(e){return null===e?"null":typeof e})).join(",");throw new Error("All elements in the "+f+" array should be of type "+y+", ["+m+"] received. "+n)}if(v&&!Object(Ce.u)(n))if(!n.map((function(e){return Object(Ce.u)(e)?!(!Object(Ce.u)(e)||c):v(e)})).every((function(s){return s})))throw new Error("All elements in the "+f+" array should be of type "+o+", validation failed for one or more elements. "+n)}else{if(!c&&void 0===n)return;if(typeof n!==d&&null!==n)throw new Error("Field "+f+" should be of type "+d+", "+typeof n+" received. "+n);if(!Object(Ce.u)(n)&&v&&!v(n))throw new Error("Field "+f+" should be of type "+o+", validation failed. "+n)}}}}},sr=function(e,t,n){var r=e.fields[t]||{},o=r.isArray,c=r.type;if("string"==typeof n&&(o||"AWSJSON"===c||Object(pe.r)(c)||Object(pe.q)(c)))try{return JSON.parse(n)}catch(e){}return"number"==typeof n&&"Boolean"===c?Boolean(n):n},ar=function(e,t,n){var r=or(t);Object.entries(e).forEach((function(e){var o=Rn(e,2),c=o[0],l=o[1],f=sr(t,c,l);r(c,f),n[c]=f}))},cr=function(e){var t=function(){function n(t){return ce(this,(function(n){ar(t,e,n);var r=nr.has(t)?t:{},o=r.id,c=r._version,l=r._lastChangedAt,f=r._deleted,h=null!=o,d=h?o:e.syncable?Object(le.v4)():Kn();h||ur(n,e),n.id=d,e.syncable&&(n._version=c,n._lastChangedAt=l,n._deleted=f)}))}return n.copyOf=function(source,t){var n,r=Object.getPrototypeOf(source||{}).constructor;if(!Qn(r)){var o="The source object is not a valid model";throw Vn.error(o,{source:source}),new Error(o)}var c=ce(source,(function(n){t(n),n.id=source.id;var r=or(e);Object.entries(n).forEach((function(t){var n=Rn(t,2),o=n[0],c=n[1],l=sr(e,o,c);r(o,l)}))}),(function(p){return n=p}));return n.length&&(Hn.set(c,[n,source]),lr(n,e)),c},n.fromJSON=function(n){var r=this;if(Array.isArray(n))return n.map((function(e){return r.fromJSON(e)}));var o=rr(t,n),c=or(e);return Object.entries(o).forEach((function(e){var t=Rn(e,2),n=t[0],r=t[1];c(n,r)})),o},n}();return t[X]=!0,Object.defineProperty(t,"name",{value:e.name}),t},ur=function(e,t){var n=Object.keys(e),r=t.fields;n.forEach((function(e){if(r[e]&&r[e].isReadOnly)throw new Error(e+" is read-only.")}))},lr=function(e,t){var n=e.map((function(p){return[p.path[0],p.value]})),r=t.fields;n.forEach((function(e){var t=Rn(e,2),n=t[0];if(t[1]&&r[n]&&r[n].isReadOnly)throw new Error(n+" is read-only.")}))},fr=function(e){var t=function(t){return ce(this,(function(n){ar(t,e,n)}))};return t[X]=!0,Object.defineProperty(t,"name",{value:e.name}),Object(Ce.x)(t),t};function dr(e){return"string"==typeof e}function pr(e){var t=e.localModel,n=e.modelConstructor,r=e.remoteModel._version;return rr(n,kn(kn({},t),{_version:r}))}function vr(e){Vn.warn(e)}function yr(e,t){var n;switch(e){case Ce.a:n=Bn[t];break;case Ce.e:n=qn[t];break;case Ce.d:n=Un[t];break;case Ce.c:n=Gn[t];break;default:Object(Ce.g)(e)}if(Qn(n))return n;var r="Model name is not valid for namespace. modelName: "+t+", namespace: "+e;throw Vn.error(r),new Error(r)}function mr(e,t){return Pn(this,void 0,void 0,(function(){var n,r,o=this;return Mn(this,(function(c){switch(c.label){case 0:return n=Bn.Setting,r=Fn.namespaces[Ce.a].models.Setting,[4,e.runExclusive((function(s){return Pn(o,void 0,void 0,(function(){var e,o;return Mn(this,(function(c){switch(c.label){case 0:return[4,s.query(n,Se.a.createFromExisting(r,(function(e){return e.key("eq",zn)})),{page:0,limit:1})];case 1:return e=Rn.apply(void 0,[c.sent(),1]),void 0===(o=e[0])||void 0===o.value?[3,4]:JSON.parse(o.value)===t?[3,3]:[4,s.clear(!1)];case 2:c.sent(),c.label=3;case 3:return[3,6];case 4:return[4,s.save(rr(n,{key:zn,value:JSON.stringify(t)}))];case 5:c.sent(),c.label=6;case 6:return[2]}}))}))}))];case 1:return c.sent(),[2]}}))}))}var gr=new(function(){function e(){var e=this;this.amplifyConfig={},this.syncPredicates=new WeakMap,this.start=function(){return Pn(e,void 0,void 0,(function(){var e,t,n,r=this;return Mn(this,(function(o){switch(o.label){case 0:return void 0!==this.initialized?[3,1]:(Vn.debug("Starting DataStore"),this.initialized=new Promise((function(e,t){r.initResolve=e,r.initReject=t})),[3,3]);case 1:return[4,this.initialized];case 2:return o.sent(),[2];case 3:return this.storage=new Mt(Fn,$n,yr,rr,this.storageAdapter,this.sessionId),[4,this.storage.init()];case 4:return o.sent(),Zn(),[4,mr(this.storage,Fn.version)];case 5:return o.sent(),(e=this.amplifyConfig.aws_appsync_graphqlEndpoint)?(Vn.debug("GraphQL endpoint available",e),t=this,[4,this.processSyncExpressions()]):[3,7];case 6:return t.syncPredicates=o.sent(),this.sync=new xn(Fn,$n,Un,qn,this.storage,rr,this.conflictHandler,this.errorHandler,this.syncPredicates,this.amplifyConfig,this.authModeStrategy),n=1e3*this.fullSyncInterval*60,ir=this.sync.start({fullSyncInterval:n}).subscribe({next:function(e){var t=e.type,data=e.data;t===(Wn?ct.SYNC_ENGINE_SYNC_QUERIES_READY:ct.SYNC_ENGINE_STORAGE_SUBSCRIBED)&&r.initResolve(),c.a.dispatch("datastore",{event:t,data:data})},error:function(e){Vn.warn("Sync error",e),r.initReject()}}),[3,8];case 7:Vn.warn("Data won't be synchronized. No GraphQL endpoint configured. Did you forget `Amplify.configure(awsconfig)`?",{config:this.amplifyConfig}),this.initResolve(),o.label=8;case 8:return[4,this.initialized];case 9:return o.sent(),[2]}}))}))},this.query=function(t,n,r){return Pn(e,void 0,void 0,(function(){var e,o,c,l,f;return Mn(this,(function(h){switch(h.label){case 0:return[4,this.start()];case 1:if(h.sent(),!Qn(t))throw e="Constructor is not for a valid model",Vn.error(e,{modelConstructor:t}),new Error(e);return"string"==typeof n&&void 0!==r&&Vn.warn("Pagination is ignored when querying by id"),o=Jn(t),c=dr(n)?Se.a.createForId(o,n):Object(Se.b)(n)?void 0:Se.a.createFromExisting(o,n),l=this.processPagination(o,r),Vn.debug("params ready",{modelConstructor:t,predicate:Se.a.getPredicates(c,!1),pagination:kn(kn({},l),{sort:Oe.a.getPredicates(l&&l.sort,!1)})}),[4,this.storage.query(t,c,l)];case 2:return f=h.sent(),[2,dr(n)?f[0]:f]}}))}))},this.save=function(t,n){return Pn(e,void 0,void 0,(function(){var e,r,o,c,l,f,h=this;return Mn(this,(function(d){switch(d.label){case 0:return[4,this.start()];case 1:if(d.sent(),e=Hn.get(t),r=t?t.constructor:void 0,!Qn(r))throw o="Object is not an instance of a valid model",Vn.error(o,{model:t}),new Error(o);return c=Jn(r),l=Se.a.createFromExisting(c,n),[4,this.storage.runExclusive((function(s){return Pn(h,void 0,void 0,(function(){return Mn(this,(function(n){switch(n.label){case 0:return[4,s.save(t,l,void 0,e)];case 1:return n.sent(),[2,s.query(r,Se.a.createForId(c,t.id))]}}))}))}))];case 2:return f=Rn.apply(void 0,[d.sent(),1]),[2,f[0]]}}))}))},this.setConflictHandler=function(t){var n=t.DataStore;return n&&n.conflictHandler?n.conflictHandler:e.conflictHandler===pr&&t.conflictHandler?t.conflictHandler:e.conflictHandler||pr},this.setErrorHandler=function(t){var n=t.DataStore;return n&&n.errorHandler?n.errorHandler:e.errorHandler===vr&&t.errorHandler?t.errorHandler:e.errorHandler||vr},this.delete=function(t,n){return Pn(e,void 0,void 0,(function(){var e,r,o,c,l,f,h,d,v;return Mn(this,(function(y){switch(y.label){case 0:return[4,this.start()];case 1:if(y.sent(),!t)throw h="Model or Model Constructor required",Vn.error(h,{modelOrConstructor:t}),new Error(h);if(!Qn(t))return[3,3];if(c=t,!n)throw h="Id to delete or criteria required. Do you want to delete all? Pass Predicates.ALL",Vn.error(h,{idOrCriteria:n}),new Error(h);if("string"==typeof n)e=Se.a.createForId(Jn(c),n);else if(!(e=Se.a.createFromExisting(Jn(c),n))||!Se.a.isValidPredicate(e))throw h="Criteria required. Do you want to delete all? Pass Predicates.ALL",Vn.error(h,{condition:e}),new Error(h);return[4,this.storage.delete(c,e)];case 2:return r=Rn.apply(void 0,[y.sent(),1]),[2,r[0]];case 3:if(o=t,c=Object.getPrototypeOf(o||{}).constructor,!Qn(c))throw h="Object is not an instance of a valid model",Vn.error(h,{model:o}),new Error(h);if(l=Jn(c),f=Se.a.createForId(l,o.id),n){if("function"!=typeof n)throw h="Invalid criteria",Vn.error(h,{idOrCriteria:n}),new Error(h);e=n(f)}else e=f;return[4,this.storage.delete(o,e)];case 4:return d=Rn.apply(void 0,[y.sent(),1]),v=Rn(d[0],1),[2,v[0]]}}))}))},this.observe=function(t,n){var r,o=t&&Qn(t)?t:void 0;if(t&&void 0===o){var c=t,l=c&&Object.getPrototypeOf(c).constructor;if(Qn(l))return n&&Vn.warn("idOrCriteria is ignored when using a model instance",{model:c,idOrCriteria:n}),e.observe(l,c.id);var f="The model is not an instance of a PersistentModelConstructor";throw Vn.error(f,{model:c}),new Error(f)}if(void 0!==n&&void 0===o){f="Cannot provide criteria without a modelConstructor";throw Vn.error(f,n),new Error(f)}if(o&&!Qn(o)){f="Constructor is not for a valid model";throw Vn.error(f,{modelConstructor:o}),new Error(f)}return r="string"==typeof n?Se.a.createForId(Jn(o),n):o&&Se.a.createFromExisting(Jn(o),n),new fe.a((function(t){var n;return Pn(e,void 0,void 0,(function(){return Mn(this,(function(e){switch(e.label){case 0:return[4,this.start()];case 1:return e.sent(),n=this.storage.observe(o,r).filter((function(e){var t=e.model;return $n(t)===Ce.e})).map((function(e){var t=e.opType,n=e.model,r=e.condition,element=e.element;return{opType:t,element:e.savedElement||element,model:n,condition:r}})).subscribe(t),[2]}}))})),function(){n&&n.unsubscribe()}}))},this.observeQuery=function(t,n,r){return new fe.a((function(o){var l,f=new Map,h=new Map,d=[],v=function(){var e=_();E(e)},y=new Ce.b({callback:v,errorHandler:o.error,maxInterval:2e3}),m=(r||{}).sort,w=m?{sort:m}:void 0;Pn(e,void 0,void 0,(function(){var e,r=this;return Mn(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,this.query(t,n,w)];case 1:return c.sent().forEach((function(e){return f.set(e.id,e)})),l=this.observe(t,n).subscribe((function(e){var t,n,element=e.element,o=e.model;"DELETE"===e.opType?d.push(element.id):h.set(element.id,element);var c=null!==(n=null===(t=r.sync)||void 0===t?void 0:t.getModelSyncedStatus(o))&&void 0!==n&&n;(h.size-d.length>=r.syncPageSize||c)&&y.resolve(),y.start()})),v(),[3,3];case 2:return e=c.sent(),o.error(e),[3,3];case 3:return[2]}}))}));var _=function(){var n,o,c=null!==(o=null===(n=e.sync)||void 0===n?void 0:n.getModelSyncedStatus(t))&&void 0!==o&&o,l=Ln(Array.from(f.values()),Array.from(h.values()));return(null==r?void 0:r.sort)&&S(l),f.clear(),l.forEach((function(e){return f.set(e.id,e)})),d.forEach((function(e){return f.delete(e)})),{items:Array.from(f.values()),isSynced:c}},E=function(e){o.next(e),h.clear(),d=[]},S=function(n){var o=Jn(t),c=e.processPagination(o,r),l=Oe.a.getPredicates(c.sort);if(l.length){var f=Object(Ce.y)(l);n.sort(f)}},O=function(e){var n,r=e.payload,o=r.event,data=r.data;o===ct.SYNC_ENGINE_MODEL_SYNCED&&(null===(n=null==data?void 0:data.model)||void 0===n?void 0:n.name)===t.name&&(v(),c.a.remove("api",O))};return c.a.listen("datastore",O),function(){l&&l.unsubscribe()}}))},this.configure=function(t){void 0===t&&(t={});var n=t.DataStore,r=t.authModeStrategyType,o=(t.conflictHandler,t.errorHandler,t.maxRecordsToSync),c=t.syncPageSize,l=t.fullSyncInterval,f=t.syncExpressions,h=t.authProviders,d=t.storageAdapter,v=Dn(t,["DataStore","authModeStrategyType","conflictHandler","errorHandler","maxRecordsToSync","syncPageSize","fullSyncInterval","syncExpressions","authProviders","storageAdapter"]);switch(e.amplifyConfig=kn(kn({},v),e.amplifyConfig),e.conflictHandler=e.setConflictHandler(t),e.errorHandler=e.setErrorHandler(t),n&&n.authModeStrategyType||r||pe.a.DEFAULT){case pe.a.MULTI_AUTH:e.authModeStrategy=_e;break;case pe.a.DEFAULT:default:e.authModeStrategy=Ee}e.amplifyConfig.authProviders=n&&n.authProviders||h,e.syncExpressions=n&&n.syncExpressions||f||e.syncExpressions,e.maxRecordsToSync=n&&n.maxRecordsToSync||o||e.maxRecordsToSync||1e4,e.amplifyConfig.maxRecordsToSync=e.maxRecordsToSync,e.syncPageSize=n&&n.syncPageSize||c||e.syncPageSize||1e3,e.amplifyConfig.syncPageSize=e.syncPageSize,e.fullSyncInterval=n&&n.fullSyncInterval||l||e.fullSyncInterval||1440,e.storageAdapter=n&&n.storageAdapter||d||e.storageAdapter||void 0,e.sessionId=e.retrieveSessionId()},this.clear=function(){return Pn(this,void 0,void 0,(function(){return Mn(this,(function(e){switch(e.label){case 0:return Zn(),void 0!==this.storage?[3,2]:(this.storage=new Mt(Fn,$n,yr,rr,this.storageAdapter,this.sessionId),[4,this.storage.init()]);case 1:e.sent(),e.label=2;case 2:return ir&&!ir.closed&&ir.unsubscribe(),[4,this.storage.clear()];case 3:return e.sent(),this.sync&&this.sync.unsubscribeConnectivity(),this.initialized=void 0,this.storage=void 0,this.sync=void 0,this.syncPredicates=new WeakMap,[2]}}))}))},this.stop=function(){return Pn(this,void 0,void 0,(function(){return Mn(this,(function(e){switch(e.label){case 0:return void 0===this.initialized?[3,2]:[4,this.start()];case 1:e.sent(),e.label=2;case 2:return ir&&!ir.closed&&ir.unsubscribe(),this.sync&&this.sync.unsubscribeConnectivity(),this.initialized=void 0,this.sync=void 0,[2]}}))}))}}return e.prototype.getModuleName=function(){return"DataStore"},e.prototype.processPagination=function(e,t){var n,r=t||{},o=r.limit,c=r.page,l=r.sort;if(void 0!==o||void 0!==c||void 0!==l){if(void 0!==c&&void 0===o)throw new Error("Limit is required when requesting a page");if(void 0!==c){if("number"!=typeof c)throw new Error("Page should be a number");if(c<0)throw new Error("Page can't be negative")}if(void 0!==o){if("number"!=typeof o)throw new Error("Limit should be a number");if(o<0)throw new Error("Limit can't be negative")}return l&&(n=Oe.a.createFromExisting(e,t.sort)),{limit:o,page:c,sort:n}}},e.prototype.processSyncExpressions=function(){return Pn(this,void 0,void 0,(function(){var e,t=this;return Mn(this,(function(n){switch(n.label){case 0:return this.syncExpressions&&this.syncExpressions.length?[4,Promise.all(this.syncExpressions.map((function(e){return Pn(t,void 0,void 0,(function(){var t,n,r,o,c,l;return Mn(this,(function(f){switch(f.label){case 0:return[4,e];case 1:return t=f.sent(),n=t.modelConstructor,r=t.conditionProducer,o=Jn(n),[4,this.unwrapPromise(r)];case 2:return c=f.sent(),Object(Se.b)(c)?[2,[o,null]]:(l=this.createFromCondition(o,c),[2,[o,l]])}}))}))})))]:[2,new WeakMap];case 1:return e=n.sent(),[2,this.weakMapFromEntries(e)]}}))}))},e.prototype.createFromCondition=function(e,t){try{return Se.a.createFromExisting(e,t)}catch(e){throw Vn.error("Error creating Sync Predicate"),e}},e.prototype.unwrapPromise=function(e){return Pn(this,void 0,void 0,(function(){var t;return Mn(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e()];case 1:return[2,n.sent()];case 2:if((t=n.sent())instanceof TypeError)return[2,e];throw t;case 3:return[2]}}))}))},e.prototype.weakMapFromEntries=function(e){return e.reduce((function(map,e){var t=Rn(e,2),n=t[0],r=t[1];if(map.has(n)){var o=n.name;return Vn.warn("You can only utilize one Sync Expression per model.\n          Subsequent sync expressions for the "+o+" model will be ignored."),map}return r&&map.set(n,r),map}),new WeakMap)},e.prototype.retrieveSessionId=function(){try{var e=sessionStorage.getItem("datastoreSessionId");if(e){var t=this.amplifyConfig.aws_appsync_graphqlEndpoint.split("/")[2];return e+"-"+Rn(t.split("."),1)[0]}}catch(e){return}},e}());l.a.register(gr)},484:function(e,t,n){"use strict";n.d(t,"g",(function(){return x})),n.d(t,"u",(function(){return k})),n.d(t,"A",(function(){return P})),n.d(t,"t",(function(){return D})),n.d(t,"x",(function(){return j})),n.d(t,"f",(function(){return F})),n.d(t,"z",(function(){return B})),n.d(t,"h",(function(){return G})),n.d(t,"i",(function(){return V})),n.d(t,"e",(function(){return z})),n.d(t,"d",(function(){return Y})),n.d(t,"c",(function(){return H})),n.d(t,"a",(function(){return W})),n.d(t,"v",(function(){return J})),n.d(t,"w",(function(){return $})),n.d(t,"j",(function(){return X})),n.d(t,"y",(function(){return Z})),n.d(t,"B",(function(){return ee})),n.d(t,"k",(function(){return te})),n.d(t,"q",(function(){return ne})),n.d(t,"l",(function(){return re})),n.d(t,"r",(function(){return ie})),n.d(t,"m",(function(){return oe})),n.d(t,"o",(function(){return se})),n.d(t,"s",(function(){return ae})),n.d(t,"p",(function(){return ce})),n.d(t,"n",(function(){return ue})),n.d(t,"b",(function(){return fe}));var r=n(10);function o(e){var t=new Error(e);return t.source="ulid",t}var c="0123456789ABCDEFGHJKMNPQRSTVWXYZ",l=c.length,f=Math.pow(2,48)-1;function h(e,t,n){return t>e.length-1?e:e.substr(0,t)+n+e.substr(t+1)}function d(e){var t=Math.floor(e()*l);return t===l&&(t=l-1),c.charAt(t)}function v(e,t){if(isNaN(e))throw new Error(e+" must be a number");if(e>f)throw o("cannot encode time greater than "+f);if(e<0)throw o("time must be positive");if(!1===Number.isInteger(e))throw o("time must be an integer");for(var n=void 0,r="";t>0;t--)r=c.charAt(n=e%l)+r,e=(e-n)/l;return r}function y(e,t){for(var n="";e>0;e--)n=d(t)+n;return n}function m(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments[1];t||(t="undefined"!=typeof window?window:null);var r=t&&(t.crypto||t.msCrypto);if(r)return function(){var e=new Uint8Array(1);return r.getRandomValues(e),e[0]/255};try{var c=n(640);return function(){return c.randomBytes(1).readUInt8()/255}}catch(e){}if(e){try{console.error("secure crypto unusable, falling back to insecure Math.random()!")}catch(e){}return function(){return Math.random()}}throw o("secure crypto unusable, insecure Math.random not allowed")}function w(e){e||(e=m());var t=0,n=void 0;return function(r){if(isNaN(r)&&(r=Date.now()),r<=t){var f=n=function(e){for(var t=void 0,n=e.length,r=void 0,f=void 0,d=l-1;!t&&n-- >=0;){if(r=e[n],-1===(f=c.indexOf(r)))throw o("incorrectly encoded string");f!==d?t=h(e,n,c[f+1]):e=h(e,n,c[0])}if("string"==typeof t)return t;throw o("cannot increment this string")}(n);return v(t,10)+f}t=r;var d=n=y(16,e);return v(r,10)+d}}_||(_=m());var _,E=n(605),S=n(187),O=n(27),T=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},I=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},A=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},N=function(){for(var e=[],i=0;i<arguments.length;i++)e=e.concat(A(arguments[i]));return e},C=function(e){var s="function"==typeof Symbol&&Symbol.iterator,t=s&&e[s],i=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},x=function(e,t){if(void 0===t&&(t=!0),t)throw new Error("Invalid "+e)},k=function(e){return void 0===e||null==e},P=function(e,t,n){var r,o=!1;if(0===n.length)return!0;switch(t){case"not":r="every",o=!0;break;case"and":r="every";break;case"or":r="some";break;default:x(t)}var c=n[r]((function(t){if(Object(S.t)(t)){var n=t.field,r=t.operator,o=t.operand,c=e[n];return M(c,r,o)}if(Object(S.s)(t)){var l=t.type,f=t.predicates;return P(e,l,f)}throw new Error("Not a predicate or group")}));return o?!c:c},M=function(e,t,n){switch(t){case"ne":return e!==n;case"eq":return e===n;case"le":return e<=n;case"lt":return e<n;case"ge":return e>=n;case"gt":return e>n;case"between":var r=A(n,2),o=r[0],c=r[1];return e>=o&&e<=c;case"beginsWith":return!k(e)&&e.startsWith(n);case"contains":return!k(e)&&e.indexOf(n)>-1;case"notContains":return k(e)||-1===e.indexOf(n);default:return x(t,!1),!1}},D=function(e){return e&&"function"==typeof e.copyOf},R=new WeakSet;function j(e){R.add(e)}var L,F=function(e){var t={},n={};return Object.keys(e.models).forEach((function(r){var o,c,l,f;t[r]={indexes:[],relationTypes:[]},n[r]={};var h,d,v,y=e.models[r];if(Object.keys(y.fields).forEach((function(e){var n=y.fields[e];if("object"==typeof n.type&&"model"in n.type){var o=n.association.connectionType;t[r].relationTypes.push({fieldName:n.name,modelName:n.type.model,relationType:o,targetName:n.association.targetName,associatedWith:n.association.associatedWith}),"BELONGS_TO"===o&&t[r].indexes.push(n.association.targetName)}})),y.attributes){n[r].compositeKeys=(h=y.attributes,d=function(e){return e.reduce((function(e,t){var n=new Set(t);if(0===e.length)return e.push(n),e;var r=e.findIndex((function(e){return N(e).some((function(e){return n.has(e)}))}));if(r>-1){var o=new Set(N(e[r],n));e[r]=o}else e.push(n);return e}),[])},v=d(h.filter(S.n).map((function(e){return A(e.properties.fields).slice(1)}))),d(v));try{for(var m=C(y.attributes),w=m.next();!w.done;w=m.next()){var _=w.value;if(Object(S.o)(_)){Object(S.p)(_)&&(n[r].primaryKey=_.properties.fields);var E=_.properties.fields;try{for(var O=(l=void 0,C(E)),T=O.next();!T.done;T=O.next()){var I=T.value;t[r].indexes.includes(I)||t[r].indexes.push(I)}}catch(e){l={error:e}}finally{try{T&&!T.done&&(f=O.return)&&f.call(O)}finally{if(l)throw l.error}}}}}catch(e){o={error:e}}finally{try{w&&!w.done&&(c=m.return)&&c.call(m)}finally{if(o)throw o.error}}}})),[t,n]},U=new WeakMap,B=function(e,t,n,r,o){var c=n.relationships,l=o(n.name,e),f=c[e],h=[],d=l.copyOf(t,(function(e){f.relationTypes.forEach((function(c){var l=o(n.name,c.modelName);switch(c.relationType){case"HAS_ONE":if(t[c.fieldName]){var f=void 0;try{f=r(l,t[c.fieldName])}catch(e){console.log(e)}h.push({modelName:c.modelName,item:t[c.fieldName],instance:f}),c.targetName?(e[c.targetName]=e[c.fieldName].id,delete e[c.fieldName]):e[c.fieldName]=e[c.fieldName].id}break;case"BELONGS_TO":if(t[c.fieldName]){f=void 0;try{f=r(l,t[c.fieldName])}catch(e){}e[c.fieldName]._deleted||h.push({modelName:c.modelName,item:t[c.fieldName],instance:f})}e[c.fieldName]&&(e[c.targetName]=e[c.fieldName].id,delete e[c.fieldName]);break;case"HAS_MANY":break;default:x(c.relationType)}}))}));h.unshift({modelName:e,item:d,instance:d}),U.has(n)||U.set(n,Array.from(n.modelTopologicalOrdering.keys()));var v=U.get(n);return h.sort((function(a,b){return v.indexOf(a.modelName)-v.indexOf(b.modelName)})),h},G=function(e,t){var n="";return e.some((function(e){e.modelName===t&&(n=e.targetName)})),n},V=function(e,t){return e.find((function(e){return e===t}))};!function(e){e.DATASTORE="datastore",e.USER="user",e.SYNC="sync",e.STORAGE="storage"}(L||(L={}));var K,W=L.DATASTORE,z=L.USER,Y=L.SYNC,H=L.STORAGE,J=function(){return new Promise((function(e){var t,n=Object(E.v4)(),r=function(){K=!1,e(!0)},o=function(){return T(void 0,void 0,void 0,(function(){return I(this,(function(r){switch(r.label){case 0:return t&&t.result&&"function"==typeof t.result.close?[4,t.result.close()]:[3,2];case 1:r.sent(),r.label=2;case 2:return[4,indexedDB.deleteDatabase(n)];case 3:return r.sent(),K=!0,[2,e(!1)]}}))}))};return!0===K?o():!1===K||null===indexedDB?r():((t=indexedDB.open(n)).onerror=r,void(t.onsuccess=o))}))},Q=function(){return(e=1,r.Buffer.from((new O.j).random(e).toString(),"hex")).readUInt8(0)/255;var e};function $(e){var t=w(Q);return function(){return t(e)}}function X(){return"undefined"!=typeof performance&&performance&&"function"==typeof performance.now?0|performance.now():Date.now()}function Z(e){return function(a,b){var t,n;try{for(var r=C(e),o=r.next();!o.done;o=r.next()){var c=o.value,l=c.field,f=c.sortDirection===S.k.ASCENDING?1:-1;if(a[l]<b[l])return-1*f;if(a[l]>b[l])return 1*f}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return 0}}function ee(e,t,n){var r,o;void 0===n&&(n=!1);var c,l,a=e,b=t;if(a instanceof Object&&!(b instanceof Object)||!(a instanceof Object)&&b instanceof Object)return!1;if(!(a instanceof Object))return!(!n||(c=a,l=b,null!=c||null!=l))||a===b;if(Array.isArray(a)&&!Array.isArray(b)||Array.isArray(b)&&!Array.isArray(a))return!1;a instanceof Set&&b instanceof Set&&(a=N(a),b=N(b)),a instanceof Map&&b instanceof Map&&(a=Object.fromEntries(a),b=Object.fromEntries(b));var f=Object.keys(a),h=Object.keys(b);if(f.length!==h.length&&(!n||Array.isArray(a)))return!1;var d=f.length>=h.length?f:h;try{for(var v=C(d),y=v.next();!y.done;y=v.next()){var m=y.value;if(!ee(a[m],b[m],n))return!1}}catch(e){r={error:e}}finally{try{y&&!y.done&&(o=v.return)&&o.call(v)}finally{if(r)throw r.error}}return!0}var te=function(e){return!!/^\d{4}-\d{2}-\d{2}(Z|[+-]\d{2}:\d{2}($|:\d{2}))?$/.exec(e)},ne=function(e){return!!/^\d{2}:\d{2}(:\d{2}(.\d+)?)?(Z|[+-]\d{2}:\d{2}($|:\d{2}))?$/.exec(e)},re=function(e){return!!/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}(:\d{2}(.\d+)?)?(Z|[+-]\d{2}:\d{2}($|:\d{2}))?$/.exec(e)},ie=function(e){return!!/^\d+$/.exec(String(e))},oe=function(e){return!!/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.exec(e)},se=function(e){try{return JSON.parse(e),!0}catch(e){return!1}},ae=function(e){try{return!!new URL(e)}catch(e){return!1}},ce=function(e){return!!/^\+?\d[\d\s-]+$/.exec(e)},ue=function(e){return!!/((^((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))$)|(^((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?$))$/.exec(e)},le=function(){var e=this;this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))},fe=function(){function e(e){this.limitPromise=new le,this.raceInFlight=!1,this.callback=function(){},this.defaultErrorHandler=function(e){throw void 0===e&&(e="DeferredCallbackResolver error"),new Error(e)},this.callback=e.callback,this.errorHandler=e.errorHandler||this.defaultErrorHandler,this.maxInterval=e.maxInterval||2e3}return e.prototype.startTimer=function(){var e=this;this.timerPromise=new Promise((function(t,n){e.timer=setTimeout((function(){t(S.d.TIMER)}),e.maxInterval)}))},e.prototype.racePromises=function(){return T(this,void 0,void 0,(function(){var e,t;return I(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),this.raceInFlight=!0,this.startTimer(),[4,Promise.race([this.timerPromise,this.limitPromise.promise])];case 1:return e=n.sent(),this.callback(),[3,4];case 2:return t=n.sent(),this.errorHandler(t),[3,4];case 3:return this.clear(),this.raceInFlight=!1,this.limitPromise=new le,[2,e];case 4:return[2]}}))}))},e.prototype.start=function(){this.raceInFlight||this.racePromises()},e.prototype.clear=function(){clearTimeout(this.timer)},e.prototype.resolve=function(){this.limitPromise.resolve(S.d.LIMIT)},e}()},488:function(e,t,n){"use strict";var r=n(648),o=n.n(r).a;t.a=o},511:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return T})),n.d(t,"c",(function(){return I})),n.d(t,"b",(function(){return A})),n.d(t,"d",(function(){return N})),n.d(t,"k",(function(){return C})),n.d(t,"l",(function(){return x})),n.d(t,"j",(function(){return k})),n.d(t,"h",(function(){return P})),n.d(t,"g",(function(){return M})),n.d(t,"f",(function(){return D})),n.d(t,"i",(function(){return R}));var r,o,c=n(6),l=n(609),f=n(59),h=n(187),d=n(484),v=function(){return v=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},v.apply(this,arguments)},y=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},m=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},w=new f.a("DataStore");!function(e){e.LIST="query",e.CREATE="mutation",e.UPDATE="mutation",e.DELETE="mutation",e.GET="query"}(r||(r={})),function(e){e.CREATE="Create",e.UPDATE="Update",e.DELETE="Delete",e.GET="Get"}(o||(o={}));var _={_version:void 0,_lastChangedAt:void 0,_deleted:void 0},E=Object.keys(_);function S(e,t){var n=O(t),r=function(e,t){var n=[];return Object.values(t.fields).forEach((function(t){var r=t.name,o=t.type;if(Object(h.r)(o)){var c=e.nonModels[o.nonModel],l=Object.values(O(c)).map((function(e){return e.name})),f=[];Object.values(c.fields).forEach((function(t){var n=t.type,r=t.name;if(Object(h.r)(n)){var o=e.nonModels[n.nonModel];f.push(r+" { "+S(e,o)+" }")}})),n.push(r+" { "+l.join(" ")+" "+f.join(" ")+" }")}})),n}(e,t),o=function(e,t){var n=function(e){var t=[];Object(h.u)(e)&&e.attributes&&e.attributes.forEach((function(e){if(e.properties&&e.properties.rules){var n=e.properties.rules.find((function(e){return"owner"===e.allow}));n&&n.ownerField&&t.push(n.ownerField)}}));return t}(e);if(!t.owner&&n.includes("owner"))return["owner"];return[]}(t,n),c=Object.values(n).map((function(e){return e.name})).concat(o).concat(r);return Object(h.u)(t)&&(c=c.concat(E).concat(function(e){var t=[];return Object.values(e.fields).filter((function(e){var t=e.association;return t&&Object.keys(t).length})).forEach((function(e){var n=e.name,r=e.association,o=r.connectionType;switch(o){case"HAS_ONE":case"HAS_MANY":break;case"BELONGS_TO":Object(h.v)(r)&&t.push(n+" { id _deleted }");break;default:Object(d.g)(o)}})),t}(t))),c.join("\n")}function O(e){var t=e.fields;return Object.values(t).filter((function(e){return!(!Object(h.m)(e.type)&&!Object(h.l)(e.type))})).reduce((function(e,t){return e[t.name]=t,e}),{})}function T(e){var t=([].concat(e.attributes).find((function(e){return e&&"auth"===e.type}))||{}).properties,n=(void 0===t?{}:t).rules,r=[];return(void 0===n?[]:n).forEach((function(t){var n=t.identityClaim,o=void 0===n?"cognito:username":n,c=t.ownerField,l=void 0===c?"owner":c,f=t.operations,h=void 0===f?["create","update","delete","read"]:f,d=t.provider,v=void 0===d?"userPools":d,y=t.groupClaim,m=void 0===y?"cognito:groups":y,w=t.allow,_=void 0===w?"iam":w,E=t.groups,S=void 0===E?[]:E,O="owner"===_;if(h.includes("read")||O){var T={identityClaim:o,ownerField:l,provider:v,groupClaim:m,authStrategy:_,groups:S,areSubscriptionsPublic:!1};if(O){var I=([].concat(e.attributes).find((function(e){return e&&"model"===e.type}))||{}).properties,A=(void 0===I?{}:I).subscriptions,N=(void 0===A?{}:A).level,C=void 0===N?"on":N;T.areSubscriptionsPublic=!h.includes("read")||"public"===C}O?r.push(T):r.unshift(T)}})),r}function I(e,t,n,r,o){var c=S(e,t),l=t.name,f=(t.pluralName,"on"+n+l),h="",d="";return r&&(h="($"+o+": String!)",d="("+o+": $"+o+")"),[n,f,"subscription operation"+h+"{\n\t\t\t"+f+d+"{\n\t\t\t\t"+c+"\n\t\t\t}\n\t\t}"]}function A(e,t,n){var c,l,f=S(e,t),h=t.name,v=t.pluralName,y=" ",m=" ";switch(n){case"LIST":c="sync"+v,y="($limit: Int, $nextToken: String, $lastSync: AWSTimestamp, $filter: Model"+h+"FilterInput)",m="(limit: $limit, nextToken: $nextToken, lastSync: $lastSync, filter: $filter)",f="items {\n\t\t\t\t\t\t\t"+f+"\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnextToken\n\t\t\t\t\t\tstartedAt";break;case"CREATE":c="create"+h,y="($input: Create"+h+"Input!)",m="(input: $input)",l=o.CREATE;break;case"UPDATE":c="update"+h,y="($input: Update"+h+"Input!, $condition: Model"+h+"ConditionInput)",m="(input: $input, condition: $condition)",l=o.UPDATE;break;case"DELETE":c="delete"+h,y="($input: Delete"+h+"Input!, $condition: Model"+h+"ConditionInput)",m="(input: $input, condition: $condition)",l=o.DELETE;break;case"GET":c="get"+h,y="($id: ID!)",m="(id: $id)",l=o.GET;break;default:Object(d.g)(n)}return[[l,c,r[n]+" operation"+y+"{\n\t\t"+c+m+"{\n\t\t\t"+f+"\n\t\t}\n\t}"]]}function N(e,t,n,r,element,c,l,f,y){var m;switch(n){case h.h.INSERT:m=o.CREATE;break;case h.h.UPDATE:m=o.UPDATE;break;case h.h.DELETE:m=o.DELETE;break;default:Object(d.g)(n)}return f(l,v(v({},y?{id:y}:{}),{data:JSON.stringify(element,(function(e,n){return e&&null!==n&&"object"==typeof n&&t.fields[e]&&"AWSJSON"===t.fields[e].type?JSON.stringify(n):n})),modelId:element.id,model:r.name,operation:m,condition:JSON.stringify(c)}))}function C(e){var t={};return e&&Array.isArray(e.predicates)?(e.predicates.forEach((function(p){var e;if(Object(h.t)(p)){var n=p.field,r=p.operator,o=p.operand;if("id"===n)return;t[n]=((e={})[r]=o,e)}else t[p.type]=C(p)})),t):t}function x(e){var t={};if(!e||!Array.isArray(e.predicates))return t;var n=e.type,r=e.predicates,o="and"===n||"or"===n;t[n]=o?[]:{};var c=function(e){return o?t[n].push(e):t[n]=e};return r.forEach((function(e){var t,n;if(Object(h.t)(e)){var r=e.field,o=e.operator,l=e.operand,f=((t={})[r]=((n={})[o]=l,n),t);c(f)}else c(x(e))})),t}function k(e,t){var n=e[t.groupClaim]||[];if("string"==typeof n){var r=void 0;try{r=JSON.parse(n)}catch(e){r=n}n=[].concat(r)}return n}function P(e){var t=e.authModeStrategy,n=e.defaultAuthMode,r=e.modelName,o=e.schema;return y(this,void 0,void 0,(function(){var e,c,l,f=this;return m(this,(function(d){switch(d.label){case 0:e=Object.values(h.g),c={CREATE:[],READ:[],UPDATE:[],DELETE:[]},d.label=1;case 1:return d.trys.push([1,3,,4]),[4,Promise.all(e.map((function(e){return y(f,void 0,void 0,(function(){var l;return m(this,(function(f){switch(f.label){case 0:return[4,t({schema:o,modelName:r,operation:e})];case 1:return"string"==typeof(l=f.sent())?c[e]=[l]:Array.isArray(l)&&l.length?c[e]=l:c[e]=[n],[2]}}))}))})))];case 2:return d.sent(),[3,4];case 3:return l=d.sent(),w.debug("Error getting auth modes for model: "+r,l),[3,4];case 4:return[2,c]}}))}))}function M(e){var t,n=["Request failed with status code 401","Request failed with status code 403"];return e&&e.errors?t=e.errors.find((function(e){return n.includes(e.message)})):e&&e.message&&(t=e),t?t.message:null}function D(e){var t=Object.values(l.a);return e&&e.message&&t.find((function(t){return e.message.includes(t)}))||null}function R(e,t){return void 0===t&&(t={}),y(this,void 0,void 0,(function(){var n,r,o;return m(this,(function(l){switch(l.label){case 0:if(e!==c.c.AWS_LAMBDA)return[3,6];if(n=t.authProviders,!(r=(void 0===n?{functionAuthProvider:null}:n).functionAuthProvider)||"function"!=typeof r)return[3,5];l.label=1;case 1:return l.trys.push([1,3,,4]),[4,r()];case 2:return[2,l.sent().token];case 3:throw o=l.sent(),new Error("Error retrieving token from `functionAuthProvider`: "+o);case 4:return[3,6];case 5:throw new Error("You must provide a `functionAuthProvider` function to `DataStore.configure` when using "+c.c.AWS_LAMBDA);case 6:return[2]}}))}))}},544:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l}));var r="undefined"!=typeof Symbol&&"function"==typeof Symbol.for,o=r?Symbol.for("INTERNAL_AWS_APPSYNC_PUBSUB_PROVIDER"):"@@INTERNAL_AWS_APPSYNC_PUBSUB_PROVIDER",c=r?Symbol.for("INTERNAL_AWS_APPSYNC_REALTIME_PUBSUB_PROVIDER"):"@@INTERNAL_AWS_APPSYNC_REALTIME_PUBSUB_PROVIDER",l="x-amz-user-agent"},546:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return y}));var r=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},o=function(){for(var e=[],i=0;i<arguments.length;i++)e=e.concat(r(arguments[i]));return e},c=function(e){var s="function"==typeof Symbol&&Symbol.iterator,t=s&&e[s],i=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},l={BadRecord:function(e){return/^Cannot return \w+ for [\w-_]+ type/.test(e.message)},ConfigError:function(){return!1},Transient:function(){return!1},Unauthorized:function(){return!1}},f={BadRecord:function(){return!1},ConfigError:function(){return!1},Transient:function(){return!1},Unauthorized:function(e){var t=e.error,n=r((void 0===t?{errors:[]}:t).errors,1)[0],o=(void 0===n?{}:n).message;return/Connection failed.+Unauthorized/.test(void 0===o?"":o)}},h={BadRecord:function(e){return/^Cannot return \w+ for [\w-_]+ type/.test(e.message)},ConfigError:function(){return!1},Transient:function(){return!1},Unauthorized:function(){return!1}};function d(e){return m(l,e)}function v(e){return m(f,e)}function y(e){return m(h,e)}function m(e,t){var n,r,l=o(Object.keys(e));try{for(var f=c(l),h=f.next();!h.done;h=f.next()){var d=h.value;if((0,e[d])(t))return d}}catch(e){n={error:e}}finally{try{h&&!h.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}return"Unknown"}},605:function(e,t,n){var r=n(638),o=n(639),c=o;c.v1=r,c.v4=o,e.exports=c},606:function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var o=new Array(16);e.exports=function(){for(var e,i=0;i<16;i++)0==(3&i)&&(e=4294967296*Math.random()),o[i]=e>>>((3&i)<<3)&255;return o}}},607:function(e,t){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var i=t||0,r=n;return[r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]]].join("")}},608:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.createPredicateBuilder=function(t){var n=t.name,r=new Set(Object.keys(t.fields)),o=new Proxy({},{get:function(t,o,c){var l=o;if(!r.has(l))throw new Error("Invalid field for model. field: "+l+", model: "+n);return function(t){return e.sortPredicateGroupsMap.get(c).push({field:l,sortDirection:t}),c}}});return e.sortPredicateGroupsMap.set(o,[]),o},e.isValidPredicate=function(t){return e.sortPredicateGroupsMap.has(t)},e.getPredicates=function(t,n){if(void 0===n&&(n=!0),n&&!e.isValidPredicate(t))throw new Error("The predicate is not valid");return e.sortPredicateGroupsMap.get(t)},e.createFromExisting=function(t,n){if(n&&t)return n(e.createPredicateBuilder(t))},e.sortPredicateGroupsMap=new WeakMap,e}()},609:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.NO_API_KEY="No api-key configured",e.NO_CURRENT_USER="No current user",e.NO_CREDENTIALS="No credentials",e.NO_FEDERATED_JWT="No federated jwt",e.NO_AUTH_TOKEN="No auth token specified"}(r||(r={}))},610:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BLOCK_SIZE=64,t.DIGEST_LENGTH=32,t.KEY=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),t.INIT=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],t.MAX_HASHABLE_LENGTH=Math.pow(2,53)-1},611:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));"function"==typeof Symbol&&null!=Symbol.iterator&&Symbol.iterator,"function"==typeof Symbol&&null!=Symbol.asyncIterator&&Symbol.asyncIterator;var r="function"==typeof Symbol&&null!=Symbol.toStringTag?Symbol.toStringTag:"@@toStringTag"},638:function(e,t,n){var r,o,c=n(606),l=n(607),f=0,h=0;e.exports=function(e,t,n){var i=t&&n||0,b=t||[],d=(e=e||{}).node||r,v=void 0!==e.clockseq?e.clockseq:o;if(null==d||null==v){var y=c();null==d&&(d=r=[1|y[0],y[1],y[2],y[3],y[4],y[5]]),null==v&&(v=o=16383&(y[6]<<8|y[7]))}var m=void 0!==e.msecs?e.msecs:(new Date).getTime(),w=void 0!==e.nsecs?e.nsecs:h+1,dt=m-f+(w-h)/1e4;if(dt<0&&void 0===e.clockseq&&(v=v+1&16383),(dt<0||m>f)&&void 0===e.nsecs&&(w=0),w>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");f=m,h=w,o=v;var _=(1e4*(268435455&(m+=122192928e5))+w)%4294967296;b[i++]=_>>>24&255,b[i++]=_>>>16&255,b[i++]=_>>>8&255,b[i++]=255&_;var E=m/4294967296*1e4&268435455;b[i++]=E>>>8&255,b[i++]=255&E,b[i++]=E>>>24&15|16,b[i++]=E>>>16&255,b[i++]=v>>>8|128,b[i++]=255&v;for(var S=0;S<6;++S)b[i+S]=d[S];return t||l(b)}},639:function(e,t,n){var r=n(606),o=n(607);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var c=(e=e||{}).random||(e.rng||r)();if(c[6]=15&c[6]|64,c[8]=63&c[8]|128,t)for(var l=0;l<16;++l)t[i+l]=c[l];return t||o(c)}},640:function(e,t){},641:function(e,t,n){"use strict";var r,o,c=n(642);function l(p,e,t){if(p._observer)f(p._observer,e,t);else if(p._observers){var n=[];p._observers.forEach((function(e){n.push(e)})),n.forEach((function(n){f(n,e,t)}))}}function f(e,t,n){if(!e.closed)switch(t){case"next":return e.next(n);case"error":return e.error(n);case"complete":return e.complete(n)}}function h(p){return p._observer||p._observers&&p._observers.size>0}function d(e){var p=this;this._observer=null,this._observers=null,this._observable=new c((function(t){return function(p,e){!h(p)&&e&&e.start&&e.start()}(p,e),function(p,e){p._observers?p._observers.add(e):p._observer?(p._observers=new Set,p._observers.add(p._observer),p._observers.add(e),p._observer=null):p._observer=e}(p,t),function(){!function(p,e){p._observers?p._observers.delete(e):p._observer===e&&(p._observer=null)}(p,t),function(p,e){!h(p)&&e&&e.pause&&e.pause()}(p,e)}}))}r=d.prototype,o={get observable(){return this._observable},get observed(){return h(this)},next:function(e){l(this,"next",e)},error:function(e){l(this,"error",e)},complete:function(e){l(this,"complete",e)}},Object.keys(o).forEach((function(e){var desc=Object.getOwnPropertyDescriptor(o,e);desc.enumerable=!1,Object.defineProperty(r,e,desc)})),e.exports=d},642:function(e,t,n){e.exports=n(643).Observable},643:function(e,t,n){"use strict";(function(e){!function(e,t){function n(e){return"function"==typeof Symbol&&Boolean(Symbol[e])}function r(e){return n(e)?Symbol[e]:"@@"+e}function o(e){setTimeout((function(){throw e}))}function c(e,t){var n=e[t];if(null!=n){if("function"!=typeof n)throw new TypeError(n+" is not a function");return n}}function l(e){var t=e.constructor;return void 0!==t&&null===(t=t[r("species")])&&(t=void 0),void 0!==t?t:_}function f(e,t){Object.keys(t).forEach((function(n){var desc=Object.getOwnPropertyDescriptor(t,n);desc.enumerable=!1,Object.defineProperty(e,n,desc)}))}function h(e){var t=e._cleanup;if(t){e._cleanup=void 0;try{t()}catch(e){o(e)}}}function d(e){return void 0===e._observer}function v(e){d(e)||(e._observer=void 0,h(e))}function y(e){return function(){e.unsubscribe()}}function m(e,t){if(Object(e)!==e)throw new TypeError("Observer must be an object");this._cleanup=void 0,this._observer=e;try{var n=c(e,"start");n&&n.call(e,this)}catch(e){o(e)}if(!d(this)){e=new w(this);try{var r=t.call(void 0,e);if(null!=r){if("function"==typeof r.unsubscribe)r=y(r);else if("function"!=typeof r)throw new TypeError(r+" is not a function");this._cleanup=r}}catch(t){return void e.error(t)}d(this)&&h(this)}}function w(e){this._subscription=e}function _(e){if(!(this instanceof _))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof e)throw new TypeError("Observable initializer must be a function");this._subscriber=e}"function"!=typeof Symbol||Symbol.observable||(Symbol.observable=Symbol("observable")),f(m.prototype={},{get closed(){return d(this)},unsubscribe:function(){v(this)}}),f(w.prototype={},{get closed(){return d(this._subscription)},next:function(e){var t=this._subscription;if(!d(t)){var n=t._observer;try{var r=c(n,"next");r&&r.call(n,e)}catch(e){o(e)}}},error:function(e){var t=this._subscription;if(d(t))o(e);else{var n=t._observer;t._observer=void 0;try{var r=c(n,"error");if(!r)throw e;r.call(n,e)}catch(e){o(e)}h(t)}},complete:function(){var e=this._subscription;if(!d(e)){var t=e._observer;e._observer=void 0;try{var n=c(t,"complete");n&&n.call(t)}catch(e){o(e)}h(e)}}}),f(_.prototype,{subscribe:function(e){for(var t=[],n=1;n<arguments.length;++n)t.push(arguments[n]);return"function"==typeof e?e={next:e,error:t[0],complete:t[1]}:"object"==typeof e&&null!==e||(e={}),new m(e,this._subscriber)},forEach:function(e){var t=this;return new Promise((function(n,r){if("function"!=typeof e)return Promise.reject(new TypeError(e+" is not a function"));t.subscribe({_subscription:null,start:function(e){if(Object(e)!==e)throw new TypeError(e+" is not an object");this._subscription=e},next:function(t){var n=this._subscription;if(!n.closed)try{e(t)}catch(e){r(e),n.unsubscribe()}},error:r,complete:n})}))},map:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(l(this))((function(n){return t.subscribe({next:function(t){if(!n.closed){try{t=e(t)}catch(e){return n.error(e)}n.next(t)}},error:function(e){n.error(e)},complete:function(){n.complete()}})}))},filter:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(l(this))((function(n){return t.subscribe({next:function(t){if(!n.closed){try{if(!e(t))return}catch(e){return n.error(e)}n.next(t)}},error:function(e){n.error(e)},complete:function(){n.complete()}})}))},reduce:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var n=l(this),r=arguments.length>1,o=!1,c=arguments[1];return new n((function(n){return t.subscribe({next:function(t){if(!n.closed){var l=!o;if(o=!0,!l||r)try{c=e(c,t)}catch(e){return n.error(e)}else c=t}},error:function(e){n.error(e)},complete:function(){if(!o&&!r)return n.error(new TypeError("Cannot reduce an empty sequence"));n.next(c),n.complete()}})}))}}),Object.defineProperty(_.prototype,r("observable"),{value:function(){return this},writable:!0,configurable:!0}),f(_,{from:function(e){var t="function"==typeof this?this:_;if(null==e)throw new TypeError(e+" is not an object");var o=c(e,r("observable"));if(o){var l=o.call(e);if(Object(l)!==l)throw new TypeError(l+" is not an object");return l.constructor===t?l:new t((function(e){return l.subscribe(e)}))}if(n("iterator")&&(o=c(e,r("iterator"))))return new t((function(t){for(var n,r=o.call(e)[Symbol.iterator]();!(n=r.next()).done;){var c=n.value;if(t.next(c),t.closed)return}t.complete()}));if(Array.isArray(e))return new t((function(t){for(var n=0;n<e.length;++n)if(t.next(e[n]),t.closed)return;t.complete()}));throw new TypeError(e+" is not observable")},of:function(){for(var e=[],t=0;t<arguments.length;++t)e.push(arguments[t]);return new("function"==typeof this?this:_)((function(t){for(var n=0;n<e.length;++n)if(t.next(e[n]),t.closed)return;t.complete()}))}}),Object.defineProperty(_,r("species"),{get:function(){return this},configurable:!0}),Object.defineProperty(_,"extensions",{value:{observableSymbol:r("observable"),setHostReportError:function(e){o=e}}}),e.Observable=_}(t)}).call(this,n(281)(e))},644:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r=n(59),o=n(415),c=n(117),l=n(687),f=n(414),h=n(24),d=n.n(h),v=n(44),y=function(){return y=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},y.apply(this,arguments)},m=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},w=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},_=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t},E=new r.a("RestClient"),S=function(){function e(e){this._region="us-east-1",this._service="execute-api",this._custom_header=void 0,this._cancelTokenMap=null,this.Credentials=o.a,this._options=e,E.debug("API Options",this._options),null==this._cancelTokenMap&&(this._cancelTokenMap=new WeakMap)}return e.prototype.ajax=function(e,t,n){return m(this,void 0,void 0,(function(){var r,o,f,h,d,m,S,O,T,I,A,N,C,x,k=this;return w(this,(function(w){switch(w.label){case 0:return E.debug(t,e),f="us-east-1",h="execute-api",d=void 0,"string"==typeof e?(r=this._parseUrl(e),o=e):(o=e.endpoint,d=e.custom_header,f=e.region,h=e.service,r=this._parseUrl(e.endpoint)),m={method:t,url:o,host:r.host,path:r.path,headers:{},data:null,responseType:"json",timeout:0,cancelToken:null},S={},c.a.isReactNative&&(O=c.a.userAgent||"aws-amplify/0.1.x",S={"User-Agent":O}),T=Object.assign({},n),I=T.response,T.body&&("function"==typeof FormData&&T.body instanceof FormData?(S["Content-Type"]="multipart/form-data",m.data=T.body):(S["Content-Type"]="application/json; charset=UTF-8",m.data=JSON.stringify(T.body))),T.responseType&&(m.responseType=T.responseType),T.withCredentials&&(m.withCredentials=T.withCredentials),T.timeout&&(m.timeout=T.timeout),T.cancellableToken&&(m.cancelToken=T.cancellableToken.token),m.signerServiceInfo=T.signerServiceInfo,"function"!=typeof d?[3,2]:[4,d()];case 1:return N=w.sent(),[3,3];case 2:N=void 0,w.label=3;case 3:return A=N,m.headers=y(y(y({},S),A),T.headers),C=Object(v.parse)(o,!0,!0),C.search,x=_(C,["search"]),m.url=Object(v.format)(y(y({},x),{query:y(y({},x.query),T.queryStringParameters||{})})),void 0!==m.headers.Authorization?(m.headers=Object.keys(m.headers).reduce((function(e,t){return m.headers[t]&&(e[t]=m.headers[t]),e}),{}),[2,this._request(m,I)]):[2,this.Credentials.get().then((function(r){return k._signed(y({},m),r,I,{region:f,service:h}).catch((function(r){if(l.a.isClockSkewError(r)){var o=r.response.headers,c=o&&(o.date||o.Date),f=new Date(c),h=l.a.getDateFromHeaderString(m.headers["x-amz-date"]);if(l.a.isClockSkewed(f))return l.a.setClockOffset(f.getTime()-h.getTime()),k.ajax(e,t,n)}throw r}))}),(function(e){return E.debug("No credentials available, the request will be unsigned"),k._request(m,I)}))]}}))}))},e.prototype.get=function(e,t){return this.ajax(e,"GET",t)},e.prototype.put=function(e,t){return this.ajax(e,"PUT",t)},e.prototype.patch=function(e,t){return this.ajax(e,"PATCH",t)},e.prototype.post=function(e,t){return this.ajax(e,"POST",t)},e.prototype.del=function(e,t){return this.ajax(e,"DELETE",t)},e.prototype.head=function(e,t){return this.ajax(e,"HEAD",t)},e.prototype.cancel=function(e,t){var source=this._cancelTokenMap.get(e);return!!source&&(source.cancel(t),!0)},e.prototype.hasCancelToken=function(e){return this._cancelTokenMap.has(e)},e.prototype.isCancel=function(e){return d.a.isCancel(e)},e.prototype.getCancellableToken=function(){return d.a.CancelToken.source()},e.prototype.updateRequestToBeCancellable=function(e,t){this._cancelTokenMap.set(e,t)},e.prototype.endpoint=function(e){var t=this,n=this._options.endpoints,r="";return Array.isArray(n)?(n.forEach((function(n){n.name===e&&(r=n.endpoint,"string"==typeof n.region?t._region=n.region:"string"==typeof t._options.region&&(t._region=t._options.region),"string"==typeof n.service?t._service=n.service||"execute-api":t._service="execute-api","function"==typeof n.custom_header?t._custom_header=n.custom_header:t._custom_header=void 0)})),r):r},e.prototype._signed=function(e,t,n,r){var o=r.service,c=r.region,l=e.signerServiceInfo,h=_(e,["signerServiceInfo"]),v=c||this._region||this._options.region,y=o||this._service||this._options.service,m={secret_key:t.secretAccessKey,access_key:t.accessKeyId,session_token:t.sessionToken},w={region:v,service:y},S=Object.assign(w,l),O=f.a.sign(h,m,S);return O.data&&(O.body=O.data),E.debug("Signed Request: ",O),delete O.headers.host,d()(O).then((function(e){return n?e:e.data})).catch((function(e){throw E.debug(e),e}))},e.prototype._request=function(e,t){return void 0===t&&(t=!1),d()(e).then((function(e){return t?e:e.data})).catch((function(e){throw E.debug(e),e}))},e.prototype._parseUrl=function(e){var t=e.split("/");return{host:t[2],path:"/"+t.slice(3).join("/")}},e}()},645:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(0).__exportStar(n(646),t)},646:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(610),c=n(647),l=n(676),f=function(){function e(e){if(this.hash=new c.RawSha256,e){this.outer=new c.RawSha256;var t=function(e){var input=h(e);if(input.byteLength>o.BLOCK_SIZE){var t=new c.RawSha256;t.update(input),input=t.digest()}var n=new Uint8Array(o.BLOCK_SIZE);return n.set(input),n}(e),n=new Uint8Array(o.BLOCK_SIZE);n.set(t);for(var i=0;i<o.BLOCK_SIZE;i++)t[i]^=54,n[i]^=92;this.hash.update(t),this.outer.update(n);for(i=0;i<t.byteLength;i++)t[i]=0}}return e.prototype.update=function(e){if(!function(data){if("string"==typeof data)return 0===data.length;return 0===data.byteLength}(e)&&!this.error)try{this.hash.update(h(e))}catch(e){this.error=e}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){return[2,this.digestSync()]}))}))},e}();function h(data){return"string"==typeof data?l.fromUtf8(data):ArrayBuffer.isView(data)?new Uint8Array(data.buffer,data.byteOffset,data.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(data)}t.Sha256=f},647:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(610),o=function(){function e(){this.state=Int32Array.from(r.INIT),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(data){if(this.finished)throw new Error("Attempted to update an already finished hash.");var e=0,t=data.byteLength;if(this.bytesHashed+=t,8*this.bytesHashed>r.MAX_HASHABLE_LENGTH)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;t>0;)this.buffer[this.bufferLength++]=data[e++],t--,this.bufferLength===r.BLOCK_SIZE&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var e=8*this.bytesHashed,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(t.setUint8(this.bufferLength++,128),n%r.BLOCK_SIZE>=r.BLOCK_SIZE-8){for(var i=this.bufferLength;i<r.BLOCK_SIZE;i++)t.setUint8(i,0);this.hashBuffer(),this.bufferLength=0}for(i=this.bufferLength;i<r.BLOCK_SIZE-8;i++)t.setUint8(i,0);t.setUint32(r.BLOCK_SIZE-8,Math.floor(e/4294967296),!0),t.setUint32(r.BLOCK_SIZE-4,e),this.hashBuffer(),this.finished=!0}var o=new Uint8Array(r.DIGEST_LENGTH);for(i=0;i<8;i++)o[4*i]=this.state[i]>>>24&255,o[4*i+1]=this.state[i]>>>16&255,o[4*i+2]=this.state[i]>>>8&255,o[4*i+3]=this.state[i]>>>0&255;return o},e.prototype.hashBuffer=function(){for(var e=this.buffer,t=this.state,n=t[0],o=t[1],c=t[2],l=t[3],f=t[4],h=t[5],d=t[6],v=t[7],i=0;i<r.BLOCK_SIZE;i++){if(i<16)this.temp[i]=(255&e[4*i])<<24|(255&e[4*i+1])<<16|(255&e[4*i+2])<<8|255&e[4*i+3];else{var u=this.temp[i-2],y=(u>>>17|u<<15)^(u>>>19|u<<13)^u>>>10,m=((u=this.temp[i-15])>>>7|u<<25)^(u>>>18|u<<14)^u>>>3;this.temp[i]=(y+this.temp[i-7]|0)+(m+this.temp[i-16]|0)}var w=(((f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(f&h^~f&d)|0)+(v+(r.KEY[i]+this.temp[i]|0)|0)|0,_=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&o^n&c^o&c)|0;v=d,d=h,h=f,f=l+w|0,l=c,c=o,o=n,n=w+_|0}t[0]+=n,t[1]+=o,t[2]+=c,t[3]+=l,t[4]+=f,t[5]+=h,t[6]+=d,t[7]+=v},e}();t.RawSha256=o},648:function(e,t,n){e.exports=n(649).Observable},649:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),t.Observable=void 0;var l=function(){return"function"==typeof Symbol},f=function(e){return l()&&Boolean(Symbol[e])},h=function(e){return f(e)?Symbol[e]:"@@"+e};l()&&!f("observable")&&(Symbol.observable=Symbol("observable"));var d=h("iterator"),v=h("observable"),y=h("species");function m(e,t){var n=e[t];if(null!=n){if("function"!=typeof n)throw new TypeError(n+" is not a function");return n}}function w(e){var t=e.constructor;return void 0!==t&&null===(t=t[y])&&(t=void 0),void 0!==t?t:x}function _(e){return e instanceof x}function E(e){E.log?E.log(e):setTimeout((function(){throw e}))}function S(e){Promise.resolve().then((function(){try{e()}catch(e){E(e)}}))}function O(e){var t=e._cleanup;if(void 0!==t&&(e._cleanup=void 0,t))try{if("function"==typeof t)t();else{var n=m(t,"unsubscribe");n&&n.call(t)}}catch(e){E(e)}}function T(e){e._observer=void 0,e._queue=void 0,e._state="closed"}function I(e,t,n){e._state="running";var r=e._observer;try{var o=m(r,t);switch(t){case"next":o&&o.call(r,n);break;case"error":if(T(e),!o)throw n;o.call(r,n);break;case"complete":T(e),o&&o.call(r)}}catch(e){E(e)}"closed"===e._state?O(e):"running"===e._state&&(e._state="ready")}function A(e,t,n){if("closed"!==e._state){if("buffering"!==e._state)return"ready"!==e._state?(e._state="buffering",e._queue=[{type:t,value:n}],void S((function(){return function(e){var t=e._queue;if(t){e._queue=void 0,e._state="ready";for(var i=0;i<t.length&&(I(e,t[i].type,t[i].value),"closed"!==e._state);++i);}}(e)}))):void I(e,t,n);e._queue.push({type:t,value:n})}}var N=function(){function e(t,n){r(this,e),this._cleanup=void 0,this._observer=t,this._queue=void 0,this._state="initializing";var o=new C(this);try{this._cleanup=n.call(void 0,o)}catch(e){o.error(e)}"initializing"===this._state&&(this._state="ready")}return c(e,[{key:"unsubscribe",value:function(){"closed"!==this._state&&(T(this),O(this))}},{key:"closed",get:function(){return"closed"===this._state}}]),e}(),C=function(){function e(t){r(this,e),this._subscription=t}return c(e,[{key:"next",value:function(e){A(this._subscription,"next",e)}},{key:"error",value:function(e){A(this._subscription,"error",e)}},{key:"complete",value:function(){A(this._subscription,"complete")}},{key:"closed",get:function(){return"closed"===this._subscription._state}}]),e}(),x=function(){function e(t){if(r(this,e),!(this instanceof e))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof t)throw new TypeError("Observable initializer must be a function");this._subscriber=t}return c(e,[{key:"subscribe",value:function(e){return"object"==typeof e&&null!==e||(e={next:e,error:arguments[1],complete:arguments[2]}),new N(e,this._subscriber)}},{key:"forEach",value:function(e){var t=this;return new Promise((function(n,r){if("function"==typeof e)var o=t.subscribe({next:function(t){try{e(t,c)}catch(e){r(e),o.unsubscribe()}},error:r,complete:n});else r(new TypeError(e+" is not a function"));function c(){o.unsubscribe(),n()}}))}},{key:"map",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(w(this))((function(n){return t.subscribe({next:function(t){try{t=e(t)}catch(e){return n.error(e)}n.next(t)},error:function(e){n.error(e)},complete:function(){n.complete()}})}))}},{key:"filter",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(w(this))((function(n){return t.subscribe({next:function(t){try{if(!e(t))return}catch(e){return n.error(e)}n.next(t)},error:function(e){n.error(e)},complete:function(){n.complete()}})}))}},{key:"reduce",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var n=w(this),r=arguments.length>1,o=!1,c=arguments[1],l=c;return new n((function(n){return t.subscribe({next:function(t){var c=!o;if(o=!0,!c||r)try{l=e(l,t)}catch(e){return n.error(e)}else l=t},error:function(e){n.error(e)},complete:function(){if(!o&&!r)return n.error(new TypeError("Cannot reduce an empty sequence"));n.next(l),n.complete()}})}))}},{key:"concat",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=w(this);return new o((function(t){var r,c=0;return function e(l){r=l.subscribe({next:function(e){t.next(e)},error:function(e){t.error(e)},complete:function(){c===n.length?(r=void 0,t.complete()):e(o.from(n[c++]))}})}(e),function(){r&&(r.unsubscribe(),r=void 0)}}))}},{key:"flatMap",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var n=w(this);return new n((function(r){var o=[],c=t.subscribe({next:function(t){if(e)try{t=e(t)}catch(e){return r.error(e)}var c=n.from(t).subscribe({next:function(e){r.next(e)},error:function(e){r.error(e)},complete:function(){var i=o.indexOf(c);i>=0&&o.splice(i,1),l()}});o.push(c)},error:function(e){r.error(e)},complete:function(){l()}});function l(){c.closed&&0===o.length&&r.complete()}return function(){o.forEach((function(s){return s.unsubscribe()})),c.unsubscribe()}}))}},{key:v,value:function(){return this}}],[{key:"from",value:function(t){var n="function"==typeof this?this:e;if(null==t)throw new TypeError(t+" is not an object");var r=m(t,v);if(r){var o=r.call(t);if(Object(o)!==o)throw new TypeError(o+" is not an object");return _(o)&&o.constructor===n?o:new n((function(e){return o.subscribe(e)}))}if(f("iterator")&&(r=m(t,d)))return new n((function(e){S((function(){if(!e.closed){var n=!0,o=!1,c=void 0;try{for(var l,f=r.call(t)[Symbol.iterator]();!(n=(l=f.next()).done);n=!0){var h=l.value;if(e.next(h),e.closed)return}}catch(e){o=!0,c=e}finally{try{n||null==f.return||f.return()}finally{if(o)throw c}}e.complete()}}))}));if(Array.isArray(t))return new n((function(e){S((function(){if(!e.closed){for(var i=0;i<t.length;++i)if(e.next(t[i]),e.closed)return;e.complete()}}))}));throw new TypeError(t+" is not observable")}},{key:"of",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o="function"==typeof this?this:e;return new o((function(e){S((function(){if(!e.closed){for(var i=0;i<n.length;++i)if(e.next(n[i]),e.closed)return;e.complete()}}))}))}},{key:y,get:function(){return this}}]),e}();t.Observable=x,l()&&Object.defineProperty(x,Symbol("extensions"),{value:{symbol:v,hostReportError:E},configurable:!0})},650:function(e,t,n){(function(t){var n;n=function(){var e=function(e){var data,t=e.localStorage||(data={},{setItem:function(e,t){data[e]=t},getItem:function(e){return data[e]},removeItem:function(e){delete data[e]}}),n=1,r=2,o=3,c=4,l=5,f=6,h=7,d=8,v=9,y=10,m=11,w=12,_=13,E=14,S=function(e,t){for(var n in e)if(e.hasOwnProperty(n)){if(!t.hasOwnProperty(n)){var r="Unknown property, "+n+". Valid properties are:";for(var o in t)t.hasOwnProperty(o)&&(r=r+" "+o);throw new Error(r)}if(typeof e[n]!==t[n])throw new Error(A(T.INVALID_TYPE,[typeof e[n],n]))}},O=function(e,t){return function(){return e.apply(t,arguments)}},T={OK:{code:0,text:"AMQJSC0000I OK."},CONNECT_TIMEOUT:{code:1,text:"AMQJSC0001E Connect timed out."},SUBSCRIBE_TIMEOUT:{code:2,text:"AMQJS0002E Subscribe timed out."},UNSUBSCRIBE_TIMEOUT:{code:3,text:"AMQJS0003E Unsubscribe timed out."},PING_TIMEOUT:{code:4,text:"AMQJS0004E Ping timed out."},INTERNAL_ERROR:{code:5,text:"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}"},CONNACK_RETURNCODE:{code:6,text:"AMQJS0006E Bad Connack return code:{0} {1}."},SOCKET_ERROR:{code:7,text:"AMQJS0007E Socket error:{0}."},SOCKET_CLOSE:{code:8,text:"AMQJS0008I Socket closed."},MALFORMED_UTF:{code:9,text:"AMQJS0009E Malformed UTF data:{0} {1} {2}."},UNSUPPORTED:{code:10,text:"AMQJS0010E {0} is not supported by this browser."},INVALID_STATE:{code:11,text:"AMQJS0011E Invalid state {0}."},INVALID_TYPE:{code:12,text:"AMQJS0012E Invalid type {0} for {1}."},INVALID_ARGUMENT:{code:13,text:"AMQJS0013E Invalid argument {0} for {1}."},UNSUPPORTED_OPERATION:{code:14,text:"AMQJS0014E Unsupported operation."},INVALID_STORED_DATA:{code:15,text:"AMQJS0015E Invalid data in local storage key={0} value={1}."},INVALID_MQTT_MESSAGE_TYPE:{code:16,text:"AMQJS0016E Invalid MQTT message type {0}."},MALFORMED_UNICODE:{code:17,text:"AMQJS0017E Malformed Unicode string:{0} {1}."},BUFFER_FULL:{code:18,text:"AMQJS0018E Message buffer is full, maximum buffer size: {0}."}},I={0:"Connection Accepted",1:"Connection Refused: unacceptable protocol version",2:"Connection Refused: identifier rejected",3:"Connection Refused: server unavailable",4:"Connection Refused: bad user name or password",5:"Connection Refused: not authorized"},A=function(e,t){var text=e.text;if(t)for(var n,r,i=0;i<t.length;i++)if(n="{"+i+"}",(r=text.indexOf(n))>0){var o=text.substring(0,r),c=text.substring(r+n.length);text=o+t[i]+c}return text},N=[0,6,77,81,73,115,100,112,3],C=[0,4,77,81,84,84,4],x=function(e,t){for(var n in this.type=e,t)t.hasOwnProperty(n)&&(this[n]=t[n])};function k(input,e){var t,n=e,d=input[e],y=d>>4,w=d&=15;e+=1;var _=0,E=1;do{if(e==input.length)return[null,n];_+=(127&(t=input[e++]))*E,E*=128}while(0!=(128&t));var S=e+_;if(S>input.length)return[null,n];var O=new x(y);switch(y){case r:1&input[e++]&&(O.sessionPresent=!0),O.returnCode=input[e++];break;case o:var T=w>>1&3,I=D(input,e),A=L(input,e+=2,I);e+=I,T>0&&(O.messageIdentifier=D(input,e),e+=2);var N=new G(input.subarray(e,S));1==(1&w)&&(N.retained=!0),8==(8&w)&&(N.duplicate=!0),N.qos=T,N.destinationName=A,O.payloadMessage=N;break;case c:case l:case f:case h:case m:O.messageIdentifier=D(input,e);break;case v:O.messageIdentifier=D(input,e),e+=2,O.returnCode=input.subarray(e,S)}return[O,S]}function P(input,e,t){return e[t++]=input>>8,e[t++]=input%256,t}function M(input,e,t,n){return j(input,t,n=P(e,t,n)),n+e}function D(e,t){return 256*e[t]+e[t+1]}function R(input){for(var output=0,i=0;i<input.length;i++){var e=input.charCodeAt(i);e>2047?(55296<=e&&e<=56319&&(i++,output++),output+=3):e>127?output+=2:output++}return output}function j(input,output,e){for(var t=e,i=0;i<input.length;i++){var n=input.charCodeAt(i);if(55296<=n&&n<=56319){var r=input.charCodeAt(++i);if(isNaN(r))throw new Error(A(T.MALFORMED_UNICODE,[n,r]));n=r-56320+(n-55296<<10)+65536}n<=127?output[t++]=n:n<=2047?(output[t++]=n>>6&31|192,output[t++]=63&n|128):n<=65535?(output[t++]=n>>12&15|224,output[t++]=n>>6&63|128,output[t++]=63&n|128):(output[t++]=n>>18&7|240,output[t++]=n>>12&63|128,output[t++]=n>>6&63|128,output[t++]=63&n|128)}return output}function L(input,e,t){for(var n,output="",r=e;r<e+t;){var o=input[r++];if(o<128)n=o;else{var c=input[r++]-128;if(c<0)throw new Error(A(T.MALFORMED_UTF,[o.toString(16),c.toString(16),""]));if(o<224)n=64*(o-192)+c;else{var l=input[r++]-128;if(l<0)throw new Error(A(T.MALFORMED_UTF,[o.toString(16),c.toString(16),l.toString(16)]));if(o<240)n=4096*(o-224)+64*c+l;else{var f=input[r++]-128;if(f<0)throw new Error(A(T.MALFORMED_UTF,[o.toString(16),c.toString(16),l.toString(16),f.toString(16)]));if(!(o<248))throw new Error(A(T.MALFORMED_UTF,[o.toString(16),c.toString(16),l.toString(16),f.toString(16)]));n=262144*(o-240)+4096*c+64*l+f}}}n>65535&&(n-=65536,output+=String.fromCharCode(55296+(n>>10)),n=56320+(1023&n)),output+=String.fromCharCode(n)}return output}x.prototype.encode=function(){var e,t=(15&this.type)<<4,r=0,c=[],l=0;switch(void 0!==this.messageIdentifier&&(r+=2),this.type){case n:switch(this.mqttVersion){case 3:r+=N.length+3;break;case 4:r+=C.length+3}r+=R(this.clientId)+2,void 0!==this.willMessage&&(r+=R(this.willMessage.destinationName)+2,(e=this.willMessage.payloadBytes)instanceof Uint8Array||(e=new Uint8Array(h)),r+=e.byteLength+2),void 0!==this.userName&&(r+=R(this.userName)+2),void 0!==this.password&&(r+=R(this.password)+2);break;case d:t|=2;for(var i=0;i<this.topics.length;i++)c[i]=R(this.topics[i]),r+=c[i]+2;r+=this.requestedQos.length;break;case y:for(t|=2,i=0;i<this.topics.length;i++)c[i]=R(this.topics[i]),r+=c[i]+2;break;case f:t|=2;break;case o:this.payloadMessage.duplicate&&(t|=8),t=t|=this.payloadMessage.qos<<1,this.payloadMessage.retained&&(t|=1),r+=(l=R(this.payloadMessage.destinationName))+2;var h=this.payloadMessage.payloadBytes;r+=h.byteLength,h instanceof ArrayBuffer?h=new Uint8Array(h):h instanceof Uint8Array||(h=new Uint8Array(h.buffer))}var v=function(e){var output=new Array(1),t=0;do{var n=e%128;(e>>=7)>0&&(n|=128),output[t++]=n}while(e>0&&t<4);return output}(r),m=v.length+1,w=new ArrayBuffer(r+m),_=new Uint8Array(w);if(_[0]=t,_.set(v,1),this.type==o)m=M(this.payloadMessage.destinationName,l,_,m);else if(this.type==n){switch(this.mqttVersion){case 3:_.set(N,m),m+=N.length;break;case 4:_.set(C,m),m+=C.length}var E=0;this.cleanSession&&(E=2),void 0!==this.willMessage&&(E|=4,E|=this.willMessage.qos<<3,this.willMessage.retained&&(E|=32)),void 0!==this.userName&&(E|=128),void 0!==this.password&&(E|=64),_[m++]=E,m=P(this.keepAliveInterval,_,m)}switch(void 0!==this.messageIdentifier&&(m=P(this.messageIdentifier,_,m)),this.type){case n:m=M(this.clientId,R(this.clientId),_,m),void 0!==this.willMessage&&(m=M(this.willMessage.destinationName,R(this.willMessage.destinationName),_,m),m=P(e.byteLength,_,m),_.set(e,m),m+=e.byteLength),void 0!==this.userName&&(m=M(this.userName,R(this.userName),_,m)),void 0!==this.password&&(m=M(this.password,R(this.password),_,m));break;case o:_.set(h,m);break;case d:for(i=0;i<this.topics.length;i++)m=M(this.topics[i],c[i],_,m),_[m++]=this.requestedQos[i];break;case y:for(i=0;i<this.topics.length;i++)m=M(this.topics[i],c[i],_,m)}return w};var F=function(e,t){this._client=e,this._keepAliveInterval=1e3*t,this.isReset=!1;var n=new x(w).encode(),r=function(e){return function(){return o.apply(e)}},o=function(){this.isReset?(this.isReset=!1,this._client._trace("Pinger.doPing","send PINGREQ"),this._client.socket.send(n),this.timeout=setTimeout(r(this),this._keepAliveInterval)):(this._client._trace("Pinger.doPing","Timed out"),this._client._disconnected(T.PING_TIMEOUT.code,A(T.PING_TIMEOUT)))};this.reset=function(){this.isReset=!0,clearTimeout(this.timeout),this._keepAliveInterval>0&&(this.timeout=setTimeout(r(this),this._keepAliveInterval))},this.cancel=function(){clearTimeout(this.timeout)}},U=function(e,t,n,r){t||(t=30),this.timeout=setTimeout(function(e,t,n){return function(){return e.apply(t,n)}}(n,e,r),1e3*t),this.cancel=function(){clearTimeout(this.timeout)}},B=function(n,r,o,path,c){if(!("WebSocket"in e)||null===e.WebSocket)throw new Error(A(T.UNSUPPORTED,["WebSocket"]));if(!("ArrayBuffer"in e)||null===e.ArrayBuffer)throw new Error(A(T.UNSUPPORTED,["ArrayBuffer"]));for(var l in this._trace("Paho.Client",n,r,o,path,c),this.host=r,this.port=o,this.path=path,this.uri=n,this.clientId=c,this._wsuri=null,this._localKey=r+":"+o+("/mqtt"!=path?":"+path:"")+":"+c+":",this._msg_queue=[],this._buffered_msg_queue=[],this._sentMessages={},this._receivedMessages={},this._notify_msg_sent={},this._message_identifier=1,this._sequence=0,t)0!==l.indexOf("Sent:"+this._localKey)&&0!==l.indexOf("Received:"+this._localKey)||this.restore(l)};B.prototype.host=null,B.prototype.port=null,B.prototype.path=null,B.prototype.uri=null,B.prototype.clientId=null,B.prototype.socket=null,B.prototype.connected=!1,B.prototype.maxMessageIdentifier=65536,B.prototype.connectOptions=null,B.prototype.hostIndex=null,B.prototype.onConnected=null,B.prototype.onConnectionLost=null,B.prototype.onMessageDelivered=null,B.prototype.onMessageArrived=null,B.prototype.traceFunction=null,B.prototype._msg_queue=null,B.prototype._buffered_msg_queue=null,B.prototype._connectTimeout=null,B.prototype.sendPinger=null,B.prototype.receivePinger=null,B.prototype._reconnectInterval=1,B.prototype._reconnecting=!1,B.prototype._reconnectTimeout=null,B.prototype.disconnectedPublishing=!1,B.prototype.disconnectedBufferSize=5e3,B.prototype.receiveBuffer=null,B.prototype._traceBuffer=null,B.prototype._MAX_TRACE_ENTRIES=100,B.prototype.connect=function(e){var t=this._traceMask(e,"password");if(this._trace("Client.connect",t,this.socket,this.connected),this.connected)throw new Error(A(T.INVALID_STATE,["already connected"]));if(this.socket)throw new Error(A(T.INVALID_STATE,["already connected"]));this._reconnecting&&(this._reconnectTimeout.cancel(),this._reconnectTimeout=null,this._reconnecting=!1),this.connectOptions=e,this._reconnectInterval=1,this._reconnecting=!1,e.uris?(this.hostIndex=0,this._doConnect(e.uris[0])):this._doConnect(this.uri)},B.prototype.subscribe=function(filter,e){if(this._trace("Client.subscribe",filter,e),!this.connected)throw new Error(A(T.INVALID_STATE,["not connected"]));var t=new x(d);t.topics=filter.constructor===Array?filter:[filter],void 0===e.qos&&(e.qos=0),t.requestedQos=[];for(var i=0;i<t.topics.length;i++)t.requestedQos[i]=e.qos;e.onSuccess&&(t.onSuccess=function(t){e.onSuccess({invocationContext:e.invocationContext,grantedQos:t})}),e.onFailure&&(t.onFailure=function(t){e.onFailure({invocationContext:e.invocationContext,errorCode:t,errorMessage:A(t)})}),e.timeout&&(t.timeOut=new U(this,e.timeout,e.onFailure,[{invocationContext:e.invocationContext,errorCode:T.SUBSCRIBE_TIMEOUT.code,errorMessage:A(T.SUBSCRIBE_TIMEOUT)}])),this._requires_ack(t),this._schedule_message(t)},B.prototype.unsubscribe=function(filter,e){if(this._trace("Client.unsubscribe",filter,e),!this.connected)throw new Error(A(T.INVALID_STATE,["not connected"]));var t=new x(y);t.topics=filter.constructor===Array?filter:[filter],e.onSuccess&&(t.callback=function(){e.onSuccess({invocationContext:e.invocationContext})}),e.timeout&&(t.timeOut=new U(this,e.timeout,e.onFailure,[{invocationContext:e.invocationContext,errorCode:T.UNSUBSCRIBE_TIMEOUT.code,errorMessage:A(T.UNSUBSCRIBE_TIMEOUT)}])),this._requires_ack(t),this._schedule_message(t)},B.prototype.send=function(e){this._trace("Client.send",e);var t=new x(o);if(t.payloadMessage=e,this.connected)e.qos>0?this._requires_ack(t):this.onMessageDelivered&&(this._notify_msg_sent[t]=this.onMessageDelivered(t.payloadMessage)),this._schedule_message(t);else{if(!this._reconnecting||!this.disconnectedPublishing)throw new Error(A(T.INVALID_STATE,["not connected"]));if(Object.keys(this._sentMessages).length+this._buffered_msg_queue.length>this.disconnectedBufferSize)throw new Error(A(T.BUFFER_FULL,[this.disconnectedBufferSize]));e.qos>0?this._requires_ack(t):(t.sequence=++this._sequence,this._buffered_msg_queue.unshift(t))}},B.prototype.disconnect=function(){if(this._trace("Client.disconnect"),this._reconnecting&&(this._reconnectTimeout.cancel(),this._reconnectTimeout=null,this._reconnecting=!1),!this.socket)throw new Error(A(T.INVALID_STATE,["not connecting or connected"]));var e=new x(E);this._notify_msg_sent[e]=O(this._disconnected,this),this._schedule_message(e)},B.prototype.getTraceLog=function(){if(null!==this._traceBuffer){for(var e in this._trace("Client.getTraceLog",new Date),this._trace("Client.getTraceLog in flight messages",this._sentMessages.length),this._sentMessages)this._trace("_sentMessages ",e,this._sentMessages[e]);for(var e in this._receivedMessages)this._trace("_receivedMessages ",e,this._receivedMessages[e]);return this._traceBuffer}},B.prototype.startTrace=function(){null===this._traceBuffer&&(this._traceBuffer=[]),this._trace("Client.startTrace",new Date,"@VERSION@-@BUILDLEVEL@")},B.prototype.stopTrace=function(){delete this._traceBuffer},B.prototype._doConnect=function(e){if(this.connectOptions.useSSL){var t=e.split(":");t[0]="wss",e=t.join(":")}this._wsuri=e,this.connected=!1,this.connectOptions.mqttVersion<4?this.socket=new WebSocket(e,["mqttv3.1"]):this.socket=new WebSocket(e,["mqtt"]),this.socket.binaryType="arraybuffer",this.socket.onopen=O(this._on_socket_open,this),this.socket.onmessage=O(this._on_socket_message,this),this.socket.onerror=O(this._on_socket_error,this),this.socket.onclose=O(this._on_socket_close,this),this.sendPinger=new F(this,this.connectOptions.keepAliveInterval),this.receivePinger=new F(this,this.connectOptions.keepAliveInterval),this._connectTimeout&&(this._connectTimeout.cancel(),this._connectTimeout=null),this._connectTimeout=new U(this,this.connectOptions.timeout,this._disconnected,[T.CONNECT_TIMEOUT.code,A(T.CONNECT_TIMEOUT)])},B.prototype._schedule_message=function(e){this._msg_queue.unshift(e),this.connected&&this._process_queue()},B.prototype.store=function(e,n){var r={type:n.type,messageIdentifier:n.messageIdentifier,version:1};if(n.type!==o)throw Error(A(T.INVALID_STORED_DATA,[e+this._localKey+n.messageIdentifier,r]));n.pubRecReceived&&(r.pubRecReceived=!0),r.payloadMessage={};for(var c="",l=n.payloadMessage.payloadBytes,i=0;i<l.length;i++)l[i]<=15?c=c+"0"+l[i].toString(16):c+=l[i].toString(16);r.payloadMessage.payloadHex=c,r.payloadMessage.qos=n.payloadMessage.qos,r.payloadMessage.destinationName=n.payloadMessage.destinationName,n.payloadMessage.duplicate&&(r.payloadMessage.duplicate=!0),n.payloadMessage.retained&&(r.payloadMessage.retained=!0),0===e.indexOf("Sent:")&&(void 0===n.sequence&&(n.sequence=++this._sequence),r.sequence=n.sequence),t.setItem(e+this._localKey+n.messageIdentifier,JSON.stringify(r))},B.prototype.restore=function(e){var n=t.getItem(e),r=JSON.parse(n),c=new x(r.type,r);if(r.type!==o)throw Error(A(T.INVALID_STORED_DATA,[e,n]));for(var l=r.payloadMessage.payloadHex,f=new ArrayBuffer(l.length/2),h=new Uint8Array(f),i=0;l.length>=2;){var d=parseInt(l.substring(0,2),16);l=l.substring(2,l.length),h[i++]=d}var v=new G(h);v.qos=r.payloadMessage.qos,v.destinationName=r.payloadMessage.destinationName,r.payloadMessage.duplicate&&(v.duplicate=!0),r.payloadMessage.retained&&(v.retained=!0),c.payloadMessage=v,0===e.indexOf("Sent:"+this._localKey)?(c.payloadMessage.duplicate=!0,this._sentMessages[c.messageIdentifier]=c):0===e.indexOf("Received:"+this._localKey)&&(this._receivedMessages[c.messageIdentifier]=c)},B.prototype._process_queue=function(){for(var e=null;e=this._msg_queue.pop();)this._socket_send(e),this._notify_msg_sent[e]&&(this._notify_msg_sent[e](),delete this._notify_msg_sent[e])},B.prototype._requires_ack=function(e){var t=Object.keys(this._sentMessages).length;if(t>this.maxMessageIdentifier)throw Error("Too many messages:"+t);for(;void 0!==this._sentMessages[this._message_identifier];)this._message_identifier++;e.messageIdentifier=this._message_identifier,this._sentMessages[e.messageIdentifier]=e,e.type===o&&this.store("Sent:",e),this._message_identifier===this.maxMessageIdentifier&&(this._message_identifier=1)},B.prototype._on_socket_open=function(){var e=new x(n,this.connectOptions);e.clientId=this.clientId,this._socket_send(e)},B.prototype._on_socket_message=function(e){this._trace("Client._on_socket_message",e.data);for(var t=this._deframeMessages(e.data),i=0;i<t.length;i+=1)this._handleMessage(t[i])},B.prototype._deframeMessages=function(data){var e=new Uint8Array(data),t=[];if(this.receiveBuffer){var n=new Uint8Array(this.receiveBuffer.length+e.length);n.set(this.receiveBuffer),n.set(e,this.receiveBuffer.length),e=n,delete this.receiveBuffer}try{for(var r=0;r<e.length;){var o=k(e,r),c=o[0];if(r=o[1],null===c)break;t.push(c)}r<e.length&&(this.receiveBuffer=e.subarray(r))}catch(e){var l="undefined"==e.hasOwnProperty("stack")?e.stack.toString():"No Error Stack Available";return void this._disconnected(T.INTERNAL_ERROR.code,A(T.INTERNAL_ERROR,[e.message,l]))}return t},B.prototype._handleMessage=function(e){this._trace("Client._handleMessage",e);try{switch(e.type){case r:if(this._connectTimeout.cancel(),this._reconnectTimeout&&this._reconnectTimeout.cancel(),this.connectOptions.cleanSession){for(var n in this._sentMessages){var d=this._sentMessages[n];t.removeItem("Sent:"+this._localKey+d.messageIdentifier)}for(var n in this._sentMessages={},this._receivedMessages){var y=this._receivedMessages[n];t.removeItem("Received:"+this._localKey+y.messageIdentifier)}this._receivedMessages={}}if(0!==e.returnCode){this._disconnected(T.CONNACK_RETURNCODE.code,A(T.CONNACK_RETURNCODE,[e.returnCode,I[e.returnCode]]));break}this.connected=!0,this.connectOptions.uris&&(this.hostIndex=this.connectOptions.uris.length);var w=[];for(var E in this._sentMessages)this._sentMessages.hasOwnProperty(E)&&w.push(this._sentMessages[E]);if(this._buffered_msg_queue.length>0)for(var S=null;S=this._buffered_msg_queue.pop();)w.push(S),this.onMessageDelivered&&(this._notify_msg_sent[S]=this.onMessageDelivered(S.payloadMessage));w=w.sort((function(a,b){return a.sequence-b.sequence}));for(var i=0,O=w.length;i<O;i++)if((d=w[i]).type==o&&d.pubRecReceived){var N=new x(f,{messageIdentifier:d.messageIdentifier});this._schedule_message(N)}else this._schedule_message(d);this.connectOptions.onSuccess&&this.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext});var C=!1;this._reconnecting&&(C=!0,this._reconnectInterval=1,this._reconnecting=!1),this._connected(C,this._wsuri),this._process_queue();break;case o:this._receivePublish(e);break;case c:(d=this._sentMessages[e.messageIdentifier])&&(delete this._sentMessages[e.messageIdentifier],t.removeItem("Sent:"+this._localKey+e.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(d.payloadMessage));break;case l:(d=this._sentMessages[e.messageIdentifier])&&(d.pubRecReceived=!0,N=new x(f,{messageIdentifier:e.messageIdentifier}),this.store("Sent:",d),this._schedule_message(N));break;case f:y=this._receivedMessages[e.messageIdentifier],t.removeItem("Received:"+this._localKey+e.messageIdentifier),y&&(this._receiveMessage(y),delete this._receivedMessages[e.messageIdentifier]);var k=new x(h,{messageIdentifier:e.messageIdentifier});this._schedule_message(k);break;case h:d=this._sentMessages[e.messageIdentifier],delete this._sentMessages[e.messageIdentifier],t.removeItem("Sent:"+this._localKey+e.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(d.payloadMessage);break;case v:(d=this._sentMessages[e.messageIdentifier])&&(d.timeOut&&d.timeOut.cancel(),128===e.returnCode[0]?d.onFailure&&d.onFailure(e.returnCode):d.onSuccess&&d.onSuccess(e.returnCode),delete this._sentMessages[e.messageIdentifier]);break;case m:(d=this._sentMessages[e.messageIdentifier])&&(d.timeOut&&d.timeOut.cancel(),d.callback&&d.callback(),delete this._sentMessages[e.messageIdentifier]);break;case _:this.sendPinger.reset();break;default:this._disconnected(T.INVALID_MQTT_MESSAGE_TYPE.code,A(T.INVALID_MQTT_MESSAGE_TYPE,[e.type]))}}catch(e){var P="undefined"==e.hasOwnProperty("stack")?e.stack.toString():"No Error Stack Available";return void this._disconnected(T.INTERNAL_ERROR.code,A(T.INTERNAL_ERROR,[e.message,P]))}},B.prototype._on_socket_error=function(e){this._reconnecting||this._disconnected(T.SOCKET_ERROR.code,A(T.SOCKET_ERROR,[e.data]))},B.prototype._on_socket_close=function(){this._reconnecting||this._disconnected(T.SOCKET_CLOSE.code,A(T.SOCKET_CLOSE))},B.prototype._socket_send=function(e){if(1==e.type){var t=this._traceMask(e,"password");this._trace("Client._socket_send",t)}else this._trace("Client._socket_send",e);this.socket.send(e.encode()),this.sendPinger.reset()},B.prototype._receivePublish=function(e){switch(e.payloadMessage.qos){case"undefined":case 0:this._receiveMessage(e);break;case 1:var t=new x(c,{messageIdentifier:e.messageIdentifier});this._schedule_message(t),this._receiveMessage(e);break;case 2:this._receivedMessages[e.messageIdentifier]=e,this.store("Received:",e);var n=new x(l,{messageIdentifier:e.messageIdentifier});this._schedule_message(n);break;default:throw Error("Invaild qos="+e.payloadMessage.qos)}},B.prototype._receiveMessage=function(e){this.onMessageArrived&&this.onMessageArrived(e.payloadMessage)},B.prototype._connected=function(e,t){this.onConnected&&this.onConnected(e,t)},B.prototype._reconnect=function(){this._trace("Client._reconnect"),this.connected||(this._reconnecting=!0,this.sendPinger.cancel(),this.receivePinger.cancel(),this._reconnectInterval<128&&(this._reconnectInterval=2*this._reconnectInterval),this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri))},B.prototype._disconnected=function(e,t){if(this._trace("Client._disconnected",e,t),void 0!==e&&this._reconnecting)this._reconnectTimeout=new U(this,this._reconnectInterval,this._reconnect);else if(this.sendPinger.cancel(),this.receivePinger.cancel(),this._connectTimeout&&(this._connectTimeout.cancel(),this._connectTimeout=null),this._msg_queue=[],this._buffered_msg_queue=[],this._notify_msg_sent={},this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,1===this.socket.readyState&&this.socket.close(),delete this.socket),this.connectOptions.uris&&this.hostIndex<this.connectOptions.uris.length-1)this.hostIndex++,this._doConnect(this.connectOptions.uris[this.hostIndex]);else if(void 0===e&&(e=T.OK.code,t=A(T.OK)),this.connected){if(this.connected=!1,this.onConnectionLost&&this.onConnectionLost({errorCode:e,errorMessage:t,reconnect:this.connectOptions.reconnect,uri:this._wsuri}),e!==T.OK.code&&this.connectOptions.reconnect)return this._reconnectInterval=1,void this._reconnect()}else 4===this.connectOptions.mqttVersion&&!1===this.connectOptions.mqttVersionExplicit?(this._trace("Failed to connect V4, dropping back to V3"),this.connectOptions.mqttVersion=3,this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri)):this.connectOptions.onFailure&&this.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext,errorCode:e,errorMessage:t})},B.prototype._trace=function(){if(this.traceFunction){var e=Array.prototype.slice.call(arguments);for(var i in e)void 0!==e[i]&&e.splice(i,1,JSON.stringify(e[i]));var t=e.join("");this.traceFunction({severity:"Debug",message:t})}if(null!==this._traceBuffer){i=0;for(var n=arguments.length;i<n;i++)this._traceBuffer.length==this._MAX_TRACE_ENTRIES&&this._traceBuffer.shift(),0===i||void 0===arguments[i]?this._traceBuffer.push(arguments[i]):this._traceBuffer.push("  "+JSON.stringify(arguments[i]))}},B.prototype._traceMask=function(e,t){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=r==t?"******":e[r]);return n};var G=function(e){var t,n;if(!("string"==typeof e||e instanceof ArrayBuffer||ArrayBuffer.isView(e)&&!(e instanceof DataView)))throw A(T.INVALID_ARGUMENT,[e,"newPayload"]);t=e;var r=0,o=!1,c=!1;Object.defineProperties(this,{payloadString:{enumerable:!0,get:function(){return"string"==typeof t?t:L(t,0,t.length)}},payloadBytes:{enumerable:!0,get:function(){if("string"==typeof t){var e=new ArrayBuffer(R(t)),n=new Uint8Array(e);return j(t,n,0),n}return t}},destinationName:{enumerable:!0,get:function(){return n},set:function(e){if("string"!=typeof e)throw new Error(A(T.INVALID_ARGUMENT,[e,"newDestinationName"]));n=e}},qos:{enumerable:!0,get:function(){return r},set:function(e){if(0!==e&&1!==e&&2!==e)throw new Error("Invalid argument:"+e);r=e}},retained:{enumerable:!0,get:function(){return o},set:function(e){if("boolean"!=typeof e)throw new Error(A(T.INVALID_ARGUMENT,[e,"newRetained"]));o=e}},topic:{enumerable:!0,get:function(){return n},set:function(e){n=e}},duplicate:{enumerable:!0,get:function(){return c},set:function(e){c=e}}})};return{Client:function(e,t,path,n){var r;if("string"!=typeof e)throw new Error(A(T.INVALID_TYPE,[typeof e,"host"]));if(2==arguments.length){n=t;var o=(r=e).match(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);if(!o)throw new Error(A(T.INVALID_ARGUMENT,[e,"host"]));e=o[4]||o[2],t=parseInt(o[7]),path=o[8]}else{if(3==arguments.length&&(n=path,path="/mqtt"),"number"!=typeof t||t<0)throw new Error(A(T.INVALID_TYPE,[typeof t,"port"]));if("string"!=typeof path)throw new Error(A(T.INVALID_TYPE,[typeof path,"path"]));var c=-1!==e.indexOf(":")&&"["!==e.slice(0,1)&&"]"!==e.slice(-1);r="ws://"+(c?"["+e+"]":e)+":"+t+path}for(var l=0,i=0;i<n.length;i++){var f=n.charCodeAt(i);55296<=f&&f<=56319&&i++,l++}if("string"!=typeof n||l>65535)throw new Error(A(T.INVALID_ARGUMENT,[n,"clientId"]));var h=new B(r,e,t,path,n);Object.defineProperties(this,{host:{get:function(){return e},set:function(){throw new Error(A(T.UNSUPPORTED_OPERATION))}},port:{get:function(){return t},set:function(){throw new Error(A(T.UNSUPPORTED_OPERATION))}},path:{get:function(){return path},set:function(){throw new Error(A(T.UNSUPPORTED_OPERATION))}},uri:{get:function(){return r},set:function(){throw new Error(A(T.UNSUPPORTED_OPERATION))}},clientId:{get:function(){return h.clientId},set:function(){throw new Error(A(T.UNSUPPORTED_OPERATION))}},onConnected:{get:function(){return h.onConnected},set:function(e){if("function"!=typeof e)throw new Error(A(T.INVALID_TYPE,[typeof e,"onConnected"]));h.onConnected=e}},disconnectedPublishing:{get:function(){return h.disconnectedPublishing},set:function(e){h.disconnectedPublishing=e}},disconnectedBufferSize:{get:function(){return h.disconnectedBufferSize},set:function(e){h.disconnectedBufferSize=e}},onConnectionLost:{get:function(){return h.onConnectionLost},set:function(e){if("function"!=typeof e)throw new Error(A(T.INVALID_TYPE,[typeof e,"onConnectionLost"]));h.onConnectionLost=e}},onMessageDelivered:{get:function(){return h.onMessageDelivered},set:function(e){if("function"!=typeof e)throw new Error(A(T.INVALID_TYPE,[typeof e,"onMessageDelivered"]));h.onMessageDelivered=e}},onMessageArrived:{get:function(){return h.onMessageArrived},set:function(e){if("function"!=typeof e)throw new Error(A(T.INVALID_TYPE,[typeof e,"onMessageArrived"]));h.onMessageArrived=e}},trace:{get:function(){return h.traceFunction},set:function(e){if("function"!=typeof e)throw new Error(A(T.INVALID_TYPE,[typeof e,"onTrace"]));h.traceFunction=e}}}),this.connect=function(e){if(S(e=e||{},{timeout:"number",userName:"string",password:"string",willMessage:"object",keepAliveInterval:"number",cleanSession:"boolean",useSSL:"boolean",invocationContext:"object",onSuccess:"function",onFailure:"function",hosts:"object",ports:"object",reconnect:"boolean",mqttVersion:"number",mqttVersionExplicit:"boolean",uris:"object"}),void 0===e.keepAliveInterval&&(e.keepAliveInterval=60),e.mqttVersion>4||e.mqttVersion<3)throw new Error(A(T.INVALID_ARGUMENT,[e.mqttVersion,"connectOptions.mqttVersion"]));if(void 0===e.mqttVersion?(e.mqttVersionExplicit=!1,e.mqttVersion=4):e.mqttVersionExplicit=!0,void 0!==e.password&&void 0===e.userName)throw new Error(A(T.INVALID_ARGUMENT,[e.password,"connectOptions.password"]));if(e.willMessage){if(!(e.willMessage instanceof G))throw new Error(A(T.INVALID_TYPE,[e.willMessage,"connectOptions.willMessage"]));if(e.willMessage.stringPayload=null,void 0===e.willMessage.destinationName)throw new Error(A(T.INVALID_TYPE,[typeof e.willMessage.destinationName,"connectOptions.willMessage.destinationName"]))}if(void 0===e.cleanSession&&(e.cleanSession=!0),e.hosts){if(!(e.hosts instanceof Array))throw new Error(A(T.INVALID_ARGUMENT,[e.hosts,"connectOptions.hosts"]));if(e.hosts.length<1)throw new Error(A(T.INVALID_ARGUMENT,[e.hosts,"connectOptions.hosts"]));for(var t=!1,i=0;i<e.hosts.length;i++){if("string"!=typeof e.hosts[i])throw new Error(A(T.INVALID_TYPE,[typeof e.hosts[i],"connectOptions.hosts["+i+"]"]));if(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/.test(e.hosts[i])){if(0===i)t=!0;else if(!t)throw new Error(A(T.INVALID_ARGUMENT,[e.hosts[i],"connectOptions.hosts["+i+"]"]))}else if(t)throw new Error(A(T.INVALID_ARGUMENT,[e.hosts[i],"connectOptions.hosts["+i+"]"]))}if(t)e.uris=e.hosts;else{if(!e.ports)throw new Error(A(T.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));if(!(e.ports instanceof Array))throw new Error(A(T.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));if(e.hosts.length!==e.ports.length)throw new Error(A(T.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));for(e.uris=[],i=0;i<e.hosts.length;i++){if("number"!=typeof e.ports[i]||e.ports[i]<0)throw new Error(A(T.INVALID_TYPE,[typeof e.ports[i],"connectOptions.ports["+i+"]"]));var n=e.hosts[i],o=e.ports[i],c=-1!==n.indexOf(":");r="ws://"+(c?"["+n+"]":n)+":"+o+path,e.uris.push(r)}}}h.connect(e)},this.subscribe=function(filter,e){if("string"!=typeof filter&&filter.constructor!==Array)throw new Error("Invalid argument:"+filter);if(S(e=e||{},{qos:"number",invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),e.timeout&&!e.onFailure)throw new Error("subscribeOptions.timeout specified with no onFailure callback.");if(void 0!==e.qos&&0!==e.qos&&1!==e.qos&&2!==e.qos)throw new Error(A(T.INVALID_ARGUMENT,[e.qos,"subscribeOptions.qos"]));h.subscribe(filter,e)},this.unsubscribe=function(filter,e){if("string"!=typeof filter&&filter.constructor!==Array)throw new Error("Invalid argument:"+filter);if(S(e=e||{},{invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),e.timeout&&!e.onFailure)throw new Error("unsubscribeOptions.timeout specified with no onFailure callback.");h.unsubscribe(filter,e)},this.send=function(e,t,n,r){var o;if(0===arguments.length)throw new Error("Invalid argument.length");if(1==arguments.length){if(!(e instanceof G)&&"string"!=typeof e)throw new Error("Invalid argument:"+typeof e);if(void 0===(o=e).destinationName)throw new Error(A(T.INVALID_ARGUMENT,[o.destinationName,"Message.destinationName"]));h.send(o)}else(o=new G(t)).destinationName=e,arguments.length>=3&&(o.qos=n),arguments.length>=4&&(o.retained=r),h.send(o)},this.publish=function(e,t,n,r){var o;if(0===arguments.length)throw new Error("Invalid argument.length");if(1==arguments.length){if(!(e instanceof G)&&"string"!=typeof e)throw new Error("Invalid argument:"+typeof e);if(void 0===(o=e).destinationName)throw new Error(A(T.INVALID_ARGUMENT,[o.destinationName,"Message.destinationName"]));h.send(o)}else(o=new G(t)).destinationName=e,arguments.length>=3&&(o.qos=n),arguments.length>=4&&(o.retained=r),h.send(o)},this.disconnect=function(){h.disconnect()},this.getTraceLog=function(){return h.getTraceLog()},this.startTrace=function(){h.startTrace()},this.stopTrace=function(){h.stopTrace()},this.isConnected=function(){return h.connected}},Message:G}}(void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});return e},e.exports=n()}).call(this,n(36))},651:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return k}));var r,o,c=n(6),l=n(411),f=n(267),h=n(114),d=n(59),v=n(272),y=n(412),m=n(488),w=n(187),_=n(511),E=n(410),S=n(484),O=n(546),T=function(){return T=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},T.apply(this,arguments)},I=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function f(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,f)}h((r=r.apply(e,t||[])).next())}))},A=function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],n=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},N=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},C=function(){for(var e=[],i=0;i<arguments.length;i++)e=e.concat(N(arguments[i]));return e},x=new d.a("DataStore");!function(e){e.CONNECTED="CONNECTED"}(r||(r={})),function(e){e[e.none=0]="none",e[e.unauth=1]="unauth",e[e.auth=2]="auth"}(o||(o={}));var k=function(){function t(e,t,n,r,o){void 0===n&&(n={}),this.schema=e,this.syncPredicates=t,this.amplifyConfig=n,this.authModeStrategy=r,this.errorHandler=o,this.typeQuery=new WeakMap,this.buffer=[]}return t.prototype.buildSubscription=function(e,t,n,r,o,c,l){var f=this.amplifyConfig.aws_appsync_authenticationType,h=this.getAuthorizationInfo(t,r,f,o,c,l)||{},d=h.isOwner,v=h.ownerField,y=h.ownerValue,m=N(Object(_.c)(e,t,n,d,v),3);return{authMode:l,opType:m[0],opName:m[1],query:m[2],isOwner:d,ownerField:v,ownerValue:y}},t.prototype.getAuthorizationInfo=function(e,t,n,r,l,f){void 0===r&&(r={}),void 0===l&&(l={});var h=Object(_.e)(e);if(f===c.c.AWS_IAM&&h.find((function(e){return"private"===e.authStrategy&&"iam"===e.provider}))&&t===o.unauth)return null;var d,v=h.filter((function(e){return"groups"===e.authStrategy&&["userPools","oidc"].includes(e.provider)}));return f!==c.c.AMAZON_COGNITO_USER_POOLS&&f!==c.c.OPENID_CONNECT||!v.find((function(e){var t=Object(_.j)(r,e),n=Object(_.j)(l,e);return C(t,n).find((function(t){return e.groups.find((function(e){return e===t}))}))}))?((f===c.c.AMAZON_COGNITO_USER_POOLS?h.filter((function(e){return"owner"===e.authStrategy&&"userPools"===e.provider})):[]).forEach((function(e){var t=r[e.identityClaim];t&&(d={authMode:c.c.AMAZON_COGNITO_USER_POOLS,isOwner:!e.areSubscriptionsPublic,ownerField:e.ownerField,ownerValue:t})})),d||((f===c.c.OPENID_CONNECT?h.filter((function(e){return"owner"===e.authStrategy&&"oidc"===e.provider})):[]).forEach((function(e){var t=l[e.identityClaim];t&&(d={authMode:c.c.OPENID_CONNECT,isOwner:!e.areSubscriptionsPublic,ownerField:e.ownerField,ownerValue:t})})),d||{authMode:f||n,isOwner:!1})):{authMode:f,isOwner:!1}},t.prototype.hubQueryCompletionListener=function(e,t){t.payload.event===y.a.SUBSCRIPTION_ACK&&e()},t.prototype.start=function(){var t=this,n=new m.a((function(n){var c,d,m=[],S={},C=o.none;return I(t,void 0,void 0,(function(){var t,k,P,M,D,R,j,L,F,U,B=this;return A(this,(function(G){switch(G.label){case 0:return G.trys.push([0,2,,3]),[4,f.a.currentCredentials()];case 1:return t=G.sent(),C=t.authenticated?o.auth:o.unauth,[3,3];case 2:return G.sent(),[3,3];case 3:return G.trys.push([3,5,,6]),[4,f.a.currentSession()];case 4:return k=G.sent(),c=k.getIdToken().decodePayload(),[3,6];case 5:return G.sent(),[3,6];case 6:if(G.trys.push([6,11,,12]),P=this.amplifyConfig,M=P.aws_cognito_region,D=P.Auth,!M||D&&!D.region)throw"Auth is not configured";return R=void 0,[4,h.a.getItem("federatedInfo")];case 7:return(j=G.sent())?(R=j.token,[3,10]):[3,8];case 8:return[4,f.a.currentAuthenticatedUser()];case 9:(L=G.sent())&&(R=L.token),G.label=10;case 10:return R&&(F=R.split(".")[1],d=JSON.parse(e.from(F,"base64").toString("utf8"))),[3,12];case 11:return U=G.sent(),x.debug("error getting OIDC JWT",U),[3,12];case 12:return Object.values(this.schema.namespaces).forEach((function(e){Object.values(e.models).filter((function(e){return e.syncable})).forEach((function(t){return I(B,void 0,void 0,(function(){var r,o,f,h,k,P,M,D,R=this;return A(this,(function(j){switch(j.label){case 0:return[4,Object(_.h)({authModeStrategy:this.authModeStrategy,defaultAuthMode:this.amplifyConfig.aws_appsync_authenticationType,modelName:t.name,schema:this.schema})];case 1:return r=j.sent(),o=r.READ,S=T(T({},S),((P={})[t.name]=((M={})[_.a.CREATE]=[],M[_.a.UPDATE]=[],M[_.a.DELETE]=[],M),P)),f=[_.a.CREATE,_.a.UPDATE,_.a.DELETE],(D={})[_.a.CREATE]=0,D[_.a.UPDATE]=0,D[_.a.DELETE]=0,h=D,k=function(r){return I(R,void 0,void 0,(function(){var f,P,M,D,R,j,L,F,U,B,G,V,K=this;return A(this,(function(W){switch(W.label){case 0:return f=this.buildSubscription(e,t,r,C,c,d,o[h[r]]),P=f.opType,M=f.opName,D=f.query,R=f.isOwner,j=f.ownerField,L=f.ownerValue,F=f.authMode,[4,Object(_.i)(F,this.amplifyConfig)];case 1:if(U=W.sent(),B={},R){if(!L)return n.error("Owner field required, sign in is needed in order to perform this operation"),[2];B[j]=L}return x.debug("Attempting "+r+" subscription with authMode: "+o[h[r]]),G=l.a.graphql(T(T({query:D,variables:B},{authMode:F}),{authToken:U})),S[t.name][P].push(G.map((function(e){return e.value})).subscribe({next:function(e){var data=e.data,n=e.errors;if(Array.isArray(n)&&n.length>0){var r=n.map((function(e){return e.message}));return x.warn("Skipping incoming subscription. Messages: "+r.join("\n")),void K.drainBuffer()}var o=E.a.getPredicates(K.syncPredicates.get(t),!1),c=data[M];K.passesPredicateValidation(c,o)&&K.pushToBuffer(P,t,c),K.drainBuffer()},error:function(e){return I(K,void 0,void 0,(function(){var c,l,f,d,v,m;return A(this,(function(_){switch(_.label){case 0:c=e.error,l=N((void 0===c?{errors:[]}:c).errors,1),f=l[0],d=(void 0===f?{}:f).message,v=void 0===d?"":d,_.label=1;case 1:return _.trys.push([1,3,,4]),[4,this.errorHandler({recoverySuggestion:"Ensure app code is up to date, auth directives exist and are correct on each model, and that server-side data has not been invalidated by a schema change. If the problem persists, search for or create an issue: https://github.com/aws-amplify/amplify-js/issues",localModel:null,message:v,model:t.name,operation:r,errorType:Object(O.b)(e),process:w.i.subscribe,remoteModel:null,cause:e})];case 2:return _.sent(),[3,4];case 3:return m=_.sent(),x.error("Sync error handler failed with:",m),[3,4];case 4:return v.includes(y.a.REALTIME_SUBSCRIPTION_INIT_ERROR)||v.includes(y.a.CONNECTION_FAILED)?(S[t.name][P].forEach((function(e){return e.unsubscribe()})),S[t.name][P]=[],h[r]++,h[r]>=o.length?(x.debug(r+" subscription failed with authMode: "+o[h[r]-1]),x.warn("subscriptionError",v),[2]):(x.debug(r+" subscription failed with authMode: "+o[h[r]-1]+". Retrying with authMode: "+o[h[r]]),k(r),[2])):(x.warn("subscriptionError",v),"function"==typeof V&&V(),v.includes('"errorType":"Unauthorized"')||v.includes('"errorType":"OperationDisabled"')||n.error(v),[2])}}))}))}})),m.push(I(K,void 0,void 0,(function(){var e,t=this;return A(this,(function(n){switch(n.label){case 0:return[4,new Promise((function(n){V=n,e=t.hubQueryCompletionListener.bind(t,n),v.a.listen("api",e)}))];case 1:return n.sent(),v.a.remove("api",e),[2]}}))}))),[2]}}))}))},f.forEach((function(e){return k(e)})),[2]}}))}))}))})),Promise.all(m).then((function(){return n.next(r.CONNECTED)})),[2]}}))})),function(){Object.keys(S).forEach((function(e){S[e][_.a.CREATE].forEach((function(e){return e.unsubscribe()})),S[e][_.a.UPDATE].forEach((function(e){return e.unsubscribe()})),S[e][_.a.DELETE].forEach((function(e){return e.unsubscribe()}))}))}}));return[n,new m.a((function(e){return t.dataObserver=e,t.drainBuffer(),function(){t.dataObserver=null}}))]},t.prototype.passesPredicateValidation=function(e,t){if(!t)return!0;var n=t.predicates,r=t.type;return Object(S.A)(e,r,n)},t.prototype.pushToBuffer=function(e,t,data){this.buffer.push([e,t,data])},t.prototype.drainBuffer=function(){var e=this;this.dataObserver&&(this.buffer.forEach((function(data){return e.dataObserver.next(data)})),this.buffer=[])},t}()}).call(this,n(10).Buffer)},675:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,"a",(function(){return N}));var o=n(611);function c(source,e){for(var t,n=/\r\n|[\n\r]/g,line=1,r=e+1;(t=n.exec(source.body))&&t.index<e;)line+=1,r=e+1-(t.index+t[0].length);return{line:line,column:r}}function l(e){return f(e.source,c(e.source,e.start))}function f(source,e){var t=source.locationOffset.column-1,body=d(t)+source.body,n=e.line-1,r=source.locationOffset.line-1,o=e.line+r,c=1===e.line?t:0,l=e.column+c,f="".concat(source.name,":").concat(o,":").concat(l,"\n"),v=body.split(/\r\n|[\n\r]/g),y=v[n];if(y.length>120){for(var m=Math.floor(l/80),w=l%80,_=[],i=0;i<y.length;i+=80)_.push(y.slice(i,i+80));return f+h([["".concat(o),_[0]]].concat(_.slice(1,m+1).map((function(e){return["",e]})),[[" ",d(w-1)+"^"],["",_[m+1]]]))}return f+h([["".concat(o-1),v[n-1]],["".concat(o),y],["",d(l-1)+"^"],["".concat(o+1),v[n+1]]])}function h(e){var t=e.filter((function(e){e[0];return void 0!==e[1]})),n=Math.max.apply(Math,t.map((function(e){return e[0].length})));return t.map((function(e){var t,r=e[0],line=e[1];return d(n-(t=r).length)+t+(line?" | "+line:" |")})).join("\n")}function d(e){return Array(e+1).join(" ")}function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function y(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?E(e):t}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e){var t="function"==typeof Map?new Map:void 0;return S=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return O(e,arguments,A(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),I(r,e)},S(e)}function O(e,t,n){return O=T()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var r=new(Function.bind.apply(e,a));return n&&I(r,n.prototype),r},O.apply(null,arguments)}function T(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function I(e,p){return I=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},I(e,p)}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}var N=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(O,e);var t,n,h,d,v,S=(t=O,n=T(),function(){var e,r=A(t);if(n){var o=A(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return _(this,e)});function O(e,t,source,n,path,o,l){var f,h,d,v;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,O),(v=S.call(this,e)).name="GraphQLError",v.originalError=null!=o?o:void 0,v.nodes=C(Array.isArray(t)?t:t?[t]:void 0);for(var w=[],T=0,I=null!==(A=v.nodes)&&void 0!==A?A:[];T<I.length;T++){var A,N=I[T].loc;null!=N&&w.push(N)}w=C(w),v.source=null!=source?source:null===(f=w)||void 0===f?void 0:f[0].source,v.positions=null!=n?n:null===(h=w)||void 0===h?void 0:h.map((function(e){return e.start})),v.locations=n&&source?n.map((function(e){return c(source,e)})):null===(d=w)||void 0===d?void 0:d.map((function(e){return c(e.source,e.start)})),v.path=null!=path?path:void 0;var x,k=null==o?void 0:o.extensions;return null==l&&("object"==r(x=k)&&null!==x)?v.extensions=function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?y(Object(source),!0).forEach((function(t){m(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):y(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},k):v.extensions=null!=l?l:{},Object.defineProperties(E(v),{message:{enumerable:!0},locations:{enumerable:null!=v.locations},path:{enumerable:null!=v.path},extensions:{enumerable:null!=v.extensions&&Object.keys(v.extensions).length>0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),null!=o&&o.stack?(Object.defineProperty(E(v),"stack",{value:o.stack,writable:!0,configurable:!0}),_(v)):(Error.captureStackTrace?Error.captureStackTrace(E(v),O):Object.defineProperty(E(v),"stack",{value:Error().stack,writable:!0,configurable:!0}),v)}return h=O,(d=[{key:"toString",value:function(){return function(e){var output=e.message;if(e.nodes)for(var t=0,n=e.nodes;t<n.length;t++){var r=n[t];r.loc&&(output+="\n\n"+l(r.loc))}else if(e.source&&e.locations)for(var o=0,c=e.locations;o<c.length;o++){var h=c[o];output+="\n\n"+f(e.source,h)}return output}(this)}},{key:o.a,get:function(){return"Object"}}])&&w(h.prototype,d),v&&w(h,v),O}(S(Error));function C(e){return void 0===e||0===e.length?void 0:e}},676:function(e,t,n){"use strict";n.r(t),n.d(t,"fromUtf8",(function(){return r})),n.d(t,"toUtf8",(function(){return o}));var r=function(input){return"function"==typeof TextEncoder?function(input){return(new TextEncoder).encode(input)}(input):function(input){for(var e=[],i=0,t=input.length;i<t;i++){var n=input.charCodeAt(i);if(n<128)e.push(n);else if(n<2048)e.push(n>>6|192,63&n|128);else if(i+1<input.length&&55296==(64512&n)&&56320==(64512&input.charCodeAt(i+1))){var r=65536+((1023&n)<<10)+(1023&input.charCodeAt(++i));e.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else e.push(n>>12|224,n>>6&63|128,63&n|128)}return Uint8Array.from(e)}(input)},o=function(input){return"function"==typeof TextDecoder?function(input){return new TextDecoder("utf-8").decode(input)}(input):function(input){for(var e="",i=0,t=input.length;i<t;i++){var n=input[i];if(n<128)e+=String.fromCharCode(n);else if(192<=n&&n<224){var r=input[++i];e+=String.fromCharCode((31&n)<<6|63&r)}else if(240<=n&&n<365){var o="%"+[n,input[++i],input[++i],input[++i]].map((function(e){return e.toString(16)})).join("%");e+=decodeURIComponent(o)}else e+=String.fromCharCode((15&n)<<12|(63&input[++i])<<6|63&input[++i])}return e}(input)}},687:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},o={clockOffset:0,getDateWithClockOffset:function(){return o.clockOffset?new Date((new Date).getTime()+o.clockOffset):new Date},getClockOffset:function(){return o.clockOffset},getHeaderStringFromDate:function(e){return void 0===e&&(e=o.getDateWithClockOffset()),e.toISOString().replace(/[:\-]|\.\d{3}/g,"")},getDateFromHeaderString:function(header){var e=r(header.match(/^(\d{4})(\d{2})(\d{2})T(\d{2})(\d{2})(\d{2}).+/),7),t=e[1],n=e[2],o=e[3],c=e[4],l=e[5],f=e[6];return new Date(Date.UTC(Number(t),Number(n)-1,Number(o),Number(c),Number(l),Number(f)))},isClockSkewed:function(e){return Math.abs(e.getTime()-o.getDateWithClockOffset().getTime())>=3e5},isClockSkewError:function(e){if(!e.response||!e.response.headers)return!1;var t=e.response.headers;return Boolean(["BadRequestException","InvalidSignatureException"].includes(t["x-amzn-errortype"])&&(t.date||t.Date))},setClockOffset:function(e){o.clockOffset=e}}}}]);